# Template file for 'omegat'
pkgname=omegat
version=4.3.3
revision=1
hostmakedepends="openjdk8"
depends="virtual?java-runtime"
short_desc="Multiplatform CAT application"
maintainer="Jorge Santiago <jsantiago12tone@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://omegat.org/"
distfiles="https://sourceforge.net/projects/omegat/files/OmegaT%20-%20Standard/OmegaT%20${version}/OmegaT_${version}_Source.zip"
checksum=3cb39c9357aefe6efb274e1ee56f1ece57141b73a40a2416a7b405a6c8123184

do_build() {
	JAVA_HOME=/usr/lib/jvm/java-1.8-openjdk ./gradlew -x test installDist
}

do_install() {
	OMEGATDIR=opt/omegat

	cd build/install/OmegaT
	vmkdir "${OMEGATDIR}"

	vcopy images "${OMEGATDIR}"
	vcopy lib "${OMEGATDIR}"
	vcopy plugins "${OMEGATDIR}"
	vcopy scripts "${OMEGATDIR}"

	vinstall OmegaT.jar 644 "${OMEGATDIR}"
	vbin "${FILESDIR}/omegat.sh" omegat
	vinstall images/OmegaT.svg 644 usr/share/pixmaps omegat.svg
	vinstall "${FILESDIR}/omegat.desktop" 644 usr/share/applications

	for file in *.txt; do
		if [[ $file == *"license"* ]]; then
			continue
		fi
		vdoc "$file"
	done
}
