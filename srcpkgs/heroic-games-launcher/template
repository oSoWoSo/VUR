# Template file for 'heroic-games-launcher'
pkgname=heroic-games-launcher
version=1.8.2
revision=1
archs="x86_64"
wrksrc=${pkgname}-${version}
create_wrksrc=yes
#configure_args=""
#make_build_args=""
#make_install_args=""
#conf_files=""
#make_dirs="/var/log/dir 0755 root root"
hostmakedepends="nodejs yarn python3 python3-setuptools python3-wheel fuse git gawk tar"
#makedepends=""
depends="fuse"
short_desc="Native Epic Games launcher for Linux"
maintainer="Ruthenic <mdrakea3@tutanota.com>"
license="GPL-3.0-only"
homepage="https://github.com/Heroic-Games-Launcher/HeroicGamesLauncher"
#distfiles=""
#checksum="7c479dea0e87ef8cffb9712ff8258d7a16aa4c3913e604589f5d714be5bf2f71"

do_fetch() {
	mkdir -p ${pkgname}-${version}
	cd ${pkgname}-${version}
	git clone ${homepage} -b v${version} heroic
	shopt -s dotglob nullglob
	mv heroic/* .
	rm -rf heroic
}

do_build() {
	yarn
	yarn dist
}

do_install() {
	#Install application files
	vmkdir usr/lib/heroic-games-launcher
	vcopy dist/linux-unpacked/* usr/lib/heroic-games-launcher
	#Symlink binary to /usr/bin
	vmkdir usr/bin
	ln -sf /usr/lib/heroic-games-launcher/heroic ${DESTDIR}/usr/bin
	#Install icons
	vmkdir usr/share/icons/hicolor
	vinstall build/icon.png 644 usr/share/icons/hicolor/512x512/apps/ heroic.png
}
