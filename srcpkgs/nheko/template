# Template file for 'nheko'
pkgname=nheko
version=0.12.1
revision=1
build_style=cmake
hostmakedepends="qt6-base qt6-tools qt6-declarative-host-tools pkg-config asciidoc"
makedepends="qt6-multimedia-devel qt6-svg-devel qt6-declarative-private-devel fmt-devel
 spdlog mtxclient-devel cmark-devel olm-devel json-c++ lmdb++ coeurl-devel
 qtkeychain-qt6-devel gst-plugins-bad1-devel gst-plugins-base1-devel
 xcb-util-wm-devel re2-devel KDSingleApplication qt6-base-private-devel"
depends="hicolor-icon-theme gst-plugins-good1"
short_desc="Desktop client for Matrix using Qt and C++"
maintainer="Kevin Figueroa <kfdevart@disroot.org>"
license="GPL-3.0-or-later"
homepage="https://nheko-reborn.github.io"
changelog="https://raw.githubusercontent.com/Nheko-Reborn/nheko/master/CHANGELOG.md"
distfiles="https://github.com/Nheko-Reborn/nheko/archive/v${version}.tar.gz"
checksum=81cc613ee2420b1289c9cc7aeee81cae69a153971fd3112225e48d1c7b224ea5
repository=cereus-extra

post_patch() {
	vsed -e '/-Werror/d' -i CMakeLists.txt
}

case "$XBPS_TARGET_MACHINE" in
	armv*-musl)
		makedepends+=" libunwind-devel"
		configure_args+=" -DCMAKE_CXX_STANDARD_LIBRARIES=-lunwind" ;;
	*) ;;
esac
