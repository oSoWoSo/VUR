# Template file for 'modclean-git'
pkgname=modclean-git
#version=3.0.0beta.1
version=999
revision=1
hostmakedepends="nodejs"
makedepends="nodejs"
depends="nodejs"
short_desc="Remove unwanted files and directories from your node_modules folder"
maintainer="Soc Virnyl S. Estela <renegan.ronin@gmail.com>"
license="MIT"
#homepage="https://github.com/ModClean/modclean"
homepage="https://github.com/circle9r/modclean"
#distfiles="${homepage}/archive/3.0.0-beta.1.tar.gz"
distfiles="https://github.com/circle9r/modclean/archive/refs/heads/main.zip>main.tar.gz"
checksum=55995406b10163fb2ca92c95adfa466d84d14f06fb274c215069664e4a005221

do_build() {
	npm install --no-optional --save
	./bin/modclean.js -r -a '.bin,bin.js' --ignore='license'
}

do_install() {
	vmkdir usr/bin/
	vmkdir usr/lib/node_modules/modclean/
	vcopy "*" usr/lib/node_modules/modclean/
}

post_install() {
	ln -sf /usr/lib/node_modules/modclean/bin/modclean.js "$DESTDIR"/usr/bin/modclean
	vlicense LICENSE
}
