# Template file for 'spacefm2'
pkgname=spacefm2
version=2.1.2
revision=1
build_style=meson
wrksrc="${pkgname}-${version}"
create_wrksrc=yes
configure_args="$(gtk3)"
hostmakedepends="pkg-config intltool xdg-utils xbps-triggers"
makedepends="$(gtk3 gtk+3-devel gtk+-devel)
 startup-notification-devel eudev-libudev-devel ffmpegthumbnailer-devel xdg-utils"
depends="hicolor-icon-theme desktop-file-utils"
short_desc="NOT WORKING YET! Multi-panel tabbed file manager"
maintainer="zenobit <zen@osowoso.xyz>"
license="GPL-3.0-or-later"
homepage="https://github.com/thermitegod/spacefm"
distfiles="https://github.com/thermitegod/spacefm/archive/refs/tags/v2.1.0.tar.gz"
checksum=d6eb174874cf9c06bbc364adeb755a8b741bb16de5205c7442a0c41dbb5fafa9
conf_files="/etc/spacefm/spacefm.conf"

build_options="gtk3 deprecated-hw mmap xxhash nonlatin sn"
build_options_default="gtk3 mmap xxhash sn"
CFLAGS="-fcommon"

src_configure() {
	meson_src_configure \
		$(meson_use startup-notification sn) \
		$(meson_use nls nls) \
		$(meson_use deprecated deprecated-hw) \
		$(meson_use gtk2 gtk2) \
		$(meson_use gtk3 gtk3) \
		$(meson_use xxhash xxhash)
}

src_compile() {
	meson_src_compile
}

src_install() {
	meson_src_install
	einstalldocs
	doman doc/*.1
	doman doc/*.7
}

pkg_postinst() {
	xdg_desktop_database_update
	xdg_mimeinfo_database_update
	xdg_icon_cache_update
}

pkg_postrm() {
	xdg_desktop_database_update
	xdg_mimeinfo_database_update
	xdg_icon_cache_update
}
