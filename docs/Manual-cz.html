<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Manual-cz</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
<script>
  function toggleTheme(){
    const html=document.documentElement;
    const current=html.getAttribute("data-theme")||"dark";
    const next=current==="dark"?"light":"dark";
    html.setAttribute("data-theme",next);
    localStorage.setItem("theme",next)
  }
  (function(){
    const saved=localStorage.getItem("theme")||"dark";
    document.documentElement.setAttribute("data-theme",saved)
  })();
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("TOC");
    if (!toc) return;

    // Add toc-title with toggle button
    const titleEl = document.createElement("div");
    titleEl.id = "toc-title";
    titleEl.innerHTML = '<span>Contents</span><span id="toc-toggle-icon">â—€</span>';
    toc.insertBefore(titleEl, toc.firstChild);

    // Wrap TOC + the rest of the content in .page-wrapper
    const body = document.body;
    const wrapper = document.createElement("div");
    wrapper.className = "page-wrapper";

    // Find all elements after <nav> (main nav menu)
    const topNav = document.querySelector("body > nav");
    const siblings = [];
    let el = topNav ? topNav.nextElementSibling : body.firstElementChild;
    while (el) {
      siblings.push(el);
      el = el.nextElementSibling;
    }

    siblings.forEach((s) => wrapper.appendChild(s));
    body.appendChild(wrapper);

    // Wrap main content (everything except TOC) in .main-content
    const mainContent = document.createElement("div");
    mainContent.className = "main-content";
    Array.from(wrapper.children).forEach((child) => {
      if (child.id !== "TOC") mainContent.appendChild(child);
    });
    wrapper.appendChild(mainContent);

    // Collapsible toggle
    const icon = document.getElementById("toc-toggle-icon");
    const saved = localStorage.getItem("toc-collapsed");
    if (saved === "true") {
      toc.classList.add("collapsed");
      icon.textContent = "â–¶";
    }

    titleEl.addEventListener("click", function () {
      toc.classList.toggle("collapsed");
      const isCollapsed = toc.classList.contains("collapsed");
      icon.textContent = isCollapsed ? "â–¶" : "â—€";
      localStorage.setItem("toc-collapsed", isCollapsed);
    });
  });
</script>
<nav><ul>
  <li><a href="https://osowoso.org">oSoWoSo</a></li>
  <li>â®ï¸</a></li>
  <li><a href="index.html">Home</a></li>
  <li><a class="no-release" href="https://github.com/oSoWoSo/VUR/releases/latest">â¬ release</a></li>
  <li><a href="https://github.com/oSoWoSo/VUR/archive/refs/heads/main.zip">ğŸ“¦repo zip</a></li>
  <li><a href="https://github.com/oSoWoSo/VUR">ğŸ”—git</a></li>
  <li>â­ï¸</a></li>
  <li><a href="CONTRIBUTING-cz.html">CONTRIBUTING-cz</a></li>
  <li><a href="CONTRIBUTING.html">CONTRIBUTING</a></li>
  <li><a href="Manual-cz.html" class="active">Manual-cz</a></li>
  <li><a href="Manual.html">Manual</a></li>
  <li><a href="README-cz.html">README-cz</a></li>
</ul></nav>
<header id="title-block-header">
<h1 class="title">Manual-cz</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#manuÃ¡l-ke-zdrojovÃ½m-balÃ­ÄkÅ¯m-xbps"
id="toc-manuÃ¡l-ke-zdrojovÃ½m-balÃ­ÄkÅ¯m-xbps">ManuÃ¡l ke zdrojovÃ½m balÃ­ÄkÅ¯m
XBPS</a>
<ul>
<li><a href="#Ãºvod" id="toc-Ãºvod">Ãšvod</a></li>
<li><a href="#fÃ¡ze-sestavenÃ­-balÃ­Äku"
id="toc-fÃ¡ze-sestavenÃ­-balÃ­Äku">FÃ¡ze sestavenÃ­ balÃ­Äku</a></li>
<li><a href="#konvence-pojmenovÃ¡vÃ¡nÃ­-balÃ­ÄkÅ¯"
id="toc-konvence-pojmenovÃ¡vÃ¡nÃ­-balÃ­ÄkÅ¯">Konvence pojmenovÃ¡vÃ¡nÃ­
balÃ­ÄkÅ¯</a></li>
<li><a href="#globÃ¡lnÃ­-funkce" id="toc-globÃ¡lnÃ­-funkce">GlobÃ¡lnÃ­
funkce</a></li>
<li><a href="#globÃ¡lnÃ­-promÄ›nnÃ©" id="toc-globÃ¡lnÃ­-promÄ›nnÃ©">GlobÃ¡lnÃ­
promÄ›nnÃ©</a></li>
<li><a href="#dostupnÃ©-promÄ›nnÃ©" id="toc-dostupnÃ©-promÄ›nnÃ©">DostupnÃ©
promÄ›nnÃ©</a></li>
<li><a href="#ÃºloÅ¾iÅ¡tÄ›" id="toc-ÃºloÅ¾iÅ¡tÄ›">ÃšloÅ¾iÅ¡tÄ›</a></li>
<li><a href="#kontrola-novÃ½ch-upstream-vydÃ¡nÃ­"
id="toc-kontrola-novÃ½ch-upstream-vydÃ¡nÃ­">Kontrola novÃ½ch upstream
vydÃ¡nÃ­</a></li>
<li><a href="#manipulace-s-nÃ¡plastmi"
id="toc-manipulace-s-nÃ¡plastmi">Manipulace s nÃ¡plastmi</a></li>
<li><a href="#vytvÃ¡Å™et-stylovÃ©-skripty"
id="toc-vytvÃ¡Å™et-stylovÃ©-skripty">vytvÃ¡Å™et stylovÃ© skripty</a></li>
<li><a href="#vytvÃ¡Å™et-pomocnÃ©-skripty"
id="toc-vytvÃ¡Å™et-pomocnÃ©-skripty">vytvÃ¡Å™et pomocnÃ© skripty</a></li>
<li><a href="#funkce" id="toc-funkce">Funkce</a></li>
<li><a href="#moÅ¾nosti-sestavenÃ­" id="toc-moÅ¾nosti-sestavenÃ­">MoÅ¾nosti
sestavenÃ­</a></li>
<li><a href="#instalovat-a-odebrat-soubory"
id="toc-instalovat-a-odebrat-soubory">INSTALOVAT a ODEBRAT
soubory</a></li>
<li><a href="#installmsg-a-removemsg-soubory"
id="toc-installmsg-a-removemsg-soubory">INSTALL.msg a REMOVE.msg
soubory</a></li>
<li><a href="#vytvÃ¡Å™enÃ­-systÃ©movÃ½ch-ÃºÄtÅ¯skupin-za-bÄ›hu"
id="toc-vytvÃ¡Å™enÃ­-systÃ©movÃ½ch-ÃºÄtÅ¯skupin-za-bÄ›hu">VytvÃ¡Å™enÃ­ systÃ©movÃ½ch
ÃºÄtÅ¯/skupin za bÄ›hu</a></li>
<li><a href="#psanÃ­-runitovÃ½ch-sluÅ¾eb"
id="toc-psanÃ­-runitovÃ½ch-sluÅ¾eb">PsanÃ­ runitovÃ½ch sluÅ¾eb</a></li>
<li><a href="#32bitovÃ©-balÃ­Äky" id="toc-32bitovÃ©-balÃ­Äky">32bitovÃ©
balÃ­Äky</a></li>
<li><a href="#dÃ­lÄÃ­-balÃ­Äky" id="toc-dÃ­lÄÃ­-balÃ­Äky">DÃ­lÄÃ­
balÃ­Äky</a></li>
<li><a href="#nÄ›kterÃ©-tÅ™Ã­dy-balÃ­ÄkÅ¯"
id="toc-nÄ›kterÃ©-tÅ™Ã­dy-balÃ­ÄkÅ¯">NÄ›kterÃ© tÅ™Ã­dy balÃ­ÄkÅ¯</a></li>
<li><a href="#pÅ™ejmenovÃ¡nÃ­-balÃ­Äku"
id="toc-pÅ™ejmenovÃ¡nÃ­-balÃ­Äku">PÅ™ejmenovÃ¡nÃ­ balÃ­Äku</a></li>
<li><a href="#odebÃ­rÃ¡nÃ­-balÃ­Äku" id="toc-odebÃ­rÃ¡nÃ­-balÃ­Äku">OdebÃ­rÃ¡nÃ­
balÃ­Äku</a></li>
<li><a href="#spouÅ¡tÄ›Äe-xbps" id="toc-spouÅ¡tÄ›Äe-xbps">SpouÅ¡tÄ›Äe
XBPS</a></li>
<li><a href="#zruÅ¡te-konkrÃ©tnÃ­-dokumentaci"
id="toc-zruÅ¡te-konkrÃ©tnÃ­-dokumentaci">ZruÅ¡te konkrÃ©tnÃ­
dokumentaci</a></li>
<li><a href="#poznÃ¡mky" id="toc-poznÃ¡mky">PoznÃ¡mky</a></li>
<li><a href="#pÅ™ispÃ­vÃ¡nÃ­-pÅ™es-git"
id="toc-pÅ™ispÃ­vÃ¡nÃ­-pÅ™es-git">PÅ™ispÃ­vÃ¡nÃ­ pÅ™es git</a></li>
<li><a href="#pomoc" id="toc-pomoc">Pomoc</a></li>
</ul></li>
</ul>
</nav>
<h1 id="manuÃ¡l-ke-zdrojovÃ½m-balÃ­ÄkÅ¯m-xbps">ManuÃ¡l ke zdrojovÃ½m balÃ­ÄkÅ¯m
XBPS</h1>
<p>Tento ÄlÃ¡nek obsahuje vyÄerpÃ¡vajÃ­cÃ­ nÃ¡vod, jak vytvoÅ™it novÃ© zdrojovÃ©
balÃ­Äky pro XBPS, nativnÃ­ balÃ­ÄkovacÃ­ systÃ©m <code>Void Linux</code>
.</p>
<p><em>Obsah</em></p>
<ul>
<li>ManuÃ¡l ke zdrojovÃ½m balÃ­ÄkÅ¯m XBPS
<ul>
<li><a href="#Introduction">Ãšvod</a></li>
<li><a href="#buildphase">FÃ¡ze sestavenÃ­ balÃ­Äku</a></li>
<li><a href="#namingconventions">Konvence pojmenovÃ¡vÃ¡nÃ­ balÃ­ÄkÅ¯</a>
<ul>
<li><a href="#libs">Knihovny</a></li>
<li><a href="#language_modules">JazykovÃ© moduly</a></li>
<li><a href="#language_bindings">JazykovÃ© vazby</a></li>
<li><a href="#programs">Programy</a></li>
</ul></li>
<li><a href="#global_funcs">GlobÃ¡lnÃ­ funkce</a></li>
<li><a href="#global_vars">GlobÃ¡lnÃ­ promÄ›nnÃ©</a></li>
<li><a href="#available_vars">DostupnÃ© promÄ›nnÃ©</a>
<ul>
<li><a href="#mandatory_vars">PovinnÃ© promÄ›nnÃ©</a></li>
<li><a href="#optional_vars">NepovinnÃ© promÄ›nnÃ©</a></li>
<li><a href="#explain_depends">O zÃ¡vislÃ½ch promÄ›nnÃ½ch</a></li>
</ul></li>
<li><a href="#repositories">ÃšloÅ¾iÅ¡tÄ›</a>
<ul>
<li><a href="#repo_by_branch">RepozitÃ¡Å™e definovanÃ© vÄ›tvÃ­</a></li>
<li><a href="#pkg_defined_repo">RepozitÃ¡Å™e definovanÃ© balÃ­Äky</a></li>
</ul></li>
<li><a href="#updates">Kontrola novÃ½ch upstream vydÃ¡nÃ­</a></li>
<li><a href="#patches">Manipulace s nÃ¡plastmi</a></li>
<li><a href="#build_scripts">VytvÃ¡Å™ejte stylovÃ© skripty</a></li>
<li><a href="#build_helper">VytvÃ¡Å™ejte pomocnÃ© skripty</a></li>
<li><a href="#functions">Funkce</a></li>
<li><a href="#build_options">MoÅ¾nosti sestavenÃ­</a></li>
<li><a href="#install_remove_files">INSTALOVAT a ODEBRAT
soubory</a></li>
<li><a href="#install_remove_files_msg">INSTALL.msg a REMOVE.msg
soubory</a></li>
<li><a href="#runtime_account_creation">VytvÃ¡Å™enÃ­ systÃ©movÃ½ch
ÃºÄtÅ¯/skupin za bÄ›hu</a></li>
<li><a href="#writing_runit_services">PsanÃ­ runitovÃ½ch sluÅ¾eb</a></li>
<li><a href="#32bit_pkgs">32bitovÃ© balÃ­Äky</a></li>
<li><a href="#pkgs_sub">DÃ­lÄÃ­ balÃ­Äky</a></li>
<li><a href="#pkgs_classes">NÄ›kterÃ© tÅ™Ã­dy balÃ­ÄkÅ¯</a>
<ul>
<li><a href="#pkgs_development">VÃ½vojovÃ© balÃ­Äky</a></li>
<li><a href="#pkgs_data">DatovÃ© balÃ­Äky</a></li>
<li><a href="#pkgs_documentation">BalÃ­Äky dokumentace</a></li>
<li><a href="#pkgs_python">Python balÃ­Äky</a></li>
<li><a href="#pkgs_go">PÅ™ejÃ­t na balÃ­Äky</a></li>
<li><a href="#pkgs_haskell">Haskell balÃ­Äky</a></li>
<li><a href="#pkgs_font">BalÃ­Äky pÃ­sem</a></li>
</ul></li>
<li><a href="#pkg_rename">PÅ™ejmenovÃ¡nÃ­ balÃ­Äku</a></li>
<li><a href="#pkg_remove">OdebÃ­rÃ¡nÃ­ balÃ­Äku</a></li>
<li><a href="#xbps_triggers">SpouÅ¡tÄ›Äe XBPS</a>
<ul>
<li><a href="#triggers_appstream_cache">appstream-cache</a></li>
<li><a href="#triggers_binfmts">binfmts</a></li>
<li><a href="#triggers_dkms">dkms</a></li>
<li><a href="#triggers_gconf_schemas">schÃ©mata gconf</a></li>
<li><a href="#triggers_gdk_pixbuf_loaders">gdk-pixbuf-loadery</a></li>
<li><a href="#triggers_gio_modules">gio-moduly</a></li>
<li><a href="#triggers_gsettings_schemas">zÃ­skÃ¡vÃ¡nÃ­-schÃ©mata</a></li>
<li><a href="#triggers_gtk_icon_cache">gtk-ikona-mezipamÄ›Å¥</a></li>
<li><a href="#triggers_gtk_immodules">gtk-immodules</a></li>
<li><a href="#triggers_gtk_pixbuf_loaders">gtk-pixbuf-loadery</a></li>
<li><a href="#triggers_gtk3_immodules">gtk3-immodules</a></li>
<li><a href="#triggers_hwdb.d_dir">hwdb.d-dir</a></li>
<li><a href="#triggers_info_files">info-soubory</a></li>
<li><a
href="#triggers_initramfs_regenerate">initramfs-regenerate</a></li>
<li><a href="#triggers_kernel_hooks">kernel-hÃ¡ky</a></li>
<li><a href="#triggers_mimedb">mimedb</a></li>
<li><a href="#triggers_mkdirs">mkdirs</a></li>
<li><a href="#triggers_pango_module">pango-moduly</a></li>
<li><a href="#triggers_pycompile">pycompile</a></li>
<li><a href="#triggers_register_shell">registr-shell</a></li>
<li><a href="#triggers_system_accounts">systÃ©movÃ© ÃºÄty</a></li>
<li><a href="#triggers_texmf_dist">texmf-dist</a></li>
<li><a href="#triggers_update_desktopdb">update-desktopdb</a></li>
<li><a href="#triggers_x11_fonts">x11-fonty</a></li>
<li><a href="#triggers_xml_catalog">xml-katalog</a></li>
</ul></li>
<li><a href="#documentation">ZruÅ¡te konkrÃ©tnÃ­ dokumentaci</a></li>
<li><a href="#notes">PoznÃ¡mky</a></li>
<li><a href="#contributing">PÅ™ispÃ­vÃ¡nÃ­ pÅ™es git</a></li>
<li><a href="#help">Pomoc</a></li>
</ul></li>
</ul>
<p><a id="Introduction"></a></p>
<h3 id="Ãºvod">Ãšvod</h3>
<p>ÃšloÅ¾iÅ¡tÄ› <code>void-packages</code> obsahuje vÅ¡echny recepty ke
staÅ¾enÃ­, kompilaci a sestavovÃ¡nÃ­ binÃ¡rnÃ­ch balÃ­ÄkÅ¯ pro Void Linux. Tyto
soubory <code>source</code> balÃ­ÄkÅ¯ se nazÃ½vajÃ­ <code>templates</code>
.</p>
<p>Soubory <code>template</code> jsou skripty shellu, kterÃ© definujÃ­
<code>variables</code> a <code>functions</code> , kterÃ© mÃ¡ zpracovat
<code>xbps-src</code> , tvÅ¯rce balÃ­ÄkÅ¯, za ÃºÄelem generovÃ¡nÃ­ binÃ¡rnÃ­ch
balÃ­ÄkÅ¯. Shell pouÅ¾Ã­vanÃ½ <code>xbps-src</code> je GNU bash;
<code>xbps-src</code> si neklade za cÃ­l bÃ½t kompatibilnÃ­ s POSIX
<code>sh</code> .</p>
<p>Podle konvence vÅ¡echny Å¡ablony zaÄÃ­najÃ­ komentÃ¡Å™em, kterÃ½ Å™Ã­kÃ¡, Å¾e se
jednÃ¡ o <code>template file</code> pro urÄitÃ½ balÃ­Äek. VÄ›tÅ¡ina Å™Ã¡dkÅ¯ by
mÄ›la mÃ­t mÃ©nÄ› neÅ¾ 80 sloupcÅ¯; promÄ›nnÃ©, kterÃ© vypisujÃ­ mnoho hodnot, lze
rozdÄ›lit na novÃ© Å™Ã¡dky, pÅ™iÄemÅ¾ pokraÄovÃ¡nÃ­ na dalÅ¡Ã­m Å™Ã¡dku je odsazeno
o jednu mezeru.</p>
<p>JednoduchÃ½ pÅ™Ã­klad <code>template</code> je nÃ¡sledujÃ­cÃ­:</p>
<pre><code># Template file for &#39;foo&#39;
pkgname=foo
version=1.0
revision=1
build_style=gnu-configure
short_desc=&quot;Package description, no more than 72 characters&quot;
maintainer=&quot;name &lt;email&gt;&quot;
license=&quot;GPL-3.0-or-later&quot;
homepage=&quot;http://www.foo.org&quot;
distfiles=&quot;http://www.foo.org/foo-${version}.tar.gz&quot;
checksum=&quot;fea0a94d4b605894f3e2d5572e3f96e4413bcad3a085aae7367c2cf07908b2ff&quot;</code></pre>
<p>Soubor Å¡ablony obsahuje definice ke staÅ¾enÃ­, sestavenÃ­ a instalaci
souborÅ¯ balÃ­ÄkÅ¯ do <code>fake destdir</code> a potÃ© lze vygenerovat
binÃ¡rnÃ­ balÃ­Äek s definicemi v nÄ›m uvedenÃ½mi.</p>
<p>NedÄ›lejte si starosti, pokud nÄ›co nenÃ­ jasnÃ©, jak by mÄ›lo bÃ½t.
RezervovanÃ© <code>variables</code> a <code>functions</code> budou
vysvÄ›tleny pozdÄ›ji. Tento soubor <code>template</code> by mÄ›l bÃ½t
vytvoÅ™en v adresÃ¡Å™i, kterÃ½ odpovÃ­dÃ¡ <code>$pkgname</code> , PÅ™Ã­klad:
<code>void-packages/srcpkgs/foo/template</code> .</p>
<p>Pokud po bÄ›hu vÅ¡e probÄ›hlo v poÅ™Ã¡dku</p>
<pre><code>$ ./xbps-src pkg &lt;pkgname&gt;</code></pre>
<p>v mÃ­stnÃ­m ÃºloÅ¾iÅ¡ti <code>hostdir/binpkgs</code> bude vygenerovÃ¡n
binÃ¡rnÃ­ balÃ­Äek s nÃ¡zvem <code>foo-1.0_1.&lt;arch&gt;.xbps</code></p>
<p><a id="buildphase"></a></p>
<h3 id="fÃ¡ze-sestavenÃ­-balÃ­Äku">FÃ¡ze sestavenÃ­ balÃ­Äku</h3>
<p>SestavenÃ­ balÃ­Äku se sklÃ¡dÃ¡ z nÃ¡sledujÃ­cÃ­ch fÃ¡zÃ­:</p>
<ul>
<li><p><code>setup</code> Tato fÃ¡ze pÅ™ipravuje prostÅ™edÃ­ pro sestavenÃ­
balÃ­Äku.</p></li>
<li><p><code>fetch</code> Tato fÃ¡ze stÃ¡hne poÅ¾adovanÃ© zdroje pro
<code>source package</code> , jak je definovÃ¡no promÄ›nnou
<code>distfiles</code> nebo funkcÃ­ <code>do_fetch()</code> .</p></li>
<li><p><code>extract</code> Tato fÃ¡ze rozbalÃ­ soubory
<code>distfiles</code> do <code>$wrksrc</code> nebo spustÃ­ funkci
<code>do_extract()</code> , coÅ¾ je adresÃ¡Å™, kterÃ½ se mÃ¡ pouÅ¾Ã­t ke
kompilaci <code>source package</code> .</p></li>
<li><p><code>patch</code> Tato fÃ¡ze aplikuje vÅ¡echny zÃ¡platy v adresÃ¡Å™i
zÃ¡plat balÃ­Äku a lze ji pouÅ¾Ã­t k provedenÃ­ dalÅ¡Ã­ch operacÃ­ pÅ™ed
konfiguracÃ­ balÃ­Äku.</p></li>
<li><p><code>configure</code> Tato fÃ¡ze provede
<code>configuration</code> <code>source package</code> , tj.
<code>GNU configure scripts</code> .</p></li>
<li><p><code>build</code> Tato fÃ¡ze zkompiluje/pÅ™ipravÃ­
<code>source files</code> pomocÃ­ <code>make</code> nebo jinÃ©
kompatibilnÃ­ metody.</p></li>
<li><p><code>check</code> Tato volitelnÃ¡ fÃ¡ze kontroluje vÃ½sledek fÃ¡ze
<code>build</code> spuÅ¡tÄ›nÃ­m testovacÃ­ sady, kterou balÃ­Äek poskytuje.
Pokud vÃ½chozÃ­ funkce <code>do_check</code> poskytovanÃ¡ stylem sestavenÃ­
nic nedÄ›lÃ¡, Å¡ablona by mÄ›la vhodnÄ› nastavit
<code>make_check_target</code> a/nebo <code>make_check_args</code> nebo
definovat svou vlastnÃ­ funkci <code>do_check</code> . Pokud testy trvajÃ­
pÅ™Ã­liÅ¡ dlouho nebo se nedajÃ­ spustit ve vÅ¡ech prostÅ™edÃ­ch,
<code>make_check</code> by mÄ›l bÃ½t nastaven na odpovÃ­dajÃ­cÃ­ hodnotu nebo
<code>do_check</code> by mÄ›l bÃ½t pÅ™izpÅ¯soben tak, aby omezil testovacÃ­
sadu, pokud nenÃ­ <code>XBPS_CHECK_PKGS</code> <code>full</code>
.</p></li>
<li><p><code>install</code> Tato fÃ¡ze nainstaluje
<code>package files</code> do balÃ­Äku destdir
<code>&lt;masterdir&gt;/destdir/&lt;pkgname&gt;-&lt;version&gt;</code> ,
pomocÃ­ <code>make install</code> nebo jakoukoli jinou kompatibilnÃ­
metodou.</p></li>
<li><p><code>pkg</code> Tato fÃ¡ze vytvoÅ™Ã­ <code>binary packages</code>
se soubory uloÅ¾enÃ½mi v <code>package destdir</code> a zaregistruje je do
mÃ­stnÃ­ho ÃºloÅ¾iÅ¡tÄ›.</p></li>
<li><p><code>clean</code> Tato fÃ¡ze vyÄistÃ­ balÃ­Äek (pokud je
definovÃ¡n).</p></li>
</ul>
<p><code>xbps-src</code> podporuje spuÅ¡tÄ›nÃ­ pouze zadanÃ© fÃ¡ze, a pokud
probÄ›hla ÃºspÄ›Å¡nÄ›, fÃ¡ze bude pozdÄ›ji pÅ™eskoÄena (pokud jejÃ­ pracovnÃ­
adresÃ¡Å™ <code>${wrksrc}</code> nebude odstranÄ›n pomocÃ­
<code>xbps-src clean</code> ).</p>
<p><a id="namingconventions"></a></p>
<h3 id="konvence-pojmenovÃ¡vÃ¡nÃ­-balÃ­ÄkÅ¯">Konvence pojmenovÃ¡vÃ¡nÃ­
balÃ­ÄkÅ¯</h3>
<p><a id="libs"></a></p>
<h4 id="knihovny">Knihovny</h4>
<p>Knihovny jsou balÃ­Äky, kterÃ© poskytujÃ­ sdÃ­lenÃ© objekty (*.so) v
/usr/lib. MÄ›ly by bÃ½t pojmenovÃ¡ny jako jejich nÃ¡zev upstream balÃ­Äku s
nÃ¡sledujÃ­cÃ­mi vÃ½jimkami:</p>
<ul>
<li>BalÃ­Äek je dÃ­lÄÃ­m balÃ­Äkem frontendovÃ© aplikace a poskytuje sdÃ­lenÃ©
objekty pouÅ¾Ã­vanÃ© zÃ¡kladnÃ­m balÃ­Äkem a dalÅ¡Ã­mi knihovnami tÅ™etÃ­ch stran.
V takovÃ©m pÅ™Ã­padÄ› by mÄ›l mÃ­t pÅ™edponu 'lib'. VÃ½jimka z tohoto pravidla
je: Pokud je spustitelnÃ½ soubor pouÅ¾it pouze pro sestavenÃ­ tohoto
balÃ­Äku, pÅ™esune se do balÃ­Äku -devel.</li>
</ul>
<p>PÅ™Ã­klad: wireshark -&gt; subpkg libwireshark</p>
<p>Knihovny musÃ­ bÃ½t rozdÄ›leny do dvou dÃ­lÄÃ­ch balÃ­ÄkÅ¯:
<code>&lt;name&gt;</code> a <code>&lt;name&gt;-devel</code> .</p>
<ul>
<li><p><code>&lt;name&gt;</code> by mÄ›lo obsahovat pouze ty ÄÃ¡sti
balÃ­Äku, kterÃ© jsou potÅ™ebnÃ© ke spuÅ¡tÄ›nÃ­ propojenÃ©ho programu.</p></li>
<li><p><code>&lt;name&gt;-devel</code> by mÄ›l obsahovat vÅ¡echny soubory,
kterÃ© jsou potÅ™eba ke kompilaci balÃ­Äku proti tomuto balÃ­Äku. Pokud je
knihovna dÃ­lÄÃ­m balÃ­Äkem, mÄ›l by se jeho odpovÃ­dajÃ­cÃ­ vÃ½vojovÃ½ balÃ­Äek
jmenovat <code>lib&lt;name&gt;-devel</code></p></li>
</ul>
<p><a id="language_modules"></a></p>
<h4 id="jazykovÃ©-moduly">JazykovÃ© moduly</h4>
<p>JazykovÃ© moduly jsou rozÅ¡Ã­Å™enÃ­m skriptovacÃ­ch nebo kompilovanÃ½ch
jazykÅ¯. Tyto balÃ­Äky samy o sobÄ› neposkytujÃ­ Å¾Ã¡dnÃ© spustitelnÃ© soubory,
ale mohou je pouÅ¾Ã­vat jinÃ© balÃ­Äky napsanÃ© ve stejnÃ©m jazyce.</p>
<p>Konvence pojmenovÃ¡nÃ­ tÄ›chto balÃ­ÄkÅ¯ je:</p>
<pre><code>&lt;language&gt;-&lt;name&gt;</code></pre>
<p>Pokud balÃ­Äek obsahuje modul i spustitelnÃ½ soubor, mÄ›l by bÃ½t
rozdÄ›len na balÃ­Äek poskytujÃ­cÃ­ spustitelnÃ½ soubor s nÃ¡zvem
<code>&lt;name&gt;</code> a modul s nÃ¡zvem
<code>&lt;language&gt;-&lt;name&gt;</code> . Pokud balÃ­Äek zaÄÃ­nÃ¡
samotnÃ½m nÃ¡zvem jazykÅ¯, lze pÅ™edponu jazyka vypustit. KrÃ¡tkÃ© nÃ¡zvy
jazykÅ¯ nejsou platnou nÃ¡hradou jazykovÃ© pÅ™edpony.</p>
<p>Example: perl-URI, python3-pyside2</p>
<p><a id="language_bindings"></a></p>
<h4 id="jazykovÃ©-vazby">JazykovÃ© vazby</h4>
<p>JazykovÃ© vazby jsou balÃ­Äky, kterÃ© umoÅ¾ÅˆujÃ­ programÅ¯m nebo knihovnÃ¡m
mÃ­t rozÅ¡Ã­Å™enÃ­ nebo zÃ¡suvnÃ© moduly napsanÃ© v urÄitÃ©m jazyce.</p>
<p>Konvence pojmenovÃ¡nÃ­ tÄ›chto balÃ­ÄkÅ¯ je:</p>
<pre><code>&lt;name&gt;-&lt;language&gt;</code></pre>
<p>Example: gimp-python3, irssi-perl</p>
<p><a id="programs"></a></p>
<h4 id="programy">Programy</h4>
<p>Programy uklÃ¡dajÃ­ spustitelnÃ© soubory do /usr/bin (nebo ve velmi
speciÃ¡lnÃ­ch pÅ™Ã­padech do jinÃ½ch .../bin adresÃ¡Å™Å¯)</p>
<p>U tÄ›chto balÃ­ÄkÅ¯ by mÄ›l bÃ½t pouÅ¾it nÃ¡zev upstream balÃ­ÄkÅ¯. Pamatujte,
Å¾e na rozdÃ­l od mnoha jinÃ½ch distribucÃ­, void nepÃ­Å¡e nÃ¡zvy balÃ­ÄkÅ¯
malÃ½mi pÃ­smeny. ObecnÄ› platÃ­, Å¾e pokud tar.gz balÃ­ku obsahuje velkÃ¡
pÃ­smena, pak by je mÄ›l obsahovat i nÃ¡zev balÃ­ku; pokud tomu tak nenÃ­,
nÃ¡zev balÃ­Äku je malÃ¡ pÃ­smena.</p>
<p>Programy lze rozdÄ›lit na balÃ­Äky programÅ¯ a balÃ­Äky knihoven.
ProgramovÃ½ balÃ­Äek by mÄ›l bÃ½t pojmenovÃ¡n tak, jak je popsÃ¡no vÃ½Å¡e.
BalÃ­Äek knihovny by mÄ›l mÃ­t pÅ™edponu "lib" (viz ÄÃ¡st
<code>Libraries</code> )</p>
<p><a id="global_funcs"></a></p>
<h3 id="globÃ¡lnÃ­-funkce">GlobÃ¡lnÃ­ funkce</h3>
<p>NÃ¡sledujÃ­cÃ­ funkce jsou definovÃ¡ny <code>xbps-src</code> a lze je
pouÅ¾Ã­t na libovolnÃ© Å¡ablonÄ›:</p>
<ul>
<li><p><em>vinstall()</em>
<code>vinstall &lt;file&gt; &lt;mode&gt; &lt;targetdir&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> se zadanÃ½m <code>mode</code> do
<code>targetdir</code> v pkg <code>$DESTDIR</code> . VolitelnÃ½ 4.
argument lze pouÅ¾Ã­t ke zmÄ›nÄ› <code>file name</code> .</p></li>
<li><p><em>vcopy()</em>
<code>vcopy &lt;pattern&gt; &lt;targetdir&gt;</code></p>
<p>ZkopÃ­ruje rekurzivnÄ› vÅ¡echny soubory ve <code>pattern</code> do
<code>targetdir</code> v balÃ­Äku <code>$DESTDIR</code> .</p></li>
<li><p><em>vmove()</em> <code>vmove &lt;pattern&gt;</code></p>
<p>PÅ™esune <code>pattern</code> do zadanÃ©ho adresÃ¡Å™e v balÃ­Äku
<code>$DESTDIR</code> .</p></li>
<li><p><em>vmkdir()</em>
<code>vmkdir &lt;directory&gt; [&lt;mode&gt;]</code></p>
<p>VytvoÅ™Ã­ adresÃ¡Å™ v pkg <code>$DESTDIR</code> . 2. volitelnÃ½ argument
nastavuje reÅ¾im adresÃ¡Å™e.</p></li>
<li><p><em>vbin()</em> <code>vbin &lt;file&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> do <code>usr/bin</code> v pkg
<code>$DESTDIR</code> s oprÃ¡vnÄ›nÃ­m 0755. VolitelnÃ½ 2. argument lze
pouÅ¾Ã­t ke zmÄ›nÄ› <code>file name</code> .</p></li>
<li><p><em>vman()</em> <code>vman &lt;file&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> jako manuÃ¡lovou strÃ¡nku.
<code>vman()</code> analyzuje nÃ¡zev a urÄuje sekci a takÃ© lokalizaci.
TakÃ© transparentnÄ› pÅ™evÃ¡dÃ­ gzipovanÃ© (.gz) a bzipovanÃ© (.bz2) manuÃ¡lovÃ©
strÃ¡nky na prostÃ½ text. PÅ™Ã­klad mapovÃ¡nÃ­:</p>
<ul>
<li><code>foo.1</code> -&gt;
<code>${DESTDIR}/usr/share/man/man1/foo.1</code></li>
<li><code>foo.fr.1</code> -&gt;
<code>${DESTDIR}/usr/share/man/fr/man1/foo.1</code></li>
<li><code>foo.1p</code> -&gt;
<code>${DESTDIR}/usr/share/man/man1/foo.1p</code></li>
<li><code>foo.1.gz</code> -&gt;
<code>${DESTDIR}/usr/share/man/man1/foo.1</code></li>
<li><code>foo.1.bz2</code> -&gt;
<code>${DESTDIR}/usr/share/man/man1/foo.1</code></li>
</ul></li>
<li><p><em>vdoc()</em> <code>vdoc &lt;file&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> do
<code>usr/share/doc/&lt;pkgname&gt;</code> v balÃ­Äku
<code>$DESTDIR</code> . VolitelnÃ½ 2. argument lze pouÅ¾Ã­t ke zmÄ›nÄ›
<code>file name</code> .</p></li>
<li><p><em>vconf()</em>
<code>vconf &lt;file&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> do <code>etc</code> v pkg
<code>$DESTDIR</code> . VolitelnÃ½ 2. argument lze pouÅ¾Ã­t ke zmÄ›nÄ›
<code>file name</code> .</p></li>
<li><p><em>vsconf()</em>
<code>vsconf &lt;file&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> do
<code>usr/share/examples/&lt;pkgname&gt;</code> v pkg
<code>$DESTDIR</code> . VolitelnÃ½ 2. argument lze pouÅ¾Ã­t ke zmÄ›nÄ›
<code>file name</code> .</p></li>
<li><p><a id="vlicense"></a> <em>vlicense()</em>
<code>vlicense &lt;file&gt; [&lt;name&gt;]</code></p>
<p>Nainstaluje <code>file</code> do
<code>usr/share/licenses/&lt;pkgname&gt;</code> v balÃ­Äku
<code>$DESTDIR</code> . VolitelnÃ½ 2. argument lze pouÅ¾Ã­t ke zmÄ›nÄ›
<code>file name</code> . PodÃ­vejte se <a href="#var_license">na
licenci</a> , kdy ji pouÅ¾Ã­t.</p></li>
<li><p><em>vsv()</em>
<code>vsv &lt;service&gt; [&lt;facility&gt;]</code></p>
<p>Nainstaluje <code>service</code> z <code>${FILESDIR}</code> do
/etc/sv. SluÅ¾ba musÃ­ bÃ½t adresÃ¡Å™ obsahujÃ­cÃ­ alespoÅˆ spouÅ¡tÄ›cÃ­ skript.
VÅ¡imnÄ›te si, Å¾e <code>supervise</code> symbolickÃ½ odkaz bude automaticky
vytvoÅ™en <code>vsv</code> a Å¾e spouÅ¡tÄ›cÃ­ skript je touto funkcÃ­
automaticky proveden jako spustitelnÃ½. DalÅ¡Ã­ informace o tom, jak
vytvoÅ™it novÃ½ adresÃ¡Å™ sluÅ¾eb, najdete <a
href="http://smarden.org/runit/faq.html#create">v pÅ™Ã­sluÅ¡nÃ© ÄÃ¡sti
FAQ</a> . Pokud ve <code>${FILESDIR}/$service</code> neexistuje, bude
automaticky vytvoÅ™ena podsluÅ¾ba <code>log</code> obsahujÃ­cÃ­
<code>exec vlogger -t $service -p $facility</code> . nenÃ­-li zadÃ¡n druhÃ½
argument, pouÅ¾ije se funkce <code>daemon</code> . DalÅ¡Ã­ informace o
<code>vlogger</code> a dostupnÃ½ch hodnotÃ¡ch pro zaÅ™Ã­zenÃ­ naleznete <a
href="https://man.voidlinux.org/vlogger.8">v ÄÃ¡sti vlogger(8)</a>
.</p></li>
<li><p><em>vsed()</em>
<code>vsed -i &lt;file&gt; -e &lt;regex&gt;</code></p>
<p>Wrapper kolem sed, kterÃ½ kontroluje sha256sum souboru pÅ™ed a po
spuÅ¡tÄ›nÃ­ pÅ™Ã­kazu sed, aby zjistil pÅ™Ã­pady, ve kterÃ½ch volÃ¡nÃ­ sed nic
nezmÄ›nilo. PÅ™ebÃ­rÃ¡ libovolnÃ© mnoÅ¾stvÃ­ souborÅ¯ a regexÅ¯ opakovanÃ½m
volÃ¡nÃ­m <code>-i file</code> a <code>-e regex</code> , musÃ­ bÃ½t
specifikovÃ¡n alespoÅˆ jeden soubor a jeden regex.</p>
<p>VÅ¡imnÄ›te si, Å¾e vsed zavolÃ¡ pÅ™Ã­kaz sed pro kaÅ¾dÃ½ zadanÃ½ regulÃ¡rnÃ­
vÃ½raz pro kaÅ¾dÃ½ zadanÃ½ soubor v poÅ™adÃ­, v jakÃ©m jsou zadÃ¡ny.</p></li>
<li><p><em>vcompletion()</em>
<code>&lt;file&gt; &lt;shell&gt; [&lt;command&gt;]</code></p>
<p>Nainstaluje dokonÄenÃ­ shellu ze <code>file</code> pro
<code>command</code> do sprÃ¡vnÃ©ho umÃ­stÄ›nÃ­ a s pÅ™Ã­sluÅ¡nÃ½m nÃ¡zvem souboru
pro <code>shell</code> . Pokud <code>command</code> nenÃ­ zadÃ¡n, bude
jako vÃ½chozÃ­ nastaven <code>pkgname</code> . Argument <code>shell</code>
mÅ¯Å¾e bÃ½t jeden z <code>bash</code> , <code>fish</code> nebo
<code>zsh</code> .</p></li>
<li><p><em>vextract()</em>
<code>[-C &lt;target directory&gt;] [--no-strip-components|--strip-components=&lt;n&gt;] &lt;file&gt;</code></p>
<p>Extrahuje <code>file</code> do <code>target directory</code> s
odstranÄ›nÃ½mi <code>n</code> adresÃ¡Å™ovÃ½mi komponentami. Pokud
<code>target directory</code> nenÃ­ zadÃ¡n, pouÅ¾ije se jako vÃ½chozÃ­
pracovnÃ­ adresÃ¡Å™. Pokud nenÃ­ zadÃ¡no <code>--strip-components</code> nebo
<code>--no-strip-components</code> , vÃ½chozÃ­ je
<code>--strip-components=1</code> .</p></li>
<li><p><em>vsrcextract()</em>
<code>[-C &lt;target directory&gt;] [--no-strip-components|--strip-components=&lt;n&gt;] &lt;file&gt;</code></p>
<p>Extrahuje
<code>$XBPS_SRCDISTDIR/$pkgname-$version/&lt;file&gt;</code> do
<code>target directory</code> s <code>n</code> odstranÄ›nÃ½mi komponentami
adresÃ¡Å™e. Pokud <code>target directory</code> nenÃ­ zadÃ¡n, pouÅ¾ije se
jako vÃ½chozÃ­ pracovnÃ­ adresÃ¡Å™. Pokud nenÃ­ zadÃ¡no
<code>--strip-components</code> nebo <code>--no-strip-components</code>
, vÃ½chozÃ­ je <code>--strip-components=1</code> .</p>
<p>To je uÅ¾iteÄnÃ© pÅ™i pouÅ¾itÃ­ ve spojenÃ­ s <code>skip_extraction</code>
a pro submodulovÃ© distfiles.</p></li>
<li><p><em>vsrccopy()</em>
<code>&lt;file&gt;... &lt;target&gt;</code></p>
<p>ZkopÃ­ruje <code>file</code> z
<code>$XBPS_SRCDISTDIR/$pkgname-$version/</code> do <code>target</code>
adresÃ¡Å™e a vytvoÅ™Ã­ <code>target</code> , pokud neexistuje.</p>
<p>To je uÅ¾iteÄnÃ© pÅ™i pouÅ¾itÃ­ ve spojenÃ­ s <code>skip_extraction</code>
.</p></li>
</ul>
<blockquote>
<p>ZÃ¡stupnÃ© znaky shellu musÃ­ bÃ½t sprÃ¡vnÄ› uvozovÃ¡ny, PÅ™Ã­klad:
<code>vmove "usr/lib/*.a"</code> .</p>
</blockquote>
<p><a id="global_vars"></a></p>
<h3 id="globÃ¡lnÃ­-promÄ›nnÃ©">GlobÃ¡lnÃ­ promÄ›nnÃ©</h3>
<p>NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© jsou definovÃ¡ny <code>xbps-src</code> a lze je
pouÅ¾Ã­t v jakÃ©koli Å¡ablonÄ›:</p>
<ul>
<li><p><code>makejobs</code> Nastavte na <code>-jX</code> pokud je
definovÃ¡no <code>XBPS_MAKEJOBS</code> , abyste povolili paralelnÃ­ Ãºlohy
s <code>GNU make</code> .</p></li>
<li><p><code>sourcepkg</code> Nastaveno na hlavnÃ­ nÃ¡zev balÃ­ku, lze jej
pouÅ¾Ã­t pro shodu s hlavnÃ­m balÃ­kem spÃ­Å¡e neÅ¾ s dalÅ¡Ã­mi nÃ¡zvy binÃ¡rnÃ­ch
balÃ­kÅ¯.</p></li>
<li><p><code>CHROOT_READY</code> Nastavte, zda je cÃ­lovÃ½ chroot
(masterdir) pÅ™ipraven pro sestavenÃ­ chrootu.</p></li>
<li><p><code>CROSS_BUILD</code> Nastavte, zda <code>xbps-src</code>
kÅ™Ã­Å¾ovÄ› kompiluje balÃ­Äek.</p></li>
<li><p><code>XBPS_CHECK_PKGS</code> Nastavte, zda bude
<code>xbps-src</code> spouÅ¡tÄ›t testy pro balÃ­Äek. DelÅ¡Ã­ testovacÃ­ sady
by mÄ›ly bÃ½t spouÅ¡tÄ›ny v <code>do_check()</code> pouze pokud je nastaveno
na <code>full</code> .</p></li>
<li><p><code>DESTDIR</code> ÃšplnÃ¡ cesta k faleÅ¡nÃ©mu destdir pouÅ¾Ã­vanÃ©mu
zdrojovÃ½m balÃ­Äkem pkg, nastavenÃ¡ na
<code>&lt;masterdir&gt;/destdir/${sourcepkg}-${version}</code>
.</p></li>
<li><p><code>FILESDIR</code> ÃšplnÃ¡ cesta k adresÃ¡Å™i balÃ­Äku
<code>files</code> , tj. <code>srcpkgs/foo/files</code> . AdresÃ¡Å™
<code>files</code> lze pouÅ¾Ã­t k uloÅ¾enÃ­ dalÅ¡Ã­ch souborÅ¯, kterÃ© se majÃ­
nainstalovat jako souÄÃ¡st zdrojovÃ©ho balÃ­Äku.</p></li>
<li><p><code>PKGDESTDIR</code> ÃšplnÃ¡ cesta k faleÅ¡nÃ©mu cÃ­lovÃ©mu adresÃ¡Å™i
pouÅ¾Ã­vanÃ©mu funkcÃ­ <code>pkg_install()</code> v <code>subpackages</code>
, nastavenÃ¡ na
<code>&lt;masterdir&gt;/destdir/${pkgname}-${version}</code> .</p></li>
<li><p><code>XBPS_BUILDDIR</code> AdresÃ¡Å™ pro uloÅ¾enÃ­
<code>source code</code> zpracovÃ¡vanÃ©ho zdrojovÃ©ho balÃ­Äku, nastavte na
<code>&lt;masterdir&gt;/builddir</code> . BalÃ­Äek <code>wrksrc</code> je
vÅ¾dy uloÅ¾en v tomto adresÃ¡Å™i, napÅ™Ã­klad
<code>${XBPS_BUILDDIR}/${wrksrc}</code> .</p></li>
<li><p><code>XBPS_MACHINE</code> Architektura stroje vrÃ¡cenÃ¡
<code>xbps-uhelper arch</code> .</p></li>
<li><p><code>XBPS_ENDIAN</code> Endianness stroje ("le" nebo
"be").</p></li>
<li><p><code>XBPS_LIBC</code> Knihovna C poÄÃ­taÄe ("glibc" nebo
"musl").</p></li>
<li><p><code>XBPS_WORDSIZE</code> Velikost slova stroje v bitech (32
nebo 64).</p></li>
<li><p><code>XBPS_NO_ATOMIC8</code> Stroj postrÃ¡dÃ¡ nativnÃ­ 64bitovÃ©
atomy (potÅ™ebuje emulaci libatomic).</p></li>
<li><p><code>XBPS_SRCDISTDIR</code> ÃšplnÃ¡ cesta k mÃ­stu, kde jsou
uloÅ¾eny <code>source distfiles</code> , tj.
<code>$XBPS_HOSTDIR/sources</code> .</p></li>
<li><p><code>XBPS_SRCPKGDIR</code> ÃšplnÃ¡ cesta k adresÃ¡Å™i
<code>srcpkgs</code> .</p></li>
<li><p><code>XBPS_TARGET_MACHINE</code> Architektura cÃ­lovÃ©ho poÄÃ­taÄe
pÅ™i kÅ™Ã­Å¾ovÃ© kompilaci balÃ­Äku.</p></li>
<li><p><code>XBPS_TARGET_ENDIAN</code> Endianness cÃ­lovÃ©ho poÄÃ­taÄe
("le" nebo "be").</p></li>
<li><p><code>XBPS_TARGET_LIBC</code> Knihovna C cÃ­lovÃ©ho poÄÃ­taÄe
("glibc" nebo "musl").</p></li>
<li><p><code>XBPS_TARGET_WORDSIZE</code> Velikost slova cÃ­lovÃ©ho
poÄÃ­taÄe v bitech (32 nebo 64).</p></li>
<li><p><code>XBPS_TARGET_NO_ATOMIC8</code> CÃ­lovÃ½ poÄÃ­taÄ postrÃ¡dÃ¡
nativnÃ­ 64bitovÃ© atomy (potÅ™ebuje emulaci libatomic).</p></li>
<li><p><code>XBPS_FETCH_CMD</code> NÃ¡stroj pro naÄÃ­tÃ¡nÃ­ souborÅ¯ z
<code>ftp</code> , <code>http</code> nebo <code>https</code>
serverÅ¯.</p></li>
<li><p><code>XBPS_WRAPPERDIR</code> ÃšplnÃ¡ cesta k mÃ­stu, kde jsou
uloÅ¾eny obaly xbps-src pro nÃ¡stroje.</p></li>
<li><p><code>XBPS_CROSS_BASE</code> ÃšplnÃ¡ cesta k mÃ­stu, kde jsou
nainstalovÃ¡ny zÃ¡vislosti mezi kompilacÃ­, se liÅ¡Ã­ podle cÃ­lovÃ©ho tripletu
architektury. tj. <code>aarch64</code> -&gt;
<code>/usr/aarch64-linux-gnu</code> .</p></li>
<li><p><code>XBPS_RUST_TARGET</code> Triplet cÃ­lovÃ© architektury
pouÅ¾Ã­vanÃ½ <code>rustc</code> a <code>cargo</code> .</p></li>
<li><p><code>XBPS_BUILD_ENVIRONMENT</code> UmoÅ¾Åˆuje operace specifickÃ©
pro prÅ¯bÄ›Å¾nou integraci. Pokud se jednÃ¡ o kontinuÃ¡lnÃ­ integraci,
nastavte na <code>void-packages-ci</code> .</p></li>
</ul>
<p><a id="available_vars"></a></p>
<h3 id="dostupnÃ©-promÄ›nnÃ©">DostupnÃ© promÄ›nnÃ©</h3>
<p><a id="mandatory_vars"></a></p>
<h4 id="povinnÃ©-promÄ›nnÃ©">PovinnÃ© promÄ›nnÃ©</h4>
<p>Seznam povinnÃ½ch promÄ›nnÃ½ch pro Å¡ablonu:</p>
<ul>
<li><p><code>homepage</code> URL odkazujÃ­cÃ­ na upstream domovskou
strÃ¡nku.</p></li>
<li><p><a id="var_license"></a> <code>license</code> A string matching
the license's <a href="https://spdx.org/licenses">SPDX Short
identifier</a>, <code>Public Domain</code>, or string prefixed with
<code>custom:</code> for other licenses. Multiple licenses should be
listed as an <a
href="https://spdx.github.io/spdx-spec/v3.0/annexes/SPDX-license-expressions/">SPDX
license expression</a> (examples: <code>MIT OR Apache-2.0</code>,
<code>MIT AND (LGPL-2.1-or-later OR BSD-3-Clause)</code>). Usage of
<code>AND</code>, <code>OR</code>, <code>WITH</code>, and
<code>()</code> are supported by xlint. The legacy comma-separated
format should be converted when encountered (example:
<code>GPL-3.0-or-later, custom:Hugware</code>).</p>
<p>PrÃ¡zdnÃ© metabalÃ­Äky, kterÃ© neobsahujÃ­ Å¾Ã¡dnÃ© soubory, a proto nemajÃ­ a
nevyÅ¾adujÃ­ Å¾Ã¡dnou licenci, by mÄ›ly pouÅ¾Ã­vat <code>Public Domain</code>
.</p>
<p>PoznÃ¡mka: <code>AGPL</code> , <code>MIT</code> , <code>BSD</code> ,
<code>ISC</code> , <code>X11</code> a vlastnÃ­ licence vyÅ¾adujÃ­, aby byl
licenÄnÃ­ soubor dodÃ¡n s binÃ¡rnÃ­m balÃ­Äkem.</p></li>
<li><p><code>maintainer</code> Å˜etÄ›zec ve tvaru
<code>name &lt;user@domain&gt;</code> . E-mail pro toto pole musÃ­ bÃ½t
platnÃ½ e-mail, na kterÃ©m vÃ¡s lze zastihnout. BalÃ­Äky pouÅ¾Ã­vajÃ­cÃ­ e-maily
<code>users.noreply.github.com</code> nebudou pÅ™ijÃ­mÃ¡ny.</p></li>
<li><p><code>pkgname</code> Å˜etÄ›zec s nÃ¡zvem balÃ­Äku, odpovÃ­dajÃ­cÃ­
<code>srcpkgs/&lt;pkgname&gt;</code> .</p></li>
<li><p><code>revision</code> ÄŒÃ­slo, kterÃ© musÃ­ bÃ½t nastaveno na 1 pÅ™i
vytvÃ¡Å™enÃ­ <code>source package</code> nebo aktualizovÃ¡no na novou
<code>upstream version</code> . Toto by mÄ›lo bÃ½t zvÃ½Å¡eno pouze tehdy,
kdyÅ¾ byly modifikovÃ¡ny generovanÃ© <code>binary packages</code>
.</p></li>
<li><p><code>short_desc</code> Å˜etÄ›zec se struÄnÃ½m popisem tohoto
balÃ­Äku. MaximÃ¡lnÄ› 72 znakÅ¯.</p></li>
<li><p><code>version</code> Å˜etÄ›zec s verzÃ­ balÃ­Äku. NesmÃ­ obsahovat
pomlÄky ani podtrÅ¾Ã­tko a je vyÅ¾adovÃ¡na alespoÅˆ jedna ÄÃ­slice. PouÅ¾itÃ­
substituce promÄ›nnÃ© Shell nenÃ­ povoleno.</p></li>
</ul>
<p><code>pkgname</code> a <code>version</code> jsou zakÃ¡zÃ¡ny obsahovat
speciÃ¡lnÃ­ znaky. Proto nenÃ­ nutnÃ© je citovat a podle konvence by ani
nemÄ›ly bÃ½t.</p>
<p><a id="optional_vars"></a></p>
<h4 id="nepovinnÃ©-promÄ›nnÃ©">NepovinnÃ© promÄ›nnÃ©</h4>
<ul>
<li><p><code>hostmakedepends</code> Seznam <code>host</code> zÃ¡vislostÃ­
potÅ™ebnÃ½ch k sestavenÃ­ balÃ­Äku, kterÃ½ bude nainstalovÃ¡n do hlavnÃ­ho
adresÃ¡Å™e. Verzi nenÃ­ tÅ™eba zadÃ¡vat, protoÅ¾e vÅ¾dy bude vyÅ¾adovÃ¡na
aktuÃ¡lnÃ­ verze v srcpkgs. PÅ™Ã­klad:
<code>hostmakedepends="foo blah"</code> .</p></li>
<li><p><code>makedepends</code> Seznam <code>target</code> zÃ¡vislostÃ­
potÅ™ebnÃ½ch k sestavenÃ­ balÃ­Äku, kterÃ½ bude nainstalovÃ¡n do hlavnÃ­ho
adresÃ¡Å™e. Verzi nenÃ­ tÅ™eba zadÃ¡vat, protoÅ¾e vÅ¾dy bude vyÅ¾adovÃ¡na
aktuÃ¡lnÃ­ verze v srcpkgs. PÅ™Ã­klad: <code>makedepends="foo blah"</code>
.</p></li>
<li><p><code>checkdepends</code> Seznam zÃ¡vislostÃ­ potÅ™ebnÃ½ch ke
spuÅ¡tÄ›nÃ­ kontrol balÃ­ÄkÅ¯, tj. skriptu nebo pravidla make specifikovanÃ©ho
ve funkci <code>do_check()</code> Å¡ablony. PÅ™Ã­klad:
<code>checkdepends="gtest"</code> .</p></li>
<li><p><code>depends</code> Seznam zÃ¡vislostÃ­ potÅ™ebnÃ½ch ke spuÅ¡tÄ›nÃ­
balÃ­Äku. Tyto zÃ¡vislosti se neinstalujÃ­ do hlavnÃ­ho adresÃ¡Å™e, ale
kontrolujÃ­ se pouze v pÅ™Ã­padÄ›, Å¾e v mÃ­stnÃ­m ÃºloÅ¾iÅ¡ti existuje binÃ¡rnÃ­
balÃ­Äek, kterÃ½ vyhovuje poÅ¾adovanÃ© verzi. ZÃ¡vislosti lze specifikovat
pomocÃ­ nÃ¡sledujÃ­cÃ­ch komparÃ¡torÅ¯ verzÃ­: <code>&lt;</code> ,
<code>&gt;</code> , <code>&lt;=</code> , <code>&gt;=</code> nebo
<code>foo-1.0_1</code> aby odpovÃ­daly pÅ™esnÃ© verzi. Pokud nenÃ­ definovÃ¡n
komparÃ¡tor verzÃ­ (pouze nÃ¡zev balÃ­Äku), je komparÃ¡tor verzÃ­ automaticky
nastaven na <code>&gt;=0</code> . PÅ™Ã­klad:
<code>depends="foo blah&gt;=1.0"</code> . DalÅ¡Ã­ informace naleznete v
ÄÃ¡sti <a href="#deps_runtime">ZÃ¡vislosti bÄ›hovÃ©ho prostÅ™edÃ­</a>
.</p></li>
<li><p><code>bootstrap</code> Je-li povoleno, je zdrojovÃ½ balÃ­Äek
povaÅ¾ovÃ¡n za souÄÃ¡st procesu <code>bootstrap</code> a vyÅ¾aduje se, aby
bylo moÅ¾nÃ© vytvÃ¡Å™et balÃ­Äky v chrootu. Tuto vlastnost musÃ­ nastavit
pouze malÃ½ poÄet balÃ­ÄkÅ¯.</p></li>
<li><p><code>conflicts</code> VolitelnÃ½ seznam balÃ­ÄkÅ¯, kterÃ© jsou v
konfliktu s tÃ­mto balÃ­Äkem. Konflikty lze zadat pomocÃ­ nÃ¡sledujÃ­cÃ­ch
komparÃ¡torÅ¯ verzÃ­: <code>&lt;</code> , <code>&gt;</code> ,
<code>&lt;=</code> , <code>&gt;=</code> nebo <code>foo-1.0_1</code> aby
odpovÃ­daly pÅ™esnÃ© verzi. Pokud nenÃ­ definovÃ¡n komparÃ¡tor verzÃ­ (pouze
nÃ¡zev balÃ­Äku), je komparÃ¡tor verzÃ­ automaticky nastaven na
<code>&gt;=0</code> . PÅ™Ã­klad:
<code>conflicts="foo blah&gt;=0.42.3"</code> .</p></li>
<li><p><code>distfiles</code> ÃšplnÃ¡ adresa URL pro <code>upstream</code>
zdrojovÃ© distribuÄnÃ­ soubory. VÃ­ce souborÅ¯ lze oddÄ›lit mezerami. Soubory
musÃ­ konÄit <code>.tar.lzma</code> , <code>.tar.xz</code> ,
<code>.txz</code> , <code>.tar.bz2</code> , <code>.tbz</code> ,
<code>.tar.gz</code> , <code>.tgz</code> , <code>.gz</code> ,
<code>.bz2</code> , <code>.tar</code> nebo <code>.zip</code> . Chcete-li
definovat cÃ­lovÃ½ nÃ¡zev souboru, pÅ™ipojte k adrese URL
<code>&gt;filename</code> . PÅ™Ã­klad: distfiles="<a
href="http://foo.org/foo-1.0.tar.gz">http://foo.org/foo-1.0.tar.gz</a>
<a
href="http://foo.org/bar-1.0.tar.gz&amp;gt;bar.tar.gz">http://foo.org/bar-1.0.tar.gz&amp;gt;bar.tar.gz</a>"</p>
<p>Aby se pÅ™edeÅ¡lo opakovÃ¡nÃ­, existuje nÄ›kolik promÄ›nnÃ½ch pro bÄ›Å¾nÃ©
hostitelskÃ© weby:</p>
<table>
<thead>
<tr>
<th>VariabilnÃ­</th>
<th>Hodnota</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPAN_SITE</td>
<td><a
href="https://cpan.perl.org/modules/by-module">https://cpan.perl.org/modules/by-module</a></td>
</tr>
<tr>
<td>DEBIAN_SITE</td>
<td><a
href="http://ftp.debian.org/debian/pool">http://ftp.debian.org/debian/pool</a></td>
</tr>
<tr>
<td>FREEDESKTOP_SITE</td>
<td><a
href="https://freedesktop.org/software">https://freedesktop.org/software</a></td>
</tr>
<tr>
<td>GNOME_SITE</td>
<td><a
href="https://ftp.gnome.org/pub/GNOME/sources">https://ftp.gnome.org/pub/GNOME/sources</a></td>
</tr>
<tr>
<td>GNU_SITE</td>
<td><a href="https://ftp.gnu.org/gnu">https://ftp.gnu.org/gnu</a></td>
</tr>
<tr>
<td>KERNEL_SITE</td>
<td><a
href="https://www.kernel.org/pub/linux">https://www.kernel.org/pub/linux</a></td>
</tr>
<tr>
<td>MOZILLA_SITE</td>
<td><a
href="https://ftp.mozilla.org/pub">https://ftp.mozilla.org/pub</a></td>
</tr>
<tr>
<td>NONGNU_SITE</td>
<td><a
href="https://download.savannah.nongnu.org/releases">https://download.savannah.nongnu.org/releases</a></td>
</tr>
<tr>
<td>PYPI_SITE</td>
<td><a
href="https://files.pythonhosted.org/packages/source">https://files.pythonhosted.org/packages/source</a></td>
</tr>
<tr>
<td>SOURCEFORGE_SITE</td>
<td><a
href="https://downloads.sourceforge.net/sourceforge">https://downloads.sourceforge.net/sourceforge</a></td>
</tr>
<tr>
<td>UBUNTU_SITE</td>
<td><a
href="http://archive.ubuntu.com/ubuntu/pool">http://archive.ubuntu.com/ubuntu/pool</a></td>
</tr>
<tr>
<td>XORG_SITE</td>
<td><a
href="https://www.x.org/releases/individual">https://www.x.org/releases/individual</a></td>
</tr>
<tr>
<td>KDE_SITE</td>
<td><a
href="https://download.kde.org/stable">https://download.kde.org/stable</a></td>
</tr>
<tr>
<td>VIDEOLAN_SITE</td>
<td><a
href="https://download.videolan.org/pub/videolan">https://download.videolan.org/pub/videolan</a></td>
</tr>
</tbody>
</table></li>
<li><p><code>checksum</code> Digesty <code>sha256</code> odpovÃ­dajÃ­cÃ­
<code>${distfiles}</code> . VÃ­ce souborÅ¯ lze oddÄ›lit mezerami.
UpozorÅˆujeme, Å¾e objednÃ¡vka musÃ­ bÃ½t stejnÃ¡, jako byla pouÅ¾ita v
<code>${distfiles}</code> . PÅ™Ã­klad:
<code>checksum="kkas00xjkjas"</code></p></li>
</ul>
<p>Pokud soubor distfile zmÄ›nÃ­ svÅ¯j kontrolnÃ­ souÄet pro kaÅ¾dÃ© staÅ¾enÃ­,
protoÅ¾e je zabalen za bÄ›hu na serveru, jako napÅ™. snapshot tarballs z
libovolnÃ©ho z <code>https://*.googlesource.com/</code> webÅ¯, kontrolnÃ­
souÄet <code>archive contents</code> lze urÄit pomocÃ­ pÅ™edÅ™azenÃ­ reklamy
na (@). U tarballÅ¯ mÅ¯Å¾ete najÃ­t kontrolnÃ­ souÄet obsahu pomocÃ­ pÅ™Ã­kazu
<code>tar xf &lt;tarball.ext&gt; --to-stdout | sha256sum</code> .</p>
<ul>
<li><p><code>wrksrc</code> NÃ¡zev adresÃ¡Å™e, do kterÃ©ho jsou extrahovÃ¡ny
zdroje balÃ­ÄkÅ¯, nastavenÃ½ na <code>${pkgname}-${version}</code>
.</p></li>
<li><p><code>build_wrksrc</code> AdresÃ¡Å™ souvisejÃ­cÃ­ s
<code>${wrksrc}</code> , kterÃ½ bude pouÅ¾it pÅ™i sestavovÃ¡nÃ­
balÃ­Äku.</p></li>
<li><p><code>create_wrksrc</code> Obvykle, po extrahovÃ¡nÃ­, pokud
existuje vÃ­ce souborÅ¯ a/nebo adresÃ¡Å™Å¯ nejvyÅ¡Å¡Ã­ ÃºrovnÄ› nebo pokud
neexistujÃ­ Å¾Ã¡dnÃ© adresÃ¡Å™e, soubory a adresÃ¡Å™e nejvyÅ¡Å¡Ã­ ÃºrovnÄ› budou
zabaleny do jednÃ© dalÅ¡Ã­ vrstvy adresÃ¡Å™e. Chcete-li toto chovÃ¡nÃ­ vynutit,
nastavte <code>create_wrksrc</code> .</p></li>
<li><p><code>build_style</code> UrÄuje <code>build method</code> pro
balÃ­Äek. PÅ™eÄtÄ›te si nÃ­Å¾e, abyste se dozvÄ›dÄ›li vÃ­ce o dostupnÃ½ch
<code>build methods</code> balÃ­ÄkÅ¯ nebo o efektu ponechÃ¡nÃ­ tohoto
nenastavenÃ©ho.</p></li>
<li><p><code>build_helper</code> mezerami oddÄ›lenÃ½ seznam souborÅ¯ v
<code>common/build-helper</code> kterÃ© majÃ­ bÃ½t zÃ­skÃ¡vÃ¡ny a jeho
promÄ›nnÃ© zpÅ™Ã­stupnÄ›ny v Å¡ablonÄ›. tj. <code>build_helper="rust"</code>
.</p></li>
<li><p><code>configure_script</code> NÃ¡zev <code>configure</code>
skriptu, kterÃ½ se mÃ¡ spustit ve fÃ¡zi <code>configure</code> , pokud je
<code>${build_style}</code> nastaveno na metody sestavenÃ­
<code>configure</code> nebo <code>gnu-configure</code> . StandardnÄ›
nastaveno na <code>./configure</code> .</p></li>
<li><p><code>configure_args</code> Argumenty, kterÃ© majÃ­ bÃ½t pÅ™edÃ¡ny
<code>configure</code> skriptu, pokud je <code>${build_style}</code>
nastaveno na metody sestavenÃ­ <code>configure</code> nebo
<code>gnu-configure</code> . Ve vÃ½chozÃ­m nastavenÃ­ musÃ­ bÃ½t pÅ™edpona
nastavena na <code>/usr</code> . V balÃ­ÄcÃ­ch <code>gnu-configure</code>
jsou nÄ›kterÃ© volby jiÅ¾ standardnÄ› nastaveny:
<code>--prefix=/usr --sysconfdir=/etc --infodir=/usr/share/info --mandir=/usr/share/man --localstatedir=/var</code>
.</p></li>
<li><p><code>make_cmd</code> SpustitelnÃ½ soubor, kterÃ½ se spustÃ­ ve fÃ¡zi
<code>build</code> , pokud je <code>${build_style}</code> nastaveno na
metody sestavenÃ­ <code>configure</code> , <code>gnu-configure</code>
nebo <code>gnu-makefile</code> . StandardnÄ› nastaveno na
<code>make</code> .</p></li>
<li><p><code>make_build_args</code> Argumenty, kterÃ© majÃ­ bÃ½t pÅ™edÃ¡ny do
<code>${make_cmd}</code> ve fÃ¡zi sestavovÃ¡nÃ­, pokud je
<code>${build_style}</code> nastaveno na metody sestavenÃ­
<code>configure</code> , <code>gnu-configure</code> nebo
<code>gnu-makefile</code> . Ve vÃ½chozÃ­m nastavenÃ­ zruÅ¡eno.</p></li>
<li><p><code>make_check_args</code> Argumenty, kterÃ© majÃ­ bÃ½t pÅ™edÃ¡ny do
<code>${make_cmd}</code> ve fÃ¡zi kontroly, pokud je
<code>${build_style}</code> nastaveno na metody sestavenÃ­
<code>configure</code> , <code>gnu-configure</code> nebo
<code>gnu-makefile</code> . Ve vÃ½chozÃ­m nastavenÃ­ zruÅ¡eno.</p></li>
<li><p><code>make_install_args</code> Argumenty, kterÃ© majÃ­ bÃ½t pÅ™edÃ¡ny
do <code>${make_cmd}</code> ve fÃ¡zi <code>install</code> , pokud je
<code>${build_style}</code> nastaveno na metody sestavenÃ­
<code>configure</code> , <code>gnu-configure</code> nebo
<code>gnu-makefile</code> .</p></li>
<li><p><code>make_build_target</code> CÃ­l sestavenÃ­. Pokud je
<code>${build_style}</code> nastaveno na <code>configure</code> ,
<code>gnu-configure</code> nebo <code>gnu-makefile</code> , toto je cÃ­l
pÅ™edanÃ½ <code>${make_cmd}</code> ve fÃ¡zi sestavenÃ­; kdyÅ¾ nenÃ­ nastaveno,
pouÅ¾ije se vÃ½chozÃ­ cÃ­l. Pokud <code>${build_style}</code> je
<code>python3-pep517</code> , toto je cesta k adresÃ¡Å™i balÃ­Äku, kterÃ½ by
mÄ›l bÃ½t vytvoÅ™en jako Python wheel; pokud nenÃ­ nastaveno, vÃ½chozÃ­
hodnota je <code>.</code> (aktuÃ¡lnÃ­ adresÃ¡Å™ s ohledem na
sestavenÃ­).</p></li>
<li><p><code>make_check_target</code> CÃ­l, kterÃ½ mÃ¡ bÃ½t pÅ™edÃ¡n do
<code>${make_cmd}</code> ve fÃ¡zi kontroly, pokud je
<code>${build_style}</code> nastaveno na metody sestavenÃ­
<code>configure</code> , <code>gnu-configure</code> nebo
<code>gnu-makefile</code> . Ve vÃ½chozÃ­m nastavenÃ­ je nastavena
<code>check</code> .</p></li>
<li><p><code>make_install_target</code> CÃ­l instalace. KdyÅ¾ je
<code>${build_style}{/code1} nastaven na {code2}configure{/code2}, {code3}gnu-configure{/code3} nebo {code4}gnu-makefile{/code4}, toto je cÃ­l pÅ™edanÃ½ {code5}${make_command}</code>
ve fÃ¡zi instalace; pokud nenÃ­ nastaveno, ve vÃ½chozÃ­m nastavenÃ­ se
<code>install</code> . Pokud <code>${build_style}</code> je
<code>python3-pep517</code>, jednÃ¡ se o cestu pythonovskÃ©ho kola
vytvoÅ™enÃ©ho fÃ¡zÃ­ sestavenÃ­, kterÃ¡ se nainstaluje; kdyÅ¾ nenÃ­ nastaveno,
styl sestavenÃ­ <code>python3-pep517</code> bude hledat wheel
odpovÃ­dajÃ­cÃ­ nÃ¡zvu a verzi balÃ­Äku v aktuÃ¡lnÃ­m adresÃ¡Å™i s ohledem na
instalaci.</p></li>
<li><p><code>make_check_pre</code> VÃ½raz pÅ™ed <code>${make_cmd}</code> .
To lze pouÅ¾Ã­t pro pÅ™Ã­kazy wrapper nebo pro nastavenÃ­ promÄ›nnÃ½ch
prostÅ™edÃ­ pro pÅ™Ã­kaz check. Ve vÃ½chozÃ­m nastavenÃ­ prÃ¡zdnÃ©.</p></li>
<li><p><code>patch_args</code> Argumenty, kterÃ© majÃ­ bÃ½t pÅ™edÃ¡ny pÅ™Ã­kazu
<code>patch(1)</code> pÅ™i aplikaci oprav na zdroje balÃ­ÄkÅ¯ bÄ›hem
<code>do_patch()</code> . Opravy jsou uloÅ¾eny ve
<code>srcpkgs/&lt;pkgname&gt;/patches</code> a musÃ­ bÃ½t ve formÃ¡tu
<code>-p1</code> . StandardnÄ› nastaveno na <code>-Np1</code> .</p></li>
<li><p><code>disable_parallel_build</code> Pokud je nastaveno, balÃ­Äek
nebude sestavovÃ¡n paralelnÄ› a <code>XBPS_MAKEJOBS</code> bude nastaven
na 1. Pokud balÃ­Äek nefunguje sprÃ¡vnÄ› s <code>XBPS_MAKEJOBS</code> , ale
stÃ¡le mÃ¡ mechanismus pro paralelnÃ­ sestavenÃ­, nastavte
<code>disable_parallel_build</code> a pouÅ¾ijte
<code>XBPS_ORIG_MAKEJOBS</code> (kterÃ½ mÃ¡ pÅ¯vodnÃ­ hodnotu z
<code>XBPS_MAKEJOBS</code> ) v Å¡ablonÄ›.</p></li>
<li><p><code>disable_parallel_check</code> Pokud sady testÅ¯ pro balÃ­Äek
nebudou sestaveny a spuÅ¡tÄ›ny paralelnÄ› a <code>XBPS_MAKEJOBS</code> bude
nastaveno na 1. Pokud balÃ­Äek nefunguje dobÅ™e s
<code>XBPS_MAKEJOBS</code> , ale stÃ¡le mÃ¡ mechanismus pro paralelnÃ­
spouÅ¡tÄ›nÃ­ kontrol, nastavte <code>disable_parallel_check</code> a
pouÅ¾ijte <code>XBPS_ORIG_MAKEJOBS</code> ( kterÃ½ mÃ¡ v Å¡ablonÄ› pÅ¯vodnÃ­
hodnotu <code>XBPS_MAKEJOBS</code> ).</p></li>
<li><p><code>make_check</code> Nastavuje pÅ™Ã­pady, ve kterÃ½ch se spustÃ­
fÃ¡ze <code>check</code> . Tato moÅ¾nost musÃ­ bÃ½t doplnÄ›na komentÃ¡Å™em
vysvÄ›tlujÃ­cÃ­m, proÄ testy selhÃ¡vajÃ­. PovolenÃ© hodnoty:</p>
<ul>
<li><code>yes</code> (vÃ½chozÃ­) ke spuÅ¡tÄ›nÃ­, pokud je nastaveno
<code>XBPS_CHECK_PKGS</code> .</li>
<li><code>extended</code> na spuÅ¡tÄ›nÃ­, pokud je
<code>XBPS_CHECK_PKGS</code> <code>full</code> .</li>
<li><code>ci-skip</code> se spustÃ­ lokÃ¡lnÄ›, pokud je nastaveno
<code>XBPS_CHECK_PKGS</code> , ale ne jako souÄÃ¡st kontrol poÅ¾adavku na
staÅ¾enÃ­.</li>
<li><code>no</code> nikdy nebÄ›hat.</li>
</ul></li>
<li><p><code>keep_libtool_archives</code> Je-li povoleno, archivy
<code>GNU Libtool</code> nebudou odstranÄ›ny. Ve vÃ½chozÃ­m nastavenÃ­ jsou
tyto soubory vÅ¾dy automaticky odstranÄ›ny.</p></li>
<li><p><code>skip_extraction</code> Seznam nÃ¡zvÅ¯ souborÅ¯, kterÃ© by
nemÄ›ly bÃ½t extrahovÃ¡ny ve fÃ¡zi <code>extract</code> . Toto musÃ­
odpovÃ­dat zÃ¡kladnÃ­mu nÃ¡zvu jakÃ©koli adresy URL definovanÃ© v
<code>${distfiles}</code> . PÅ™Ã­klad:
<code>skip_extraction="foo-${version}.tar.gz"</code> .</p></li>
<li><p><code>nodebug</code> Pokud je povoleno, balÃ­Äky -dbg se
nevygenerujÃ­, i kdyÅ¾ je nastaveno <code>XBPS_DEBUG_PKGS</code>
.</p></li>
<li><p><code>conf_files</code> Seznam konfiguraÄnÃ­ch souborÅ¯, kterÃ©
binÃ¡rnÃ­ balÃ­Äek vlastnÃ­; to pÅ™edpoklÃ¡dÃ¡ ÃºplnÃ© cesty, zÃ¡stupnÃ© znaky
budou rozÅ¡Ã­Å™eny a vÃ­ce poloÅ¾ek mÅ¯Å¾e bÃ½t oddÄ›leno mezerami. PÅ™Ã­klad:
<code>conf_files="/etc/foo.conf /etc/foo2.conf /etc/foo/*.conf"</code>
.</p></li>
<li><p><code>mutable_files</code> Seznam souborÅ¯, kterÃ© binÃ¡rnÃ­ balÃ­Äek
vlastnÃ­, s oÄekÃ¡vÃ¡nÃ­m, Å¾e tyto soubory budou zmÄ›nÄ›ny. Ty se chovajÃ­
hodnÄ› jako <code>conf_files</code> , ale bez pÅ™edpokladu, Å¾e je bude
upravovat ÄlovÄ›k.</p></li>
<li><p><code>make_dirs</code> Seznam poloÅ¾ek definujÃ­cÃ­ch adresÃ¡Å™e a
oprÃ¡vnÄ›nÃ­, kterÃ¡ majÃ­ bÃ½t vytvoÅ™ena pÅ™i instalaci. KaÅ¾dÃ½ zÃ¡znam by mÄ›l
bÃ½t oddÄ›len mezerou a sÃ¡m bude obsahovat mezery.
<code>make_dirs="/dir 0750 user group"</code> . UÅ¾ivatel, skupina a
reÅ¾im jsou vyÅ¾adovÃ¡ny na kaÅ¾dÃ©m Å™Ã¡dku, i kdyÅ¾ jsou
<code>755 root root</code> . Podle konvence existuje pouze jeden zÃ¡znam
<code>dir perms user group</code> na Å™Ã¡dek.</p></li>
<li><p><code>repository</code> Definuje ÃºloÅ¾iÅ¡tÄ›, do kterÃ©ho bude
balÃ­Äek umÃ­stÄ›n. Seznam platnÃ½ch ÃºloÅ¾iÅ¡Å¥ naleznete v <em>ÄÃ¡sti
ÃšloÅ¾iÅ¡tÄ›</em> .</p></li>
<li><p><code>nostrip</code> Pokud je nastaveno, binÃ¡rnÃ­ soubory ELF se
symboly ladÄ›nÃ­ nebudou odstranÄ›ny. Ve vÃ½chozÃ­m nastavenÃ­ jsou vÅ¡echny
binÃ¡rnÃ­ soubory odstranÄ›ny.</p></li>
<li><p><code>nostrip_files</code> Seznam binÃ¡rnÃ­ch souborÅ¯ ELF oddÄ›lenÃ½
mezerami, kterÃ© nebudou zbaveny ladicÃ­ch symbolÅ¯. Soubory mohou bÃ½t
zadÃ¡ny Ãºplnou cestou nebo nÃ¡zvem souboru.</p></li>
<li><p><code>noshlibprovides</code> Je-li nastaveno, nebudou binÃ¡rnÃ­
soubory ELF kontrolovÃ¡ny za ÃºÄelem shromaÅ¾ÄovÃ¡nÃ­ poskytnutÃ½ch sonames ve
sdÃ­lenÃ½ch knihovnÃ¡ch.</p></li>
<li><p><code>noverifyrdeps</code> Pokud je nastaveno, binÃ¡rnÃ­ soubory
ELF a sdÃ­lenÃ© knihovny nebudou kontrolovÃ¡ny za ÃºÄelem shromaÅ¾ÄovÃ¡nÃ­
jejich reverznÃ­ch zÃ¡vislostÃ­. MusÃ­te zadat vÅ¡echny zÃ¡vislosti v
<code>depends</code> , kdyÅ¾ to potÅ™ebujete nastavit.</p></li>
<li><p><code>skiprdeps</code> Seznam nÃ¡zvÅ¯ souborÅ¯ oddÄ›lenÃ½ch mezerami
urÄenÃ½mi jejich absolutnÃ­ cestou v <code>$DESTDIR</code> , kterÃ© nebudou
kontrolovÃ¡ny na zÃ¡vislosti za bÄ›hu. To mÅ¯Å¾e bÃ½t uÅ¾iteÄnÃ© pro pÅ™eskoÄenÃ­
souborÅ¯, kterÃ© nejsou urÄeny ke spuÅ¡tÄ›nÃ­ nebo naÄtenÃ­ na hostiteli, ale
majÃ­ bÃ½t odeslÃ¡ny na nÄ›jakÃ© cÃ­lovÃ© zaÅ™Ã­zenÃ­ nebo emulaci.</p></li>
<li><p><code>ignore_elf_files</code> Seznam souborÅ¯ strojovÃ©ho kÃ³du v
adresÃ¡Å™i /usr/share zadanÃ½ch absolutnÃ­ cestou oddÄ›lenÃ½ch mezerami, kterÃ©
jsou oÄekÃ¡vanÃ© a povolenÃ©.</p></li>
<li><p><code>ignore_elf_dirs</code> BÃ­lÃ½mi mezerami oddÄ›lenÃ½ seznam
adresÃ¡Å™Å¯ v adresÃ¡Å™i /usr/share specifikovanÃ½ch absolutnÃ­ cestou, kterÃ©
jsou oÄekÃ¡vÃ¡ny a kterÃ© mohou obsahovat soubory strojovÃ©ho kÃ³du.</p></li>
<li><p><code>nocross</code> Je-li nastaveno, kÅ™Ã­Å¾ovÃ¡ kompilace nebude
povolena a bude okamÅ¾itÄ› ukonÄena. Toto by mÄ›lo bÃ½t nastaveno na Å™etÄ›zec
popisujÃ­cÃ­, proÄ selÅ¾e, nebo na odkaz na buildlog (od oficiÃ¡lnÃ­ch
tvÅ¯rcÅ¯, CI buildlogy mohou zmizet) demonstrujÃ­cÃ­ selhÃ¡nÃ­.</p></li>
<li><p><code>restricted</code> Pokud je nastaveno, xbps-src odmÃ­tne
sestavit balÃ­Äek, pokud <code>etc/conf</code> nemÃ¡
<code>XBPS_ALLOW_RESTRICTED=yes</code> . PrimÃ¡rnÃ­ stavitelÃ© pro Void
Linux toto nastavenÃ­ nemajÃ­, takÅ¾e primÃ¡rnÃ­ ÃºloÅ¾iÅ¡tÄ› nebudou mÃ­t Å¾Ã¡dnÃ½
omezenÃ½ balÃ­Äek. To je uÅ¾iteÄnÃ© pro balÃ­Äky, kde licence zakazuje
redistribuci.</p></li>
<li><p><code>subpackages</code> Seznam dÃ­lÄÃ­ch balÃ­ÄkÅ¯ oddÄ›lenÃ½ch
mezerami (odpovÃ­dajÃ­cÃ­ <code>foo_package()</code> ), aby se pÅ™epsal
uhodnutÃ½ seznam. Toto pouÅ¾ijte pouze v pÅ™Ã­padÄ›, Å¾e je vyÅ¾adovÃ¡no
specifickÃ© poÅ™adÃ­ dÃ­lÄÃ­ch balÃ­ÄkÅ¯, jinak by ve vÄ›tÅ¡inÄ› pÅ™Ã­padÅ¯ fungovalo
vÃ½chozÃ­ nastavenÃ­.</p></li>
<li><p><code>metapackage</code> Pokud je nastaveno na <code>yes</code> ,
balÃ­Äek musÃ­ bÃ½t prÃ¡zdnÃ½ metabalÃ­Äek, tj. balÃ­Äek, kterÃ½ zÃ¡visÃ­ pouze na
jinÃ½ch balÃ­ÄcÃ­ch.</p></li>
<li><p><code>broken</code> Je-li nastaveno, sestavenÃ­ balÃ­Äku nebude
povoleno, protoÅ¾e jeho stav je aktuÃ¡lnÄ› poÅ¡kozen. Toto by mÄ›lo bÃ½t
nastaveno na Å™etÄ›zec popisujÃ­cÃ­, proÄ je poÅ¡kozenÃ½, nebo na odkaz na
buildlog demonstrujÃ­cÃ­ selhÃ¡nÃ­.</p></li>
<li><p><code>shlib_provides</code> Seznam dalÅ¡Ã­ch soname oddÄ›lenÃ½ch
mezerami, na kterÃ½ch balÃ­Äek poskytuje. To se spÃ­Å¡e pÅ™ipojÃ­ k
vygenerovanÃ©mu souboru neÅ¾ jej nahradÃ­.</p></li>
<li><p><code>shlib_requires</code> Seznam dalÅ¡Ã­ch sonames, kterÃ© balÃ­Äek
vyÅ¾aduje, oddÄ›lenÃ½ch mezerami. To se spÃ­Å¡e pÅ™ipojÃ­ k vygenerovanÃ©mu
souboru neÅ¾ jej nahradÃ­.</p></li>
<li><p><code>nopie</code> Pouze musÃ­ bÃ½t nastaveno na nÄ›co, aby bylo
aktivnÃ­, zakÃ¡Å¾e sestavenÃ­ balÃ­Äku s funkcemi zpevnÄ›nÃ­ (PIE, relro,
atd.). U vÄ›tÅ¡iny balÃ­ÄkÅ¯ to nenÃ­ nutnÃ©.</p></li>
<li><p><code>nopie_files</code> Seznam binÃ¡rnÃ­ch souborÅ¯ ELF oddÄ›lenÃ½ch
mezerami, kterÃ© nebudou kontrolovÃ¡ny na PIE. Soubory musÃ­ bÃ½t zadÃ¡ny
Ãºplnou cestou.</p></li>
<li><p><code>reverts</code> xbps podporuje unikÃ¡tnÃ­ funkci, kterÃ¡
umoÅ¾Åˆuje automatickÃ½ downgrade z poÅ¡kozenÃ½ch balÃ­ÄkÅ¯. V poli
<code>reverts</code> lze definovat seznam poÅ¡kozenÃ½ch pkgver, kterÃ½ by
mÄ›l vÃ½slednÃ½ balÃ­Äek vrÃ¡tit. Toto pole <em>musÃ­</em> bÃ½t definovÃ¡no pÅ™ed
poli <code>version</code> a <code>revision</code> , aby fungovalo podle
oÄekÃ¡vÃ¡nÃ­. Verze definovanÃ© v <code>reverts</code> musÃ­ bÃ½t vÄ›tÅ¡Ã­ neÅ¾
verze definovanÃ¡ ve <code>version</code> . PÅ™Ã­klad:</p>
<pre><code>reverts=&quot;2.0_1 2.0_2&quot;
version=1.9
revision=2</code></pre></li>
<li><p><code>alternatives</code> Seznam podporovanÃ½ch alternativ, kterÃ©
balÃ­Äek poskytuje, oddÄ›lenÃ½ mezerami. Seznam se sklÃ¡dÃ¡ ze tÅ™Ã­ sloÅ¾ek
oddÄ›lenÃ½ch dvojteÄkou: skupina, symbolickÃ½ odkaz a cÃ­l. PÅ™Ã­klad:
<code>alternatives="vi:/usr/bin/vi:/usr/bin/nvi ex:/usr/bin/ex:/usr/bin/nvi-ex"</code>
.</p></li>
<li><p><code>font_dirs</code> Seznam adresÃ¡Å™Å¯ oddÄ›lenÃ½ch mezerami urÄenÃ½
absolutnÃ­ cestou, kam balÃ­Äek pÃ­sem instaluje svÃ¡ pÃ­sma. PouÅ¾Ã­vÃ¡ se v
<code>x11-fonts</code> xbps-trigger k opÄ›tovnÃ©mu sestavenÃ­ mezipamÄ›ti
pÃ­sem bÄ›hem instalace/odebÃ­rÃ¡nÃ­ balÃ­Äku. PÅ™Ã­klad:
<code>font_dirs="/usr/share/fonts/TTF /usr/share/fonts/X11/misc"</code></p></li>
<li><p><code>dkms_modules</code> Seznam modulÅ¯ Dynamic Kernel Module
Support (dkms) oddÄ›lenÃ½ch mezerami, kterÃ© budou nainstalovÃ¡ny a
odstranÄ›ny <code>dkms</code> xbps-trigger s instalacÃ­/odstranÄ›nÃ­m
balÃ­Äku. FormÃ¡t je mezerou oddÄ›lenÃ½ pÃ¡r Å™etÄ›zcÅ¯, kterÃ© pÅ™edstavujÃ­ nÃ¡zev
modulu, vÄ›tÅ¡inou <code>pkgname</code> , a verzi modulu, vÄ›tÅ¡inou
<code>version</code> . PÅ™Ã­klad:
<code>dkms_modules="$pkgname $version zfs 4.14"</code></p></li>
<li><p><code>register_shell</code> Seznam shellÅ¯ oddÄ›lenÃ½ch mezerami
definovanÃ½ absolutnÃ­ cestou, kterÃ© majÃ­ bÃ½t zaregistrovÃ¡ny do databÃ¡ze
systÃ©movÃ½ch shellÅ¯. PouÅ¾Ã­vÃ¡ ho spouÅ¡tÄ›Ä <code>register-shell</code> .
PÅ™Ã­klad: <code>register_shell="/bin/tcsh /bin/csh"</code></p></li>
<li><p><code>tags</code> Seznam tagÅ¯ (kategoriÃ­) oddÄ›lenÃ½ch mezerami,
kterÃ© jsou registrovÃ¡ny v metadatech balÃ­Äku a uÅ¾ivatelÃ© je mohou
dotazovat pomocÃ­ <code>xbps-query</code> . PÅ™Ã­klad pro qutebrowser:
<code>tags="browser chromium-based qt5 python3"</code></p></li>
<li><p><code>perl_configure_dirs</code> Seznam oddÄ›lenÃ½ch prÃ¡zdnÃ½ch mÃ­st
ve vztahu k <code>wrksrc</code> , kterÃ© obsahujÃ­ soubory Makefile.PL,
kterÃ© musÃ­ bÃ½t procesy, aby balÃ­k fungoval. PouÅ¾Ã­vÃ¡ se v modulu
build_style perl a mimo nÄ›j nemÃ¡ Å¾Ã¡dnÃ© pouÅ¾itÃ­. PÅ™Ã­klad:
<code>perl_configure_dirs="blob/bob foo/blah"</code></p></li>
<li><p><code>preserve</code> Je-li nastaveno, soubory vlastnÄ›nÃ© balÃ­kem
v systÃ©mu nebudou pÅ™i aktualizaci, pÅ™einstalaci nebo odebrÃ¡nÃ­ balÃ­ku
odstranÄ›ny. To je vÄ›tÅ¡inou uÅ¾iteÄnÃ© pro balÃ­Äky jÃ¡dra, kterÃ© by nemÄ›ly
odstraÅˆovat soubory jÃ¡dra, kdyÅ¾ jsou odstranÄ›ny, pro pÅ™Ã­pad, Å¾e by to
mohlo pÅ™eruÅ¡it zavÃ¡dÄ›nÃ­ uÅ¾ivatele a naÄÃ­tÃ¡nÃ­ modulÅ¯. Jinak by se ve
vÄ›tÅ¡inÄ› pÅ™Ã­padÅ¯ nemÄ›l pouÅ¾Ã­vat.</p></li>
<li><p><code>fetch_cmd</code> SpustitelnÃ½ soubor, kterÃ½ se mÃ¡ pouÅ¾Ã­t k
naÄtenÃ­ URL v <code>distfiles</code> bÄ›hem fÃ¡ze <code>do_fetch</code>
.</p></li>
<li><p><code>changelog</code> URL odkazujÃ­cÃ­ na upstream changelog.
PreferovÃ¡ny jsou soubory s nezpracovanÃ½m textem.</p></li>
<li><p><code>archs</code> BÃ­lÃ½mi znaky oddÄ›lenÃ½ seznam architektur, pro
kterÃ© lze balÃ­Äek sestavit, dostupnÃ© architektury lze nalÃ©zt pod
<code>common/cross-profiles</code> . ObecnÄ› platÃ­, Å¾e <code>archs</code>
by mÄ›ly bÃ½t nastaveny pouze tehdy, pokud se upstream software vÃ½slovnÄ›
zamÄ›Å™uje na urÄitÃ© architektury nebo existuje pÃ¡dnÃ½ dÅ¯vod, proÄ by
software nemÄ›l bÃ½t dostupnÃ½ na nÄ›kterÃ½ch podporovanÃ½ch architekturÃ¡ch.
PÅ™edÅ™azenÃ­ vzoru vlnovkou znamenÃ¡ zÃ¡kaz stavÄ›t na naznaÄenÃ½ch obloucÃ­ch.
PrvnÃ­ odpovÃ­dajÃ­cÃ­ vzor se pouÅ¾ije pro povolenÃ­/zakÃ¡zÃ¡nÃ­ sestavenÃ­.
Pokud neodpovÃ­dÃ¡ Å¾Ã¡dnÃ½ vzor, â€‹â€‹balÃ­Äek se sestavÃ­, pokud poslednÃ­ vzor
obsahuje vlnovku. PÅ™Ã­klady:</p>
<pre><code> # Build package only for musl architectures
 archs=&quot;*-musl&quot;
 # Build package for x86_64-musl and any non-musl architecture
 archs=&quot;x86_64-musl ~*-musl&quot;
 # Default value (all arches)
 archs=&quot;*&quot;</code></pre></li>
</ul>
<p>DÅ™Ã­ve byla k dispozici speciÃ¡lnÃ­ hodnota <code>noarch</code> , ale od
tÃ© doby byla odstranÄ›na.</p>
<ul>
<li><p><code>nocheckperms</code> Je-li nastaveno, xbps-src neselÅ¾e pÅ™i
bÄ›Å¾nÃ½ch chybÃ¡ch oprÃ¡vnÄ›nÃ­ (svÄ›tovÃ© zapisovatelnÃ© soubory atd.)</p></li>
<li><p><code>nofixperms</code> Je-li nastaveno, xbps-src neopravÃ­ bÄ›Å¾nÃ©
chyby oprÃ¡vnÄ›nÃ­ (spustitelnÃ© manuÃ¡lovÃ© strÃ¡nky atd.)</p></li>
<li><p><code>no_generic_pkgconfig_link</code> Je-li nastaveno, xbps-src
nevytvoÅ™Ã­ pÅ™ed vytvoÅ™enÃ­m Å¡ablony symbolickÃ½ odkaz z
<code>$XBPS_CROSS_TRIPLET-pkg-config{/code1} na {code2}$XBPS_WRAPPERDIR/pkg-config</code>.</p></li>
</ul>
<p><a id="explain_depends"></a></p>
<h4 id="o-mnoha-typech-depends-promÄ›nnÃ½ch">O mnoha typech
<code>depends</code> promÄ›nnÃ½ch</h4>
<p>Doposud jsme uvedli ÄtyÅ™i typy <code>depends</code> promÄ›nnÃ½ch:
<code>hostmakedepends</code> , <code>makedepends</code> ,
<code>checkdepends</code> a <code>depends</code> . Tyto rÅ¯znÃ© druhy
promÄ›nnÃ½ch jsou nezbytnÃ©, protoÅ¾e <code>xbps-src</code> podporuje
kÅ™Ã­Å¾ovou kompilaci a aby se zabrÃ¡nilo instalaci zbyteÄnÃ½ch balÃ­ÄkÅ¯ v
prostÅ™edÃ­ sestavenÃ­.</p>
<p>BÄ›hem procesu sestavenÃ­ musÃ­ bÃ½t na hostiteli <em>spuÅ¡tÄ›ny</em>
programy, jako je <code>yacc</code> nebo kompilÃ¡tor C. BalÃ­Äky
obsahujÃ­cÃ­ tyto programy by mÄ›ly bÃ½t uvedeny v
<code>hostmakedepends</code> a budou nainstalovÃ¡ny na hostitele pÅ™i
sestavovÃ¡nÃ­ cÃ­lovÃ©ho balÃ­Äku. NÄ›kterÃ© z tÄ›chto balÃ­ÄkÅ¯ jsou zÃ¡vislÃ© na
balÃ­Äku <code>base-chroot</code> a nemusÃ­ bÃ½t uvedeny. Je moÅ¾nÃ©, Å¾e
nÄ›kterÃ© programy potÅ™ebnÃ© k sestavenÃ­ projektu jsou umÃ­stÄ›ny v balÃ­ÄcÃ­ch
<code>-devel</code> .</p>
<p>CÃ­lovÃ½ balÃ­Äek mÅ¯Å¾e takÃ© zÃ¡viset na jinÃ½ch balÃ­ÄcÃ­ch pro knihovny,
kterÃ© se majÃ­ odkazovat na soubory zÃ¡hlavÃ­ nebo na soubory zÃ¡hlavÃ­. Tyto
balÃ­Äky by mÄ›ly bÃ½t uvedeny v <code>makedepends</code> a budou odpovÃ­dat
cÃ­lovÃ© architektuÅ™e bez ohledu na architekturu sestavovacÃ­ho stroje.
Typicky budou <code>makedepends</code> obsahovat hlavnÄ› balÃ­Äky
<code>-devel</code> .</p>
<p>KromÄ› toho, pokud je nastaveno <code>XBPS_CHECK_PKGS</code> nebo je
pÅ™edÃ¡na volba <code>-Q</code> do <code>xbps-src</code> , mÅ¯Å¾e cÃ­lovÃ½
balÃ­Äek vyÅ¾adovat specifickÃ© zÃ¡vislosti nebo knihovny, kterÃ© jsou
propojeny s jeho testovacÃ­mi binÃ¡rnÃ­mi soubory, aby mohl spustit
testovacÃ­ sadu. Tyto zÃ¡vislosti by mÄ›ly bÃ½t uvedeny v
<code>checkdepends</code> a budou nainstalovÃ¡ny, jako by byly souÄÃ¡stÃ­
<code>hostmakedepends</code> . NÄ›kterÃ© zÃ¡vislosti, kterÃ© lze zahrnout do
<code>checkdepends</code> , jsou:</p>
<ul>
<li><code>dejagnu</code> : pouÅ¾Ã­vÃ¡ se pro nÄ›kterÃ© projekty GNU</li>
<li><code>cmocka-devel</code> : propojeno do testovacÃ­ch binÃ¡rnÃ­ch
souborÅ¯</li>
<li><code>dbus</code> : umoÅ¾Åˆuje spouÅ¡tÄ›t
<code>dbus-run-session &lt;test-command&gt;</code> a poskytovat relaci
D-Bus pro aplikace, kterÃ© to potÅ™ebujÃ­</li>
<li><code>git</code> : nÄ›kterÃ© testovacÃ­ sady spouÅ¡tÄ›jÃ­ pÅ™Ã­kaz
<code>git</code></li>
</ul>
<p><a id="deps_runtime"></a>A koneÄnÄ›, balÃ­Äek mÅ¯Å¾e vyÅ¾adovat urÄitÃ©
zÃ¡vislosti za bÄ›hu, bez kterÃ½ch je nepouÅ¾itelnÃ½. Tyto zÃ¡vislosti, pokud
je XBPS nezjistÃ­ automaticky, by mÄ›ly bÃ½t uvedeny v <code>depends</code>
.</p>
<p>Knihovny propojenÃ© objekty ELF jsou detekovÃ¡ny automaticky pomocÃ­
<code>xbps-src</code> , proto je nelze specifikovat v Å¡ablonÃ¡ch pomocÃ­
<code>depends</code> . Tato promÄ›nnÃ¡ by mÄ›la obsahovat:</p>
<ul>
<li>spustitelnÃ© soubory nazÃ½vanÃ© jako samostatnÃ© procesy.</li>
<li>ELF objekty pomocÃ­ dlopen(3).</li>
<li>neobjektovÃ½ kÃ³d, napÅ™. hlaviÄky C, moduly perl/python/ruby/etc.</li>
<li>datovÃ© soubory.</li>
<li>pÅ™epÃ­Å¡e minimÃ¡lnÃ­ verzi uvedenou v souboru
<code>common/shlibs</code> .</li>
</ul>
<p>ZÃ¡vislosti bÄ›hu pro objekty ELF se zjiÅ¡Å¥ujÃ­ kontrolou, kterÃ© SONAME
vyÅ¾adujÃ­, a potÃ© jsou SONAME mapovÃ¡ny na binÃ¡rnÃ­ nÃ¡zev balÃ­Äku s
minimÃ¡lnÃ­ poÅ¾adovanou verzÃ­. Soubor <code>common/shlibs</code> nastavuje
mapovÃ¡nÃ­ <code>&lt;SONAME&gt; &lt;pkgname&gt;&gt;=&lt;version&gt;</code>
.</p>
<p>NapÅ™Ã­klad balÃ­Äek <code>foo-1.0_1</code> poskytuje
<code>libfoo.so.1</code> SONAME a software vyÅ¾adujÃ­cÃ­ tuto knihovnu bude
odkazovat na <code>libfoo.so.1</code> ; vÃ½slednÃ½ binÃ¡rnÃ­ balÃ­Äek bude
mÃ­t zÃ¡vislost bÄ›hu na balÃ­Äku <code>foo&gt;=1.0_1</code> jak je uvedeno
v <code>common/shlibs</code> :</p>
<pre><code># common/shlibs
...
libfoo.so.1 foo-1.0_1
...</code></pre>
<ul>
<li>PrvnÃ­ pole urÄuje SONAME.</li>
<li>Ve druhÃ©m poli byl uveden nÃ¡zev balÃ­Äku a minimÃ¡lnÃ­ poÅ¾adovanÃ¡
verze.</li>
<li>TÅ™etÃ­ volitelnÃ© pole (obvykle nastavenÃ© na <code>ignore</code> ) lze
pouÅ¾Ã­t k pÅ™eskoÄenÃ­ kontrol v soname bumps.</li>
</ul>
<p>ZÃ¡vislosti deklarovanÃ© pÅ™es <code>depends</code> se neinstalujÃ­ do
hlavnÃ­ho adresÃ¡Å™e, spÃ­Å¡e se kontrolujÃ­, pokud existujÃ­ jako binÃ¡rnÃ­
balÃ­Äky, a jsou automaticky sestaveny <code>xbps-src</code> pokud zadanÃ¡
verze nenÃ­ v lokÃ¡lnÃ­m ÃºloÅ¾iÅ¡ti.</p>
<p>Ve speciÃ¡lnÃ­m pÅ™Ã­padÄ› mohou bÃ½t <code>virtual</code> zÃ¡vislosti
specifikovÃ¡ny jako runtime zÃ¡vislosti v promÄ›nnÃ© Å¡ablony
<code>depends</code> . NÄ›kolik rÅ¯znÃ½ch balÃ­ÄkÅ¯ mÅ¯Å¾e poskytovat bÄ›Å¾nou
funkcionalitu deklarovÃ¡nÃ­m virtuÃ¡lnÃ­ho nÃ¡zvu a verze v promÄ›nnÃ© Å¡ablony
<code>provides</code> (napÅ™ <code>provides="vpkg-0.1_1"</code> ).
BalÃ­Äky, kterÃ© se spolÃ©hajÃ­ na spoleÄnou funkÄnost bez ohledu na
konkrÃ©tnÃ­ho poskytovatele, mohou deklarovat zÃ¡vislost na nÃ¡zvu
virtuÃ¡lnÃ­ho balÃ­Äku s pÅ™edponou <code>virtual?</code> (napÅ™.
<code>depends="virtual?vpkg-0.1_1"</code> ). KdyÅ¾ je balÃ­Äek sestaven
pomocÃ­ <code>xbps-src</code> , bude potvrzena existence poskytovatelÅ¯
virtuÃ¡lnÃ­ch balÃ­ÄkÅ¯ a budou sestaveni v pÅ™Ã­padÄ› potÅ™eby. Mapa z
virtuÃ¡lnÃ­ch balÃ­ÄkÅ¯ na jejich vÃ½chozÃ­ poskytovatele je definovÃ¡na v
<code>etc/defaults.virtual</code> . JednotlivÃ¡ mapovÃ¡nÃ­ mohou bÃ½t
pÅ™epsÃ¡na mÃ­stnÃ­mi preferencemi v <code>etc/virtual</code> . KomentÃ¡Å™e v
<code>etc/defaults.virtual</code> poskytujÃ­ vÃ­ce informacÃ­ o tÃ©to
mapÄ›.</p>
<p>A koneÄnÄ›, obecnÄ› platÃ­, Å¾e pokud je balÃ­Äek sestavovÃ¡n pÅ™esnÄ›
stejnÃ½m zpÅ¯sobem bez ohledu na to, zda je konkrÃ©tnÃ­ balÃ­Äek pÅ™Ã­tomen v
<code>makedepends</code> nebo <code>hostmakedepends</code> , nemÄ›l by
bÃ½t tento balÃ­Äek pÅ™idÃ¡n jako zÃ¡vislost na Äase sestavenÃ­.</p>
<p><a id="repositories"></a></p>
<h3 id="ÃºloÅ¾iÅ¡tÄ›">ÃšloÅ¾iÅ¡tÄ›</h3>
<p><a id="repo_by_branch"></a></p>
<h4 id="repozitÃ¡Å™e-definovanÃ©-vÄ›tvÃ­">RepozitÃ¡Å™e definovanÃ© vÄ›tvÃ­</h4>
<p>GlobÃ¡lnÃ­ ÃºloÅ¾iÅ¡tÄ› pÅ™evezme nÃ¡zev aktuÃ¡lnÃ­ vÄ›tve, kromÄ› pÅ™Ã­padÅ¯, kdy
je nÃ¡zev vÄ›tve hlavnÃ­. Potom bude vÃ½slednÃ© ÃºloÅ¾iÅ¡tÄ› v globÃ¡lnÃ­m rozsahu.
ScÃ©nÃ¡Å™ pouÅ¾itÃ­ je takovÃ½, Å¾e uÅ¾ivatel mÅ¯Å¾e aktualizovat vÃ­ce balÃ­ÄkÅ¯ v
druhÃ© vÄ›tvi, aniÅ¾ by zneÄiÅ¡Å¥oval svÃ© mÃ­stnÃ­ ÃºloÅ¾iÅ¡tÄ›.</p>
<p><a id="pkg_defined_repo"></a></p>
<h4 id="repozitÃ¡Å™e-definovanÃ©-balÃ­Äkem">RepozitÃ¡Å™e definovanÃ©
balÃ­Äkem</h4>
<p>DruhÃ½m zpÅ¯sobem, jak definovat ÃºloÅ¾iÅ¡tÄ›, je nastavenÃ­ promÄ›nnÃ©
<code>repository</code> v Å¡ablonÄ›. TÃ­mto zpÅ¯sobem mÅ¯Å¾e sprÃ¡vce definovat
ÃºloÅ¾iÅ¡tÄ› pro konkrÃ©tnÃ­ balÃ­Äek nebo skupinu balÃ­ÄkÅ¯. To se v souÄasnosti
pouÅ¾Ã­vÃ¡ k rozliÅ¡enÃ­ mezi urÄitÃ½mi tÅ™Ã­dami balÃ­ÄkÅ¯.</p>
<p>NÃ¡sledujÃ­cÃ­ nÃ¡zvy ÃºloÅ¾iÅ¡Å¥ jsou platnÃ©:</p>
<ul>
<li><code>bootstrap</code> : ÃšloÅ¾iÅ¡tÄ› pro balÃ­Äky specifickÃ© pro
xbps-src.</li>
<li><code>debug</code> : ÃšloÅ¾iÅ¡tÄ› pro balÃ­Äky obsahujÃ­cÃ­ ladicÃ­ symboly.
TÃ©mÄ›Å™ ve vÅ¡ech pÅ™Ã­padech jsou tyto balÃ­Äky generovÃ¡ny automaticky.</li>
<li><code>nonfree</code> : ÃšloÅ¾iÅ¡tÄ› pro balÃ­Äky, kterÃ© jsou uzavÅ™enÃ½m
zdrojem nebo majÃ­ nesvobodnÃ© licence.</li>
</ul>
<p><a id="updates"></a></p>
<h3 id="kontrola-novÃ½ch-upstream-vydÃ¡nÃ­">Kontrola novÃ½ch upstream
vydÃ¡nÃ­</h3>
<p>NovÃ© upstream verze mohou bÃ½t automaticky kontrolovÃ¡ny pomocÃ­
<code>./xbps-src update-check &lt;pkgname&gt;</code> . V nÄ›kterÃ½ch
pÅ™Ã­padech je potÅ™eba pÅ™epsat rozumnÃ© vÃ½chozÃ­ hodnoty pÅ™iÅ™azenÃ­m
nÃ¡sledujÃ­cÃ­ch promÄ›nnÃ½ch v <code>update</code> souboru ve stejnÃ©m
adresÃ¡Å™i jako pÅ™Ã­sluÅ¡nÃ½ soubor <code>template</code> :</p>
<ul>
<li><p><code>site</code> obsahuje URL, kde je uvedeno ÄÃ­slo verze. Pokud
nenÃ­ nastaveno, jako vÃ½chozÃ­ se pouÅ¾ije <code>homepage</code> a
adresÃ¡Å™e, kde jsou uloÅ¾eny <code>distfiles</code> .</p></li>
<li><p><code>pkgname</code> je nÃ¡zev balÃ­Äku, kterÃ½ vÃ½chozÃ­ vzor
kontroluje. NenÃ­-li nastaveno, pouÅ¾ije se vÃ½chozÃ­ <code>pkgname</code>
ze Å¡ablony.</p></li>
<li><p><code>pattern</code> je regulÃ¡rnÃ­ vÃ½raz kompatibilnÃ­ s perl,
kterÃ½ odpovÃ­dÃ¡ ÄÃ­slu verze. UkotvÄ›te ÄÃ­slo verze pomocÃ­ <code>\K</code>
a <code>(?=...)</code> . PÅ™Ã­klad:
<code>pattern='&lt;b&gt;\K[\d.]+(?=&lt;/b&gt;)'</code> , toto odpovÃ­dÃ¡
ÄÃ­slu verze uzavÅ™enÃ©mu ve znaÄkÃ¡ch <code>&lt;b&gt;...&lt;/b&gt;</code>
.</p></li>
<li><p><code>ignore</code> je mezerami oddÄ›lenÃ½ seznam shellÅ¯, kterÃ©
odpovÃ­dajÃ­ ÄÃ­slÅ¯m verzÃ­, kterÃ© nejsou brÃ¡ny v Ãºvahu pÅ™i kontrole
novÄ›jÅ¡Ã­ch verzÃ­. PÅ™Ã­klad: <code>ignore="*b*"</code></p></li>
<li><p><code>version</code> je ÄÃ­slo verze pouÅ¾Ã­vanÃ© k porovnÃ¡nÃ­ s
upstream verzemi. PÅ™Ã­klad: <code>version=${version//./_}</code></p></li>
<li><p><code>single_directory</code> lze nastavit tak, aby zakÃ¡zalo
zjiÅ¡Å¥ovÃ¡nÃ­ adresÃ¡Å™e obsahujÃ­cÃ­ho jednu verzi zdrojÅ¯ v url a nÃ¡slednÃ©
hledÃ¡nÃ­ novÃ© verze v sousednÃ­ch adresÃ¡Å™Ã­ch.</p></li>
<li><p><code>vdprefix</code> je perl kompatibilnÃ­ regulÃ¡rnÃ­ vÃ½raz
odpovÃ­dajÃ­cÃ­ ÄÃ¡st, kterÃ¡ pÅ™edchÃ¡zÃ­ ÄÃ­selnÃ© ÄÃ¡sti adresÃ¡Å™e verze v url.
VÃ½chozÃ­ hodnota je <code>(|v|$pkgname)[-_.]*</code> .</p></li>
<li><p><code>vdsuffix</code> je perl kompatibilnÃ­ regulÃ¡rnÃ­ vÃ½raz
odpovÃ­dajÃ­cÃ­ ÄÃ¡st, kterÃ¡ nÃ¡sleduje ÄÃ­selnou ÄÃ¡st adresÃ¡Å™e verze v url.
VÃ½chozÃ­ hodnota je <code>(|\.x)</code> .</p></li>
<li><p><code>disabled</code> lze nastavit pro zakÃ¡zÃ¡nÃ­ kontroly
aktualizacÃ­ pro balÃ­Äek v pÅ™Ã­padech, kdy kontrola aktualizacÃ­ nenÃ­ moÅ¾nÃ¡
nebo nedÃ¡vÃ¡ smysl. Toto by mÄ›lo bÃ½t nastaveno na Å™etÄ›zec popisujÃ­cÃ­,
proÄ je zakÃ¡zÃ¡no.</p></li>
</ul>
<p><a id="patches"></a></p>
<h3 id="manipulace-s-nÃ¡plastmi">Manipulace s nÃ¡plastmi</h3>
<p>NÄ›kdy je potÅ™eba software opravit, nejÄastÄ›ji k opravÄ› nalezenÃ½ch
chyb nebo k opravÄ› kompilace s novÃ½m softwarem.</p>
<p>Pro Å™eÅ¡enÃ­ tohoto problÃ©mu mÃ¡ xbps-src funkci zÃ¡platovÃ¡nÃ­. VyhledÃ¡
vÅ¡echny soubory, kterÃ© odpovÃ­dajÃ­ globu
<code>srcpkgs/$pkgname/patches/*.{diff,patch}</code> a automaticky
pouÅ¾ije vÅ¡echny soubory, kterÃ© najde pomocÃ­ <code>patch(1)</code> s
<code>-Np1</code> . To se dÄ›je bÄ›hem fÃ¡ze <code>do_patch()</code> .
PromÄ›nnÃ¡ <code>PATCHESDIR</code> je k dispozici v Å¡ablonÄ› a ukazuje na
adresÃ¡Å™ <code>patches</code> .</p>
<p>ChovÃ¡nÃ­ zÃ¡platovÃ¡nÃ­ lze zmÄ›nit nÃ¡sledujÃ­cÃ­mi zpÅ¯soby:</p>
<ul>
<li><p>V adresÃ¡Å™i <code>patches</code> lze vytvoÅ™it soubor nazvanÃ½
<code>series</code> se seznamem oprav oddÄ›lenÃ½m novÃ½m Å™Ã¡dkem, kterÃ© se
majÃ­ aplikovat v uvedenÃ©m poÅ™adÃ­. Pokud je pÅ™Ã­tomen xbps-src, pouÅ¾ije
pouze zÃ¡platy uvedenÃ© v souboru <code>series</code> .</p></li>
<li><p>Soubor se stejnÃ½m nÃ¡zvem jako jeden z patchÅ¯, ale s pÅ™Ã­ponou
<code>.args</code> lze pouÅ¾Ã­t k nastavenÃ­ arg pÅ™edÃ¡vanÃ½ch
<code>patch(1)</code> . Pokud napÅ™Ã­klad <code>foo.patch</code> vyÅ¾aduje
pÅ™edÃ¡nÃ­ speciÃ¡lnÃ­ch argumentÅ¯ do <code>patch(1)</code> , kterÃ© nelze
pouÅ¾Ã­t pÅ™i aplikaci jinÃ½ch patchÅ¯, lze vytvoÅ™it
<code>foo.patch.args</code> obsahujÃ­cÃ­ tyto argumenty.</p></li>
</ul>
<p><a id="build_scripts"></a></p>
<h3 id="vytvÃ¡Å™et-stylovÃ©-skripty">vytvÃ¡Å™et stylovÃ© skripty</h3>
<p>PromÄ›nnÃ¡ <code>build_style</code> urÄuje metodu sestavenÃ­ pro
sestavenÃ­ a instalaci balÃ­Äku. OÄekÃ¡vÃ¡ nÃ¡zev libovolnÃ©ho dostupnÃ©ho
skriptu v adresÃ¡Å™i <code>void-packages/common/build-style</code> .
VezmÄ›te prosÃ­m na vÄ›domÃ­, Å¾e poÅ¾adovanÃ© balÃ­Äky pro spuÅ¡tÄ›nÃ­ skriptu
<code>build_style</code> musÃ­ bÃ½t definovÃ¡ny pomocÃ­
<code>$hostmakedepends</code> .</p>
<p>AktuÃ¡lnÃ­ seznam dostupnÃ½ch skriptÅ¯ <code>build_style</code> je
nÃ¡sledujÃ­cÃ­:</p>
<ul>
<li><p>Pokud <code>build_style</code> nenÃ­ nastaven, Å¡ablona musÃ­
(alespoÅˆ) definovat funkci <code>do_install()</code> a volitelnÄ› vÃ­ce
fÃ¡zÃ­ sestavenÃ­, jako je <code>do_configure()</code> ,
<code>do_build()</code> atd., a mÅ¯Å¾e pÅ™epsat vÃ½chozÃ­
<code>do_fetch()</code> a <code>do_extract()</code> , kterÃ© naÄÃ­tajÃ­ a
extrahovat soubory definovanÃ© v promÄ›nnÃ© <code>distfiles</code>
.</p></li>
<li><p><code>cargo</code> Pro balÃ­ky napsanÃ© v rzi, kterÃ© pouÅ¾Ã­vajÃ­
Cargo pro stavbu. KonfiguraÄnÃ­ argumenty (jako je
<code>--features</code> ) lze definovat v promÄ›nnÃ©
<code>configure_args</code> a jsou pÅ™edÃ¡ny do cargo bÄ›hem
<code>do_build</code> .</p></li>
<li><p><code>cmake</code> U balÃ­ÄkÅ¯, kterÃ© pouÅ¾Ã­vajÃ­ systÃ©m sestavenÃ­
CMake, lze konfiguraÄnÃ­ argumenty pÅ™edÃ¡vat pomocÃ­
<code>configure_args</code> . PromÄ›nnÃ¡ <code>cmake_builddir</code> mÅ¯Å¾e
bÃ½t definovÃ¡na tak, aby specifikovala adresÃ¡Å™ pro sestavenÃ­ pod
<code>build_wrksrc</code> namÃ­sto vÃ½chozÃ­ho <code>build</code>
.</p></li>
<li><p><code>configure</code> U balÃ­ÄkÅ¯, kterÃ© pouÅ¾Ã­vajÃ­ konfiguraÄnÃ­
skripty jinÃ© neÅ¾ GNU, by mÄ›lo bÃ½t pÅ™edÃ¡no alespoÅˆ
<code>--prefix=/usr</code> prostÅ™ednictvÃ­m <code>configure_args</code>
.</p></li>
<li><p><code>fetch</code> Pro balÃ­Äky, kterÃ© pouze naÄÃ­tajÃ­ soubory a
instalujÃ­ se tak, jak jsou, pomocÃ­ <code>do_install()</code> .</p></li>
<li><p><code>gnu-configure</code> Pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­
konfiguraÄnÃ­ skripty kompatibilnÃ­ s GNU autotools, lze dalÅ¡Ã­
konfiguraÄnÃ­ argumenty pÅ™edat pomocÃ­ <code>configure_args</code>
.</p></li>
<li><p><code>gnu-makefile</code> U balÃ­ÄkÅ¯, kterÃ© pouÅ¾Ã­vajÃ­ GNU make,
lze argumenty buildu pÅ™edat pomocÃ­ <code>make_build_args</code> a
argumenty instalace pomocÃ­ <code>make_install_args</code> . CÃ­l
sestavenÃ­ lze pÅ™epsat pomocÃ­ <code>make_build_target</code> a cÃ­l
instalace pomocÃ­ <code>make_install_target</code> . Tento styl
sestavovÃ¡nÃ­ se snaÅ¾Ã­ kompenzovat makefily, kterÃ© nerespektujÃ­ promÄ›nnÃ©
prostÅ™edÃ­, takÅ¾e dobÅ™e napsanÃ© makefily, ty, kterÃ© dÄ›lajÃ­ takovÃ© vÄ›ci,
jako je pÅ™ipojenÃ­ ( <code>+=</code> ) k promÄ›nnÃ½m, by mÄ›ly mÃ­t v tÄ›le
Å¡ablony nastaveno <code>make_use_env</code> .</p></li>
<li><p><code>go</code> Pro programy napsanÃ© v Go, kterÃ© se Å™Ã­dÃ­
standardnÃ­ strukturou balÃ­ÄkÅ¯. PromÄ›nnÃ¡ <code>go_import_path</code> musÃ­
bÃ½t nastavena na cestu importu balÃ­Äku, napÅ™.
<code>github.com/github/hub</code> pro program <code>hub</code> . Tyto
informace lze nalÃ©zt v souboru <code>go.mod</code> pro modernÃ­ projekty
Go. OÄekÃ¡vÃ¡ se, Å¾e distfile obsahuje balÃ­Äek, ale zÃ¡vislosti budou
staÅ¾eny pomocÃ­ <code>go get</code> .</p></li>
<li><p><code>R-cran</code> Pro balÃ­Äky, kterÃ© jsou dostupnÃ© v The
Comprehensive R Archive Network (CRAN). Styl sestavenÃ­ vyÅ¾aduje, aby
<code>pkgname</code> zaÄÃ­nal <code>R-cran-</code> a vÅ¡echny pomlÄky (
<code>-</code> ) ve verzi danÃ© CRAN byly nahrazeny znakem <code>r</code>
v promÄ›nnÃ© <code>version</code> . UmÃ­stÄ›nÃ­ <code>distfiles</code> bude
automaticky nastaveno a balÃ­Äek bude zÃ¡vislÃ½ na <code>R</code>
.</p></li>
<li><p><code>gemspec</code> Pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ soubory <a
href="https://guides.rubygems.org/specification-reference/">gemspec</a>
pro vytvoÅ™enÃ­ rubÃ­novÃ©ho drahokamu a jeho nÃ¡slednou instalaci. PÅ™Ã­kaz
gem lze pÅ™epsat pÅ™Ã­kazem <code>gem_cmd</code> .
<code>configure_args</code> lze pouÅ¾Ã­t k pÅ™edÃ¡nÃ­ argumentÅ¯ bÄ›hem
kompilace. Pokud vÃ¡Å¡ balÃ­Äek nepouÅ¾Ã­vÃ¡ zkompilovanÃ¡ rozÅ¡Ã­Å™enÃ­, zvaÅ¾te
pouÅ¾itÃ­ stylu sestavenÃ­ <code>gem</code> .</p></li>
<li><p><code>gem</code> Pro balÃ­Äky, kterÃ© se instalujÃ­ pomocÃ­ drahokamÅ¯
od <a href="https://rubygems.org/">RubyGems</a> . PÅ™Ã­kaz gem lze pÅ™epsat
pÅ™Ã­kazem <code>gem_cmd</code> . <code>distfiles</code> je nastaven
stylem sestavenÃ­, pokud tak Å¡ablona neÄinÃ­. Pokud vÃ¡Å¡ drahokam poskytuje
rozÅ¡Ã­Å™enÃ­, kterÃ¡ musÃ­ bÃ½t zkompilovÃ¡na, zvaÅ¾te pouÅ¾itÃ­ stylu sestavenÃ­
<code>gemspec</code> .</p></li>
<li><p><code>ruby-module</code> Pro balÃ­Äky, kterÃ© jsou moduly ruby â€‹â€‹a
lze je nainstalovat pÅ™es <code>ruby install.rb</code> . DalÅ¡Ã­ argumenty
instalace lze zadat pomocÃ­ <code>make_install_args</code> .</p></li>
<li><p><code>perl-ModuleBuild</code> Pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ metodu
Perl <a href="https://metacpan.org/pod/Module::Build">Module::Build</a>
.</p></li>
<li><p><code>perl-module</code> Pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ metodu
sestavenÃ­ Perl <a
href="http://perldoc.perl.org/ExtUtils/MakeMaker.html">ExtUtils::MakeMaker</a>
.</p></li>
<li><p><code>raku-dist</code> Pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ metodu
sestavenÃ­ Raku <code>raku-install-dist</code> s rakudo.</p></li>
<li><p><code>waf3</code> Pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ Python3 metodu
sestavenÃ­ <code>waf</code> s python3.</p></li>
<li><p><code>slashpackage</code> Pro balÃ­Äky, kterÃ© k sestavenÃ­
pouÅ¾Ã­vajÃ­ hierarchii /package a package/compile, jako je napÅ™Ã­klad
<code>daemontools</code> nebo jakÃ½koli <code>djb</code>
software.</p></li>
<li><p><code>qmake</code> U balÃ­ÄkÅ¯, kterÃ© pouÅ¾Ã­vajÃ­ profily Qt5/Qt6
qmake ( <code>*.pro</code> ), mohou bÃ½t argumenty qmake pro fÃ¡zi
configure pÅ™edÃ¡ny prostÅ™ednictvÃ­m <code>configure_args</code> ,
argumenty make build mohou bÃ½t pÅ™edÃ¡ny pomocÃ­
<code>make_build_args</code> a argumenty instalace pomocÃ­
<code>make_install_args</code> . CÃ­l sestavenÃ­ lze pÅ™epsat pomocÃ­
<code>make_build_target</code> a cÃ­l instalace pomocÃ­
<code>make_install_target</code> .</p></li>
<li><p><code>meson</code> U balÃ­ÄkÅ¯, kterÃ© pouÅ¾Ã­vajÃ­ systÃ©m Meson Build,
lze konfiguraÄnÃ­ volby pÅ™edat pÅ™es <code>configure_args</code> , pÅ™Ã­kaz
meson lze pÅ™epsat pomocÃ­ <code>meson_cmd</code> a umÃ­stÄ›nÃ­ out of source
buildu pomocÃ­ <code>meson_builddir</code></p></li>
<li><p><code>void-cross</code> Pro cross-toolchain balÃ­Äky pouÅ¾Ã­vanÃ© k
budovÃ¡nÃ­ Void systÃ©mÅ¯. NeexistujÃ­ Å¾Ã¡dnÃ© povinnÃ© promÄ›nnÃ© (cÃ­lovÃ½ triplet
je odvozen), ale mÅ¯Å¾ete zadat nÄ›kterÃ© volitelnÃ© -
<code>cross_gcc_skip_go</code> lze zadat pro pÅ™eskoÄenÃ­
<code>gccgo</code> , jednotlivÃ© argumenty konfigurace podprojektu lze
zadat pomocÃ­ <code>cross_*_configure_args</code> kde <code>*</code> je
<code>binutils</code> , <code>gcc_bootstrap</code> (pÅ™edÄasnÃ© gcc),
<code>gcc</code> (final gcc), <code>glibc</code> (nebo <code>musl</code>
), <code>configure_args</code> je navÃ­c pÅ™edÃ¡n jak ranÃ©mu, tak koneÄnÃ©mu
<code>gcc</code> . MÅ¯Å¾ete takÃ© zadat vlastnÃ­ <code>CFLAGS</code> a
<code>LDFLAGS</code> pro knihovnu libc jako
<code>cross_(glibc|musl)_(cflags|ldflags)</code> .</p></li>
<li><p><code>zig-build</code> Pro balÃ­Äky pouÅ¾Ã­vajÃ­cÃ­ systÃ©m sestavenÃ­
<a href="https://ziglang.org">Zig</a> . DalÅ¡Ã­ argumenty lze pÅ™edat
vyvolÃ¡nÃ­ <code>zig build</code> pomocÃ­ <code>configure_args</code>
.</p></li>
</ul>
<p>U balÃ­ÄkÅ¯, kterÃ© pouÅ¾Ã­vajÃ­ metodu sestavenÃ­ modulu Python (
<code>setup.py</code> nebo <a
href="https://www.python.org/dev/peps/pep-0517/">PEP 517</a> ), si
mÅ¯Å¾ete vybrat jednu z nÃ¡sledujÃ­cÃ­ch moÅ¾nostÃ­:</p>
<ul>
<li><p><code>python3-module</code> pro sestavenÃ­ modulÅ¯ Pythonu
3.x</p></li>
<li><p><code>python3-pep517</code> k sestavenÃ­ modulÅ¯ Pythonu 3.x, kterÃ©
poskytujÃ­ popis sestavenÃ­ PEP 517 bez skriptu
<code>setup.py</code></p></li>
</ul>
<p>PromÄ›nnÃ© prostÅ™edÃ­ pro konkrÃ©tnÃ­ <code>build_style</code> lze
deklarovat v nÃ¡zvu souboru, kterÃ½ odpovÃ­dÃ¡ nÃ¡zvu
<code>build_style</code> , PÅ™Ã­klad:</p>
<pre><code>`common/environment/build-style/gnu-configure.sh`</code></pre>
<ul>
<li><code>texmf</code> Pro texmf zip/tarballs, kterÃ© potÅ™ebujÃ­ jÃ­t do
/usr/share/texmf-dist. Zahrnuje manipulaci s duplikÃ¡ty.</li>
</ul>
<p><a id="build_helper"></a></p>
<h3 id="vytvÃ¡Å™et-pomocnÃ©-skripty">vytvÃ¡Å™et pomocnÃ© skripty</h3>
<p>PromÄ›nnÃ¡ <code>build_helper</code> specifikuje Ãºryvky shellu, kterÃ©
majÃ­ bÃ½t zÃ­skÃ¡vÃ¡ny a kterÃ© vytvoÅ™Ã­ vhodnÃ© prostÅ™edÃ­ pro prÃ¡ci s urÄitÃ½mi
sadami balÃ­ÄkÅ¯.</p>
<p>AktuÃ¡lnÃ­ seznam dostupnÃ½ch skriptÅ¯ <code>build_helper</code> je
nÃ¡sledujÃ­cÃ­:</p>
<ul>
<li><p><code>cmake-wxWidgets-gtk3</code> nastavuje promÄ›nnou
<code>WX_CONFIG</code> , kterou pouÅ¾Ã­vÃ¡ FindwxWidgets.cmake</p></li>
<li><p><code>gir</code> specifikuje zÃ¡vislosti pro nativnÃ­ a kÅ™Ã­Å¾ovÃ¡
sestavenÃ­ pro Å™eÅ¡enÃ­ GObject Introspection. NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© lze
nastavit v Å¡ablonÄ› pro zpracovÃ¡nÃ­ kÅ™Ã­Å¾ovÃ½ch sestavenÃ­, kterÃ¡ vyÅ¾adujÃ­
dalÅ¡Ã­ nÃ¡povÄ›du nebo vykazujÃ­ problÃ©my. <code>GIR_EXTRA_LIBS_PATH</code>
definuje dalÅ¡Ã­ cesty, kterÃ© se majÃ­ prohledÃ¡vat pÅ™i propojovÃ¡nÃ­ cÃ­lovÃ½ch
binÃ¡rnÃ­ch souborÅ¯, kterÃ© majÃ­ bÃ½t introspekovÃ¡ny.
<code>GIR_EXTRA_OPTIONS</code> definuje dalÅ¡Ã­ moÅ¾nosti pro
<code>g-ir-scanner-qemuwrapper</code> volajÃ­cÃ­
<code>qemu-&lt;target_arch&gt;-static</code> pÅ™i spuÅ¡tÄ›nÃ­ cÃ­lovÃ©ho
binÃ¡rnÃ­ho souboru. MÅ¯Å¾ete napÅ™Ã­klad zadat
<code>GIR_EXTRA_OPTIONS="-strace"</code> abyste vidÄ›li stopu toho, co se
stane pÅ™i spuÅ¡tÄ›nÃ­ tÃ©to binÃ¡rky.</p></li>
<li><p><code>meson</code> vytvoÅ™Ã­ kÅ™Ã­Å¾ovÃ½ soubor
<code>${XBPS_WRAPPERDIR}/meson/xbps_meson.cross</code> , kterÃ½
nakonfiguruje meson pro kÅ™Ã­Å¾ovÃ© sestavenÃ­. To je zvlÃ¡Å¡tÄ› uÅ¾iteÄnÃ© pro
sestavovÃ¡nÃ­ balÃ­ÄkÅ¯, kterÃ© zalamujÃ­ vyvolÃ¡nÃ­ mesonu (napÅ™. balÃ­Äky
<code>python3-pep517</code> , kterÃ© pouÅ¾Ã­vajÃ­ backend meson) a pÅ™idÃ¡vÃ¡
se standardnÄ› pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ styl sestavenÃ­
<code>meson</code> .</p></li>
<li><p><code>numpy</code> konfiguruje prostÅ™edÃ­ pro kÅ™Ã­Å¾ovou kompilaci
pythonovÃ½ch balÃ­ÄkÅ¯, kterÃ© poskytujÃ­ kompilovanÃ¡ rozÅ¡Ã­Å™enÃ­ odkazujÃ­cÃ­ na
knihovny NumPy C. Pokud je takÃ© nakonfigurovÃ¡n pomocnÃ­k sestavenÃ­
<code>meson</code> , zapÃ­Å¡e se sekundÃ¡rnÃ­ kÅ™Ã­Å¾ovÃ½ soubor
<code>${XBPS_WRAPPERDIR}/meson/xbps_numpy.cross</code> , aby informoval
meson, kde lze nalÃ©zt bÄ›Å¾nÃ© komponenty NumPy.</p></li>
<li><p><code>python3</code> konfiguruje prostÅ™edÃ­ cross-build tak, aby
pouÅ¾Ã­vala knihovny Pythonu, hlaviÄkovÃ© soubory a konfigurace interpretÅ¯
v cÃ­lovÃ©m koÅ™enovÃ©m adresÃ¡Å™i. PomocnÃ­k <code>python3</code> je
standardnÄ› pÅ™idÃ¡n pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ styly sestavenÃ­
<code>python3-module</code> nebo <code>python3-pep517</code> .</p></li>
<li><p><code>qemu</code> nastavuje dalÅ¡Ã­ promÄ›nnÃ© pro styly sestavenÃ­
<code>cmake</code> a <code>meson</code> , aby bylo moÅ¾nÃ© spouÅ¡tÄ›t
kÅ™Ã­Å¾ovÄ› kompilovanÃ© binÃ¡rnÃ­ soubory uvnitÅ™ qemu. NastavÃ­
<code>CMAKE_CROSSCOMPILING_EMULATOR</code> pro cmake a
<code>exe_wrapper</code> pro meson na
<code>qemu-&lt;target_arch&gt;-static</code> a
<code>QEMU_LD_PREFIX</code> na <code>XBPS_CROSS_BASE</code> . VytvoÅ™Ã­
takÃ© funkci <code>vtargetrun</code> pro zabalenÃ­ pÅ™Ã­kazÅ¯ do volÃ¡nÃ­
<code>qemu-&lt;target_arch&gt;-static</code> pro cÃ­lovou
architekturu.</p></li>
<li><p><code>qmake</code> vytvoÅ™Ã­ konfiguraÄnÃ­ soubor
<code>qt.conf</code> (srov. <code>qmake</code> <code>build_style</code>
) potÅ™ebnÃ½ pro kÅ™Ã­Å¾ovÃ¡ sestavenÃ­ a qmake-wrapper, aby <code>qmake</code>
pouÅ¾il tuto konfiguraci. CÃ­lem je opravit kÅ™Ã­Å¾ovÃ¡ sestavenÃ­ pro pÅ™Ã­pad,
Å¾e je styl sestavenÃ­ smÃ­Å¡enÃ½: napÅ™. kdyÅ¾ ve stylu
<code>gnu-configure</code> konfiguraÄnÃ­ skript volÃ¡ <code>qmake</code>
nebo <code>Makefile</code> ve stylu <code>gnu-makefile</code> . Toto je
pro balÃ­Äky Qt5.</p></li>
<li><p><code>qmake6</code> is like <code>qmake</code> but for
Qt6.</p></li>
<li><p><code>rust</code> specifikuje promÄ›nnÃ© prostÅ™edÃ­ poÅ¾adovanÃ© pro
kÅ™Ã­Å¾ovou kompilaci pÅ™epravek pÅ™es nÃ¡klad a pro kompilaci cargo -sys
pÅ™epravek. PÅ™idÃ¡vÃ¡ takÃ© obalovaÄ <code>cargo</code> , kterÃ½ detekuje a
prochÃ¡zÃ­ sestavami <code>cargo-auditable</code> . Tento pomocnÃ­k je
standardnÄ› pÅ™idÃ¡n pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­ styl sestavenÃ­
<code>cargo</code> .</p></li>
<li><p><code>haskell</code> specifikuje promÄ›nnÃ© prostÅ™edÃ­ pro cabal.
Tato pomocnÃ¡ funkce je standardnÄ› pÅ™idÃ¡na pro balÃ­Äky, kterÃ© pouÅ¾Ã­vajÃ­
styl sestavenÃ­ <code>haskell-stack</code> nebo <code>cabal</code>
.</p></li>
</ul>
<p><a id="functions"></a></p>
<h3 id="funkce">Funkce</h3>
<p>NÃ¡sledujÃ­cÃ­ funkce mohou bÃ½t definovÃ¡ny pro zmÄ›nu chovÃ¡nÃ­, jak se
balÃ­Äek stahuje, kompiluje a instaluje.</p>
<ul>
<li><p><code>pre_fetch()</code> Akce, kterÃ© se majÃ­ provÃ©st pÅ™ed
<code>do_fetch()</code> .</p></li>
<li><p><code>do_fetch()</code> pokud je definovÃ¡no a nenÃ­ nastaveno
<code>distfiles</code> , pouÅ¾ijte jej k naÄtenÃ­ poÅ¾adovanÃ½ch
zdrojÅ¯.</p></li>
<li><p><code>post_fetch()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_fetch()</code> .</p></li>
<li><p><code>pre_extract()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>post_fetch()</code> .</p></li>
<li><p><code>do_extract()</code> pokud je definovÃ¡no a nenÃ­ nastaveno
<code>distfiles</code> , pouÅ¾ijte jej k extrahovÃ¡nÃ­ poÅ¾adovanÃ½ch
zdrojÅ¯.</p></li>
<li><p><code>post_extract()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_extract()</code> .</p></li>
<li><p><code>pre_patch()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>post_extract()</code> .</p></li>
<li><p><code>do_patch()</code> pokud je definovÃ¡na, pouÅ¾ijte ji k
pÅ™Ã­pravÄ› prostÅ™edÃ­ pro sestavenÃ­ a spuÅ¡tÄ›nÃ­ hÃ¡ÄkÅ¯ pro aplikaci
zÃ¡plat.</p></li>
<li><p><code>post_patch()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_patch()</code> .</p></li>
<li><p><code>pre_configure()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>post_patch()</code> .</p></li>
<li><p><code>do_configure()</code> Akce pro provedenÃ­ konfigurace
balÃ­Äku; <code>${configure_args}</code> by mÄ›l bÃ½t stÃ¡le pÅ™edÃ¡n, pokud
se jednÃ¡ o konfiguraÄnÃ­ skript GNU.</p></li>
<li><p><code>post_configure()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_configure()</code> .</p></li>
<li><p><code>pre_build()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>post_configure()</code> .</p></li>
<li><p><code>do_build()</code> Akce k provedenÃ­ sestavenÃ­
balÃ­Äku.</p></li>
<li><p><code>post_build()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_build()</code> .</p></li>
<li><p><code>pre_check()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>post_build()</code> .</p></li>
<li><p><code>do_check()</code> Akce, kterÃ© se majÃ­ provÃ©st pro spuÅ¡tÄ›nÃ­
kontroly balÃ­Äku.</p></li>
<li><p><code>post_check()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_check()</code> .</p></li>
<li><p><code>pre_install()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>post_check()</code> .</p></li>
<li><p><code>do_install()</code> Akce, kterÃ© se majÃ­ provÃ©st k instalaci
souborÅ¯ balÃ­Äku do <code>fake destdir</code> .</p></li>
<li><p><code>post_install()</code> Akce, kterÃ© se majÃ­ provÃ©st po
<code>do_install()</code> .</p></li>
<li><p><code>do_clean()</code> Akce, kterÃ© se majÃ­ provÃ©st pro vyÄiÅ¡tÄ›nÃ­
po ÃºspÄ›Å¡nÃ© fÃ¡zi balÃ­Äku.</p></li>
</ul>
<blockquote>
<p>Funkce definovanÃ¡ v Å¡ablonÄ› mÃ¡ pÅ™ednost pÅ™ed stejnou funkcÃ­
definovanou skriptem <code>build_style</code> .</p>
</blockquote>
<p>AktuÃ¡lnÃ­ pracovnÃ­ adresÃ¡Å™ pro funkce je nastaven takto:</p>
<ul>
<li><p>Pro pre_fetch, pre_extract, do_clean:
<code>&lt;masterdir&gt;</code> .</p></li>
<li><p>Pro do_fetch, post_fetch: <code>XBPS_BUILDDIR</code> .</p></li>
<li><p>Pro do_extract pÅ™es do_patch: <code>wrksrc</code> .</p></li>
<li><p>Pro post_patch aÅ¾ post_install: <code>build_wrksrc</code> pokud
je definovÃ¡n, jinak <code>wrksrc</code> .</p></li>
</ul>
<p><a id="build_options"></a></p>
<h3 id="moÅ¾nosti-sestavenÃ­">MoÅ¾nosti sestavenÃ­</h3>
<p>NÄ›kterÃ© balÃ­Äky mohou bÃ½t sestaveny s rÅ¯znÃ½mi moÅ¾nostmi sestavenÃ­,
aby bylo moÅ¾nÃ© povolit/zakÃ¡zat dalÅ¡Ã­ funkce; Kolekce zdrojovÃ½ch balÃ­ÄkÅ¯
XBPS vÃ¡m to umoÅ¾Åˆuje pomocÃ­ nÄ›kolika jednoduchÃ½ch Ãºprav souboru
<code>template</code> .</p>
<p>NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© mohou bÃ½t nastaveny tak, aby umoÅ¾Åˆovaly moÅ¾nosti
sestavenÃ­ balÃ­Äku:</p>
<ul>
<li><p><code>build_options</code> Nastavuje moÅ¾nosti sestavenÃ­
podporovanÃ© zdrojovÃ½m balÃ­Äkem.</p></li>
<li><p><code>build_options_default</code> Nastavuje vÃ½chozÃ­ moÅ¾nosti
sestavenÃ­, kterÃ© mÃ¡ pouÅ¾Ã­t zdrojovÃ½ balÃ­Äek.</p></li>
<li><p><code>desc_option_&lt;option&gt;</code> NastavÃ­ popis pro
<code>option</code> volby sestavenÃ­ . To se musÃ­ shodovat s klÃ­ÄovÃ½m
slovem nastavenÃ½m v <em>build_options</em> . VÅ¡imnÄ›te si, Å¾e pokud je
moÅ¾nost sestavenÃ­ dostateÄnÄ› obecnÃ¡, jejÃ­ popis by mÄ›l bÃ½t mÃ­sto toho
pÅ™idÃ¡n do <code>common/options.description</code> .</p></li>
</ul>
<p>Po definovÃ¡nÃ­ tÄ›chto poÅ¾adovanÃ½ch promÄ›nnÃ½ch mÅ¯Å¾ete zkontrolovat
promÄ›nnou <code>build_option_&lt;option&gt;</code> , abyste vÄ›dÄ›li, zda
byla nastavena, a podle toho upravit zdrojovÃ½ balÃ­Äek. KromÄ› toho jsou k
dispozici nÃ¡sledujÃ­cÃ­ funkce:</p>
<ul>
<li><p><em>vopt_if()</em>
<code>vopt_if &lt;option&gt; &lt;if_true&gt; [&lt;if_false&gt;]</code></p>
<p>VÃ½stup <code>if_true</code> pokud je nastavena <code>option</code> ,
nebo <code>if_false</code> pokud nenÃ­ nastavena.</p></li>
<li><p><em>vopt_with()</em>
<code>vopt_with &lt;option&gt; [&lt;flag&gt;]</code></p>
<p>VÃ½stup <code>--with-&lt;flag&gt;</code> , pokud je tato moÅ¾nost
nastavena, nebo <code>--without-&lt;flag&gt;</code> v opaÄnÃ©m pÅ™Ã­padÄ›.
NenÃ­-li <code>flag</code> nastaven, vÃ½chozÃ­ je <code>option</code> .</p>
<p>PÅ™Ã­klady:</p>
<ul>
<li><code>vopt_with dbus</code></li>
<li><code>vopt_with xml xml2</code></li>
</ul></li>
<li><p><em>vopt_enable()</em>
<code>vopt_enable &lt;option&gt; [&lt;flag&gt;]</code></p>
<p>StejnÃ© jako <code>vopt_with</code> , ale pouÅ¾Ã­vÃ¡
<code>--enable-&lt;flag&gt;</code> a <code>--disable-&lt;flag&gt;</code>
.</p></li>
<li><p><em>vopt_conflict()</em>
<code>vopt_conflict &lt;option 1&gt; &lt;option 2&gt;</code></p>
<p>VydÃ¡ chybu a ukonÄÃ­ se, pokud jsou obÄ› moÅ¾nosti nastaveny
souÄasnÄ›.</p></li>
<li><p><em>vopt_bool()</em>
<code>vopt_bool &lt;option&gt; &lt;property&gt;</code></p>
<p>VÃ½stupy <code>-D&lt;property&gt;=true</code> pokud je volba
nastavena, nebo <code>-D&lt;property&gt;=false</code> v opaÄnÃ©m
pÅ™Ã­padÄ›.</p></li>
<li><p><em>vopt_feature()</em>
<code>vopt_feature &lt;option&gt; &lt;property&gt;</code></p>
<p>StejnÃ© jako <code>vopt_bool</code> , ale pouÅ¾Ã­vÃ¡
<code>-D&lt;property&gt;=enabled</code> a
<code>-D&lt;property&gt;=disabled</code> .</p></li>
</ul>
<p>NÃ¡sledujÃ­cÃ­ pÅ™Ã­klad ukazuje, jak zmÄ›nit zdrojovÃ½ balÃ­Äek, kterÃ½
pouÅ¾Ã­vÃ¡ konfiguraci GNU, aby povolil novou moÅ¾nost sestavenÃ­ pro podporu
obrÃ¡zkÅ¯ PNG:</p>
<pre><code># Template file for &#39;foo&#39;
pkgname=foo
version=1.0
revision=1
build_style=gnu-configure
configure_args=&quot;... $(vopt_with png)&quot;
makedepends=&quot;... $(vopt_if png libpng-devel)&quot;
...

# Package build options
build_options=&quot;png&quot;
desc_option_png=&quot;Enable support for PNG images&quot;

# To build the package by default with the `png` option:
#
# build_options_default=&quot;png&quot;

...
</code></pre>
<p>PodporovanÃ© moÅ¾nosti sestavenÃ­ pro zdrojovÃ½ balÃ­Äek lze zobrazit
pomocÃ­ <code>xbps-src</code> :</p>
<pre><code>$ ./xbps-src show-options foo</code></pre>
<p>MoÅ¾nosti sestavenÃ­ lze povolit pomocÃ­ parametru <code>-o</code>
<code>xbps-src</code> :</p>
<pre><code>$ ./xbps-src -o option,option1 &lt;cmd&gt; foo</code></pre>
<p>MoÅ¾nosti sestavenÃ­ lze zakÃ¡zat jejich pÅ™idÃ¡nÃ­m pÅ™edponu
<code>~</code> :</p>
<pre><code>$ ./xbps-src -o ~option,~option1 &lt;cmd&gt; foo</code></pre>
<p>Oba zpÅ¯soby lze pouÅ¾Ã­t spoleÄnÄ› k povolenÃ­ a/nebo zakÃ¡zÃ¡nÃ­ vÃ­ce
moÅ¾nostÃ­ souÄasnÄ› s <code>xbps-src</code> :</p>
<pre><code>$ ./xbps-src -o option,~option1,~option2 &lt;cmd&gt; foo</code></pre>
<p>MoÅ¾nosti sestavenÃ­ lze takÃ© zobrazit pro binÃ¡rnÃ­ balÃ­Äky pomocÃ­
<code>xbps-query(8)</code> :</p>
<pre><code>$ xbps-query -R --property=build-options foo</code></pre>
<p>TrvalÃ© globÃ¡lnÃ­ moÅ¾nosti sestavenÃ­ balÃ­Äku lze nastavit pomocÃ­
promÄ›nnÃ© <code>XBPS_PKG_OPTIONS</code> v konfiguraÄnÃ­m souboru
<code>etc/conf</code> . MoÅ¾nosti sestavenÃ­ pro jednotlivÃ© balÃ­Äky lze
nastavit pomocÃ­ <code>XBPS_PKG_OPTIONS_&lt;pkgname&gt;</code> .</p>
<blockquote>
<p>POZNÃMKA: Pokud <code>pkgname</code> obsahuje <code>dashes</code> ,
mÄ›ly by bÃ½t nahrazeny <code>underscores</code> PÅ™Ã­klad:
<code>XBPS_PKG_OPTIONS_xorg_server=opt</code> .</p>
</blockquote>
<p>Seznam podporovanÃ½ch voleb sestavenÃ­ balÃ­Äku a jeho popis je
definovÃ¡n v souboru <code>common/options.description</code> .</p>
<p><a id="install_remove_files"></a></p>
<h3 id="instalovat-a-odebrat-soubory">INSTALOVAT a ODEBRAT soubory</h3>
<p>ÃštrÅ¾ky shellu INSTALL a REMOVE lze pouÅ¾Ã­t k provedenÃ­ urÄitÃ½ch akcÃ­ v
urÄenÃ© fÃ¡zi, kdyÅ¾ je binÃ¡rnÃ­ balÃ­Äek instalovÃ¡n, aktualizovÃ¡n nebo
odstranÄ›n. ExistujÃ­ nÄ›kterÃ© promÄ›nnÃ©, kterÃ© jsou vÅ¾dy nastaveny
<code>xbps</code> pÅ™i provÃ¡dÄ›nÃ­ skriptÅ¯:</p>
<ul>
<li><code>$ACTION</code> : pro podmÃ­nÄ›nÃ­ jeho akcÃ­: <code>pre</code>
nebo <code>post</code> .</li>
<li><code>$PKGNAME</code> : nÃ¡zev balÃ­Äku.</li>
<li><code>$VERSION</code> : verze balÃ­Äku.</li>
<li><code>$UPDATE</code> : nastavte na <code>yes</code> pokud se balÃ­Äek
aktualizuje, <code>no</code> , pokud se balÃ­Äek <code>installed</code>
nebo <code>removed</code> .</li>
<li><code>$CONF_FILE</code> : ÃºplnÃ¡ cesta k <code>xbps.conf</code>
.</li>
<li><code>$ARCH</code> : cÃ­lovÃ¡ architektura, na kterÃ© bÄ›Å¾Ã­.</li>
</ul>
<p>PÅ™Ã­klad toho, jak mÃ¡ bÃ½t vytvoÅ™en skript <code>INSTALL</code> nebo
<code>REMOVE</code> , je uveden nÃ­Å¾e:</p>
<pre><code># INSTALL
case &quot;$ACTION&quot; in
pre)
    # Actions to execute before the package files are unpacked.
    ...
    ;;
post)
    if [ &quot;$UPDATE&quot; = &quot;yes&quot; ]; then
        # actions to execute if package is being updated.
        ...
    else
        # actions to execute if package is being installed.
        ...
    fi
    ;;
esac</code></pre>
<p>dÃ­lÄÃ­ balÃ­Äky mohou mÃ­t takÃ© svÃ© vlastnÃ­ soubory <code>INSTALL</code>
a <code>REMOVE</code> , jednoduÅ¡e je vytvoÅ™te jako
<code>srcpkgs/&lt;pkgname&gt;/&lt;subpkg&gt;.INSTALL</code> nebo
<code>srcpkgs/&lt;pkgname&gt;/&lt;subpkg&gt;.REMOVE</code> .</p>
<blockquote>
<p>POZNÃMKA: VÅ¾dy pouÅ¾Ã­vejte cesty relativnÄ› k aktuÃ¡lnÃ­mu pracovnÃ­mu
adresÃ¡Å™i, jinak pokud skripty nelze spustit pÅ™es <code>chroot(2)</code>
nebudou sprÃ¡vnÄ› fungovat.</p>
</blockquote>
<blockquote>
<p>POZNÃMKA: K tisku zprÃ¡v nepouÅ¾Ã­vejte skripty INSTALL/REMOVE, dalÅ¡Ã­
informace naleznete v dalÅ¡Ã­ ÄÃ¡sti.</p>
</blockquote>
<p><a id="install_remove_files_msg"></a></p>
<h3 id="installmsg-a-removemsg-soubory">INSTALL.msg a REMOVE.msg
soubory</h3>
<p>Soubory <code>INSTALL.msg</code> a <code>REMOVE.msg</code> lze pouÅ¾Ã­t
k vytiÅ¡tÄ›nÃ­ zprÃ¡vy v dobÄ› po instalaci nebo pÅ™ed odstranÄ›nÃ­m.</p>
<p>V ideÃ¡lnÃ­m pÅ™Ã­padÄ› by tyto soubory nemÄ›ly pÅ™esÃ¡hnout 80 znakÅ¯ na
Å™Ã¡dek.</p>
<p>dÃ­lÄÃ­ balÃ­Äky mohou mÃ­t takÃ© svÃ© vlastnÃ­ soubory
<code>INSTALL.msg</code> a <code>REMOVE.msg</code> , jednoduÅ¡e je
vytvoÅ™te jako
<code>srcpkgs/&lt;pkgname&gt;/&lt;subpkg&gt;.INSTALL.msg</code> nebo
<code>srcpkgs/&lt;pkgname&gt;/&lt;subpkg&gt;.REMOVE.msg</code> .</p>
<p>Toto by se mÄ›lo pouÅ¾Ã­vat pouze pro kritickÃ© zprÃ¡vy, jako je varovÃ¡nÃ­
uÅ¾ivatelÅ¯ o poruÅ¡enÃ­ zmÄ›n.</p>
<p><a id="runtime_account_creation"></a></p>
<h3 id="vytvÃ¡Å™enÃ­-systÃ©movÃ½ch-ÃºÄtÅ¯skupin-za-bÄ›hu">VytvÃ¡Å™enÃ­ systÃ©movÃ½ch
ÃºÄtÅ¯/skupin za bÄ›hu</h3>
<p>Existuje spouÅ¡tÄ›Ä spolu s nÄ›kterÃ½mi promÄ›nnÃ½mi, kterÃ© jsou specificky
urÄeny k vytvoÅ™enÃ­ <strong>systÃ©movÃ½ch uÅ¾ivatelÅ¯ a skupin</strong> pÅ™i
konfiguraci binÃ¡rnÃ­ho balÃ­Äku. K tomuto ÃºÄelu lze pouÅ¾Ã­t nÃ¡sledujÃ­cÃ­
promÄ›nnÃ©:</p>
<ul>
<li><p><code>system_groups</code> UrÄuje nÃ¡zvy novÃ½ch <em>skupin
systÃ©mÅ¯</em> , kterÃ© majÃ­ bÃ½t vytvoÅ™eny, oddÄ›lenÃ© mezerami. VolitelnÄ›
lze zadat <strong>gid</strong> oddÄ›lenÃ­m dvojteÄkou, tj.
<code>system_groups="_mygroup:78"</code> nebo
<code>system_groups="_foo _blah:8000"</code> .</p></li>
<li><p><code>system_accounts</code> UrÄuje jmÃ©na novÃ½ch
<strong>systÃ©movÃ½ch uÅ¾ivatelÅ¯/skupin,</strong> kterÃ© majÃ­ bÃ½t vytvoÅ™eny,
oddÄ›lenÃ¡ mezerami, tj <code>system_accounts="_foo _blah:22"</code> .
VolitelnÄ› lze <strong>uid</strong> a <strong>gid</strong> specifikovat
jejich oddÄ›lenÃ­m dvojteÄkou, tj. <code>system_accounts="_foo:48"</code>
. Pro zmÄ›nu chovÃ¡nÃ­ <strong>systÃ©movÃ½ch ÃºÄtÅ¯</strong> lze zadat dalÅ¡Ã­
promÄ›nnÃ©:</p>
<ul>
<li><code>&lt;account&gt;_homedir</code> domovskÃ½ adresÃ¡Å™ uÅ¾ivatele.
Pokud nenÃ­ nastaveno, vÃ½chozÃ­ je <code>/var/empty</code> .</li>
<li><code>&lt;account&gt;_shell</code> shell pro novÃ©ho uÅ¾ivatele. Pokud
nenÃ­ nastaveno, vÃ½chozÃ­ je <code>/sbin/nologin</code> .</li>
<li><code>&lt;account&gt;_descr</code> popis pro novÃ©ho uÅ¾ivatele. Pokud
nenÃ­ nastaveno, vÃ½chozÃ­ je
<code>&lt;account&gt; unprivileged user</code> .</li>
<li><code>&lt;account&gt;_groups</code> dalÅ¡Ã­ skupiny, kterÃ© majÃ­ bÃ½t
pÅ™idÃ¡ny pro novÃ©ho uÅ¾ivatele.</li>
<li><code>&lt;account&gt;_pgroup</code> pro nastavenÃ­ primÃ¡rnÃ­ skupiny,
ve vÃ½chozÃ­m nastavenÃ­ je primÃ¡rnÃ­ skupina nastavena na
<code>&lt;account&gt;</code> .</li>
</ul></li>
</ul>
<p><strong>SystÃ©movÃ½ uÅ¾ivatel</strong> je vytvoÅ™en pomocÃ­ dynamicky
pÅ™idÄ›lenÃ©ho <strong>uid/gid</strong> ve vaÅ¡em systÃ©mu a je vytvoÅ™en jako
<code>system account</code> , pokud nenÃ­ nastaveno <strong>uid</strong>
. Pro zadanÃ½ <code>system account</code> bude vytvoÅ™ena novÃ¡ skupina a
bude pouÅ¾ita vÃ½hradnÄ› pro tento ÃºÄel.</p>
<p>SystÃ©movÃ© ÃºÄty a skupiny musÃ­ mÃ­t pÅ™edponu podtrÅ¾Ã­tka, aby se
pÅ™edeÅ¡lo stÅ™etu s nÃ¡zvy uÅ¾ivatelskÃ½ch ÃºÄtÅ¯.</p>
<blockquote>
<p>POZNÃMKA: ZÃ¡sady podtrÅ¾enÃ­ se nevztahujÃ­ na starÃ© balÃ­Äky, kvÅ¯li
nevyhnutelnÃ©mu poruÅ¡enÃ­ zmÄ›ny uÅ¾ivatelskÃ©ho jmÃ©na by se podle nÄ›j mÄ›ly
Å™Ã­dit pouze novÃ© balÃ­Äky.</p>
</blockquote>
<p><a id="writing_runit_services"></a></p>
<h3 id="psanÃ­-runitovÃ½ch-sluÅ¾eb">PsanÃ­ runitovÃ½ch sluÅ¾eb</h3>
<p>Void Linux pouÅ¾Ã­vÃ¡ <a href="http://smarden.org/runit/">runit</a> pro
bootovÃ¡nÃ­ a dohled nad sluÅ¾bami.</p>
<p>VÄ›tÅ¡inu informacÃ­ o tom, jak je napsat, najdete v jejich <a
href="http://smarden.org/runit/faq.html#create">FAQ</a> . NÃ¡sledujÃ­
pokyny specifickÃ© pro Void Linux, jak psÃ¡t sluÅ¾by.</p>
<p>Pokud dÃ©mon sluÅ¾by podporuje pÅ™Ã­znaky CLI, zvaÅ¾te pÅ™idÃ¡nÃ­ podpory pro
jeho zmÄ›nu prostÅ™ednictvÃ­m promÄ›nnÃ© <code>OPTS</code> ÄtenÃ­m souboru s
nÃ¡zvem <code>conf</code> ve stejnÃ©m adresÃ¡Å™i jako dÃ©mon.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> <span class="ot">-r</span> conf <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">.</span> ./conf</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> daemon <span class="va">${OPTS</span><span class="op">:-</span> --flag-enabled-by-default<span class="va">}</span></span></code></pre></div>
<p>Pokud sluÅ¾ba vyÅ¾aduje vytvoÅ™enÃ­ adresÃ¡Å™e pod <code>/run</code> nebo
jeho odkazu <code>/var/run</code> pro uklÃ¡dÃ¡nÃ­ runtime informacÃ­ (jako
Pidfiles), zapiÅ¡te jej do souboru sluÅ¾by. Pokud jej potÅ™ebujete vytvoÅ™it
se specifickÃ½mi oprÃ¡vnÄ›nÃ­mi, doporuÄujeme pouÅ¾Ã­t <code>install</code>
namÃ­sto <code>mkdir -p</code> .</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install</span> <span class="at">-d</span> <span class="at">-m0700</span> /run/foo</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> foo</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install</span> <span class="at">-d</span> <span class="at">-m0700</span> <span class="at">-o</span> bar <span class="at">-g</span> bar /run/bar</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> bar</span></code></pre></div>
<p>Pokud sluÅ¾ba vyÅ¾aduje adresÃ¡Å™e v ÄÃ¡stech systÃ©mu, kterÃ© obecnÄ› nejsou
v doÄasnÃ½ch souborovÃ½ch systÃ©mech. PotÃ© pouÅ¾ijte promÄ›nnou
<code>make_dirs</code> v Å¡ablonÄ› k vytvoÅ™enÃ­ tÄ›chto adresÃ¡Å™Å¯, kdyÅ¾ je
balÃ­Äek nainstalovÃ¡n.</p>
<p>Pokud balÃ­Äek nainstaluje servisnÃ­ soubor systemd nebo jinou
jednotku, ponechte jej na mÃ­stÄ› jako referenÄnÃ­ bod, pokud jeho zahrnutÃ­
nemÃ¡ Å¾Ã¡dnÃ© negativnÃ­ vedlejÅ¡Ã­ ÃºÄinky.</p>
<p>PÅ™Ã­klady, kdy <em>neinstalovat</em> systÃ©movÃ© jednotky:</p>
<ol type="1">
<li>KdyÅ¾ tak uÄinÃ­te, zmÄ›nÃ­ se bÄ›hovÃ© chovÃ¡nÃ­ pÅ™ibalenÃ©ho softwaru.</li>
<li>KdyÅ¾ se to provÃ¡dÃ­ pomocÃ­ pÅ™Ã­znaku doby kompilace, kterÃ½ takÃ© mÄ›nÃ­
zÃ¡vislosti sestavenÃ­.</li>
</ol>
<p><a id="32bit_pkgs"></a></p>
<h3 id="32bitovÃ©-balÃ­Äky">32bitovÃ© balÃ­Äky</h3>
<p>32bitovÃ© balÃ­Äky se sestavujÃ­ automaticky, kdyÅ¾ je tvÅ¯rce x86
(32bit), ale existujÃ­ nÄ›kterÃ© promÄ›nnÃ©, kterÃ© mohou chovÃ¡nÃ­ zmÄ›nit:</p>
<ul>
<li><p><code>lib32depends</code> Je-li tato promÄ›nnÃ¡ nastavena, budou
zde uvedenÃ© zÃ¡vislosti pouÅ¾ity spÃ­Å¡e neÅ¾ zÃ¡vislosti detekovanÃ©
automaticky <code>xbps-src</code> a <strong>zÃ¡visÃ­</strong> . VezmÄ›te
prosÃ­m na vÄ›domÃ­, Å¾e zÃ¡vislosti musÃ­ bÃ½t specifikovÃ¡ny pomocÃ­
komparÃ¡torÅ¯ verzÃ­, PÅ™Ã­klad:
<code>lib32depends="foo&gt;=0 blah&lt;2.0"</code> .</p></li>
<li><p><code>lib32disabled</code> Pokud je tato promÄ›nnÃ¡ nastavena,
nebude sestaven Å¾Ã¡dnÃ½ 32bitovÃ½ balÃ­Äek.</p></li>
<li><p><code>lib32files</code> DalÅ¡Ã­ soubory, kterÃ© majÃ­ bÃ½t pÅ™idÃ¡ny do
<strong>32bitovÃ©ho</strong> balÃ­Äku. To oÄekÃ¡vÃ¡ absolutnÃ­ cesty oddÄ›lenÃ©
mezerami, PÅ™Ã­klad:
<code>lib32files="/usr/bin/blah /usr/include/blah."</code> .</p></li>
<li><p><code>lib32symlinks</code> VytvoÅ™Ã­ symbolickÃ½ odkaz cÃ­lovÃ©ho
souboru uloÅ¾enÃ©ho v adresÃ¡Å™i <code>lib32</code> . To oÄekÃ¡vÃ¡ zÃ¡kladnÃ­
nÃ¡zev cÃ­lovÃ©ho souboru, PÅ™Ã­klad: <code>lib32symlinks="foo"</code>
.</p></li>
<li><p><code>lib32mode</code> Pokud nenÃ­ nastaveno, do
<strong>32bitovÃ©ho</strong> balÃ­Äku budou zkopÃ­rovÃ¡ny pouze
sdÃ­lenÃ©/statickÃ© knihovny a soubory pkg-config. Pokud je nastaveno na
<code>full</code> vÅ¡echny soubory budou zkopÃ­rovÃ¡ny do 32bitovÃ©ho
balÃ­Äku, nezmÄ›nÄ›nÃ©.</p></li>
</ul>
<p><a id="pkgs_sub"></a></p>
<h3 id="dÃ­lÄÃ­-balÃ­Äky">DÃ­lÄÃ­ balÃ­Äky</h3>
<p>Ve vÃ½Å¡e uvedenÃ©m pÅ™Ã­kladu se vygeneruje pouze binÃ¡rnÃ­ balÃ­Äek, ale
pomocÃ­ nÄ›kterÃ½ch jednoduchÃ½ch vylepÅ¡enÃ­ lze z jednÃ© Å¡ablony/sestavenÃ­
vygenerovat vÃ­ce binÃ¡rnÃ­ch balÃ­ÄkÅ¯, tomu se Å™Ã­kÃ¡
<code>subpackages</code> .</p>
<p>Chcete-li vytvoÅ™it dalÅ¡Ã­ <code>subpackages</code> musÃ­
<code>template</code> definovat novou funkci s tÃ­mto nÃ¡zvem:
<code>&lt;subpkgname&gt;_package()</code> , PÅ™Ã­klad:</p>
<pre><code># Template file for &#39;foo&#39;
pkgname=foo
version=1.0
revision=1
build_style=gnu-configure
short_desc=&quot;A short description max 72 chars&quot;
maintainer=&quot;name &lt;email&gt;&quot;
license=&quot;GPL-3.0-or-later&quot;
homepage=&quot;http://www.foo.org&quot;
distfiles=&quot;http://www.foo.org/foo-${version}.tar.gz&quot;
checksum=&quot;fea0a94d4b605894f3e2d5572e3f96e4413bcad3a085aae7367c2cf07908b2ff&quot;

# foo-devel is a subpkg
foo-devel_package() {
    short_desc+=&quot; - development files&quot;
    depends=&quot;${sourcepkg}&gt;=${version}_${revision}&quot;
    pkg_install() {
        vmove usr/include
        vmove &quot;usr/lib/*.a&quot;
        vmove &quot;usr/lib/*.so&quot;
        vmove usr/lib/pkgconfig
    }
}</code></pre>
<p>VÅ¡echny dÃ­lÄÃ­ balÃ­Äky potÅ™ebujÃ­ dalÅ¡Ã­ symbolickÃ½ odkaz na
<code>main</code> balÃ­Äek, jinak zÃ¡vislosti vyÅ¾adujÃ­cÃ­ tyto balÃ­Äky
nenajdou svou <code>template</code> PÅ™Ã­klad:</p>
<pre><code> /srcpkgs
  |- foo &lt;- directory (main pkg)
  |  |- template
  |- foo-devel &lt;- symlink to `foo`</code></pre>
<p>HlavnÃ­ balÃ­Äek by mÄ›l specifikovat vÅ¡echny poÅ¾adovanÃ©
<code>build dependencies</code> , aby bylo moÅ¾nÃ© sestavit vÅ¡echny dÃ­lÄÃ­
balÃ­Äky definovanÃ© v Å¡ablonÄ›.</p>
<p>DÅ¯leÅ¾itÃ½m bodem <code>subpackages</code> je, Å¾e jsou zpracovÃ¡ny potÃ©,
co hlavnÃ­ balÃ­Äek dokonÄil svou fÃ¡zi <code>install</code> . Funkce
<code>pkg_install()</code> na nich specifikovanÃ¡ se bÄ›Å¾nÄ› pouÅ¾Ã­vÃ¡ k
pÅ™esunu souborÅ¯ z <code>main</code> balÃ­Äku destdir do
<code>subpackage</code> destdir.</p>
<p>PomocnÃ© funkce <code>vinstall</code> , <code>vmkdir</code> ,
<code>vcopy</code> a <code>vmove</code> jsou jen obaly, kterÃ©
zjednoduÅ¡ujÃ­ proces vytvÃ¡Å™enÃ­, kopÃ­rovÃ¡nÃ­ a pÅ™esouvÃ¡nÃ­ souborÅ¯/adresÃ¡Å™Å¯
mezi <code>main</code> balÃ­Äkem destdir ( <code>$DESTDIR</code> ) do
<code>subpackage</code> destdir ( <code>$PKGDESTDIR</code> ).</p>
<p>DÃ­lÄÃ­ balÃ­Äky jsou zpracovÃ¡vÃ¡ny vÅ¾dy v abecednÃ­m poÅ™adÃ­; Chcete-li
vynutit vlastnÃ­ objednÃ¡vku, lze promÄ›nnou <code>subpackages</code>
deklarovat s poÅ¾adovanou objednÃ¡vkou.</p>
<p><a id="pkgs_classes"></a></p>
<h3 id="nÄ›kterÃ©-tÅ™Ã­dy-balÃ­ÄkÅ¯">NÄ›kterÃ© tÅ™Ã­dy balÃ­ÄkÅ¯</h3>
<p><a id="pkgs_development"></a></p>
<h4 id="vÃ½vojovÃ©-balÃ­Äky">VÃ½vojovÃ© balÃ­Äky</h4>
<p>VÃ½vojovÃ½ balÃ­Äek, bÄ›Å¾nÄ› generovanÃ½ jako dÃ­lÄÃ­ balÃ­Äek, bude obsahovat
pouze soubory potÅ™ebnÃ© pro vÃ½voj, to znamenÃ¡ zÃ¡hlavÃ­, statickÃ© knihovny,
symbolickÃ© odkazy sdÃ­lenÃ½ch knihoven, soubory pkg-config, dokumentaci
API nebo jakÃ½koli jinÃ½ skript, kterÃ½ je uÅ¾iteÄnÃ½ pouze pÅ™i vÃ½voji pro
cÃ­l. software.</p>
<p>VÃ½vojovÃ½ balÃ­Äek by mÄ›l zÃ¡viset na balÃ­ÄcÃ­ch, kterÃ© se vyÅ¾adujÃ­ k
propojenÃ­ s poskytnutÃ½mi sdÃ­lenÃ½mi knihovnami, tj. pokud
<code>libfoo</code> poskytuje sdÃ­lenou knihovnu <code>libfoo.so.2</code>
a propojenÃ­ potÅ™ebuje <code>-lbar</code> , balÃ­Äek poskytujÃ­cÃ­ sdÃ­lenou
knihovnu <code>libbar</code> by mÄ›l bÃ½t pÅ™idÃ¡n jako zÃ¡vislost ; a s
nejvÄ›tÅ¡Ã­ pravdÄ›podobnostÃ­ bude zÃ¡viset na jeho vÃ½vojovÃ©m balÃ­Äku.</p>
<p>Pokud vÃ½vojovÃ½ balÃ­Äek poskytuje soubor <code>pkg-config</code> ,
mÄ›li byste ovÄ›Å™it, jakÃ© zÃ¡vislosti potÅ™ebuje balÃ­Äek pro dynamickÃ© nebo
statickÃ© propojenÃ­, a pÅ™idat pÅ™Ã­sluÅ¡nÃ© <code>development</code> balÃ­Äky
jako zÃ¡vislosti.</p>
<p>VÃ½vojovÃ© balÃ­Äky pro jazyky C a C++ obvykle <code>vmove</code>
nÃ¡sledujÃ­cÃ­ podmnoÅ¾inu souborÅ¯ z hlavnÃ­ho balÃ­Äku:</p>
<ul>
<li>ZÃ¡hlavÃ­ souborÅ¯ <code>usr/include</code></li>
<li>StatickÃ© knihovny <code>usr/lib/*.a</code></li>
<li>SymbolickÃ© odkazy sdÃ­lenÃ© knihovny <code>usr/lib/*.so</code></li>
<li>Pravidla Cmake <code>usr/lib/cmake</code>
<code>usr/share/cmake</code></li>
<li>Zabalte konfiguraÄnÃ­ soubory <code>usr/lib/pkgconfig</code>
<code>usr/share/pkgconfig</code></li>
<li>Autoconf makra <code>usr/share/aclocal</code></li>
<li>Soubory XML pro introspekci Gobject
<code>usr/share/gir-1.0</code></li>
<li>Vala vazby <code>usr/share/vala</code></li>
</ul>
<p><a id="pkgs_data"></a></p>
<h4 id="datovÃ©-balÃ­Äky">DatovÃ© balÃ­Äky</h4>
<p>DalÅ¡Ã­m bÄ›Å¾nÃ½m typem dÃ­lÄÃ­ho balÃ­Äku je dÃ­lÄÃ­ balÃ­Äek
<code>-data</code> . Tento typ dÃ­lÄÃ­ho balÃ­ku se pouÅ¾Ã­vÃ¡ k rozdÄ›lenÃ­ na
architektuÅ™e nezÃ¡vislÃ©, velkÃ© (ger) nebo velkÃ© mnoÅ¾stvÃ­ dat z hlavnÃ­
ÄÃ¡sti balÃ­ku a ÄÃ¡sti zÃ¡vislÃ© na architektuÅ™e. Je na vÃ¡s, abyste se
rozhodli, zda mÃ¡ podbalÃ­Äek <code>-data</code> pro vÃ¡Å¡ balÃ­Äek smysl.
Tento typ je bÄ›Å¾nÃ½ pro hry (grafika, zvuk a hudba), knihovny souÄÃ¡stÃ­
(CAD) nebo materiÃ¡l karet (mapy). HlavnÃ­ balÃ­Äek pak musÃ­ mÃ­t
<code>depends="${pkgname}-data-${version}_${revision}"</code> , moÅ¾nÃ¡
kromÄ› jinÃ½ch, neautomatickÃ½ch zÃ¡vislostÃ­.</p>
<p><a id="pkgs_documentation"></a></p>
<h4 id="balÃ­Äky-dokumentace">BalÃ­Äky dokumentace</h4>
<p>BalÃ­Äky urÄenÃ© pro interakci uÅ¾ivatele ne vÅ¾dy bezpodmÃ­neÄnÄ› vyÅ¾adujÃ­
svou dokumentaÄnÃ­ ÄÃ¡st. UÅ¾ivatel, kterÃ½ nechce napÅ™. vyvÃ­jet s Qt5,
nebude muset instalovat (obrovskÃ½) balÃ­Äek qt5-doc. OdbornÃ­k to nemusÃ­
potÅ™ebovat nebo se rozhodne pouÅ¾Ã­vat online verzi.</p>
<p>ObecnÄ› je balÃ­Äek <code>-doc</code> uÅ¾iteÄnÃ½, pokud lze hlavnÃ­
balÃ­Äek pouÅ¾Ã­t s dokumentacÃ­ i bez dokumentace a velikost dokumentace
nenÃ­ opravdu malÃ¡. ZÃ¡kladnÃ­ balÃ­Äek a podbalÃ­Äek <code>-devel</code> by
mÄ›ly bÃ½t malÃ©, aby pÅ™i sestavovÃ¡nÃ­ balÃ­ÄkÅ¯ zÃ¡vislÃ½ch na konkrÃ©tnÃ­m
balÃ­Äku nebylo nutnÃ© bezdÅ¯vodnÄ› instalovat velkÃ© mnoÅ¾stvÃ­ dokumentace.
Velikost ÄÃ¡sti dokumentace by tedy mÄ›la bÃ½t vaÅ¡Ã­m vodÃ­tkem pÅ™i
rozhodovÃ¡nÃ­, zda oddÄ›lit podbalÃ­Äek <code>-doc</code> Äi nikoli.</p>
<p><a id="pkgs_python"></a></p>
<h4 id="python-balÃ­Äky">Python balÃ­Äky</h4>
<p>BalÃ­Äky Pythonu by mÄ›ly bÃ½t sestaveny se stylem sestavenÃ­
<code>python3-module</code> , pokud je to moÅ¾nÃ©. TÃ­m se nastavÃ­ nÄ›kterÃ©
promÄ›nnÃ© prostÅ™edÃ­ potÅ™ebnÃ© k umoÅ¾nÄ›nÃ­ kÅ™Ã­Å¾ovÃ© kompilace. Je takÃ© moÅ¾nÃ¡
podpora umoÅ¾ÅˆujÃ­cÃ­ sestavenÃ­ modulu python pro vÃ­ce verzÃ­ z jednÃ©
Å¡ablony. Styl sestavenÃ­ <code>python3-pep517</code> poskytuje prostÅ™edky
k sestavenÃ­ pythonovÃ½ch balÃ­ÄkÅ¯, kterÃ© poskytujÃ­ definici sestavovacÃ­ho
systÃ©mu v souladu s <a
href="https://www.python.org/dev/peps/pep-0517/">PEP 517</a> bez
tradiÄnÃ­ho skriptu <code>setup.py</code> . Styl sestavenÃ­
<code>python3-pep517</code> neposkytuje konkrÃ©tnÃ­ backend sestavenÃ­,
takÅ¾e balÃ­Äky budou muset pÅ™idat vhodnÃ©ho poskytovatele backendu do
<code>hostmakedepends</code> .</p>
<p>BalÃ­Äky Pythonu, kterÃ© se spolÃ©hajÃ­ na
<code>python3-setuptools</code> by obecnÄ› mÄ›ly mapovat zÃ¡vislosti
<code>setup_requires</code> v <code>setup.py</code> na
<code>hostmakedepends</code> v Å¡ablonÄ› a <code>install_requires</code>
zÃ¡vislosti na <code>depends</code> v Å¡ablonÄ›; include
<code>python3</code> in <code>depends</code> , pokud neexistujÃ­ Å¾Ã¡dnÃ©
dalÅ¡Ã­ zÃ¡vislosti na pythonu. Pokud balÃ­Äek obsahuje zkompilovanÃ©
rozÅ¡Ã­Å™enÃ­, mÄ›ly by bÃ½t balÃ­Äky <code>python3-devel</code> pÅ™idÃ¡ny do
<code>makedepends</code> , stejnÄ› jako vÅ¡echny balÃ­Äky python, kterÃ©
takÃ© poskytujÃ­ nativnÃ­ knihovny, se kterÃ½mi bude rozÅ¡Ã­Å™enÃ­ propojeno (i
kdyÅ¾ je tento balÃ­Äek takÃ© zahrnut v <code>hostmakedepends</code> , aby
vyhovoval <code>setuptools</code> ) .</p>
<p><strong>PoznÃ¡mka</strong> : Python <code>setuptools</code> se pokusÃ­
pouÅ¾Ã­t <code>pip</code> nebo <code>EasyInstall</code> k naÄtenÃ­
chybÄ›jÃ­cÃ­ch zÃ¡vislostÃ­ v dobÄ› sestavovÃ¡nÃ­. Pokud si po sestavenÃ­ balÃ­Äku
vÅ¡imnete varovÃ¡nÃ­ o ukonÄenÃ­ podpory <code>EasyInstall</code> nebo
vejcÃ­ch python pÅ™Ã­tomnÃ½ch v <code>${wrksrc}/.eggs</code> , pak by tyto
balÃ­Äky mÄ›ly bÃ½t pÅ™idÃ¡ny do <code>hostmakedepends</code> .</p>
<p>NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© mohou ovlivnit, jak jsou balÃ­Äky python
sestavovÃ¡ny a konfigurovÃ¡ny v dobÄ› po instalaci:</p>
<ul>
<li><p><code>pycompile_module</code> : Ve vÃ½chozÃ­m nastavenÃ­ jsou
soubory a adresÃ¡Å™e nainstalovanÃ© do
<code>usr/lib/pythonX.Y/site-packages</code> , kromÄ› <code>*-info</code>
a <code>*.so</code> , v dobÄ› instalace kompilovÃ¡ny jako python moduly.
Tato promÄ›nnÃ¡ oÄekÃ¡vÃ¡ jejich podmnoÅ¾inu, kterÃ¡ by mÄ›la bÃ½t kompilovÃ¡na
po bajtech, pokud je vÃ½chozÃ­ hodnota nesprÃ¡vnÃ¡. VÃ­ce modulÅ¯ pythonu mÅ¯Å¾e
bÃ½t specifikovÃ¡no oddÄ›lenÃ½ch mezerami, PÅ™Ã­klad:
<code>pycompile_module="foo blah"</code> . Pokud modul pythonu
nainstaluje soubor do <code>site-packages</code> , nikoli do adresÃ¡Å™e,
pouÅ¾ijte nÃ¡zev souboru, PÅ™Ã­klad:
<code>pycompile_module="fnord.py"</code> .</p></li>
<li><p><code>pycompile_dirs</code> : tato promÄ›nnÃ¡ oÄekÃ¡vÃ¡ adresÃ¡Å™e
pythonu, kterÃ© by mÄ›ly bÃ½t rekurzivnÄ› <code>byte-compiled</code> bajty
cÃ­lovou verzÃ­ pythonu. To se liÅ¡Ã­ od <code>pycompile_module</code> tÃ­m,
Å¾e lze zadat libovolnou cestu, PÅ™Ã­klad:
<code>pycompile_dirs="usr/share/foo"</code> .</p></li>
<li><p><code>python_version</code> : tato promÄ›nnÃ¡ oÄekÃ¡vÃ¡ podporovanou
hlavnÃ­ verzi Pythonu. Ve vÄ›tÅ¡inÄ› pÅ™Ã­padÅ¯ je verze odvozena z shebang,
instalaÄnÃ­ cesty nebo stylu sestavenÃ­. VyÅ¾aduje se pouze pro nÄ›kterÃ©
vÃ­cejazyÄnÃ© aplikace (napÅ™. aplikace je napsÃ¡na v C, zatÃ­mco pÅ™Ã­kaz je
napsÃ¡n v Pythonu) nebo pouze pro ty, kterÃ© jsou v jednom souboru
Pythonu, kterÃ© jsou uloÅ¾eny v <code>/usr/bin</code> . Pokud je
<code>python_version</code> nastaveno na <code>ignore</code> , shebangy
obsahujÃ­cÃ­ python nebudou pÅ™epsÃ¡ny. Toto pouÅ¾ijte pouze v pÅ™Ã­padÄ›, Å¾e by
balÃ­Äek nemÄ›l pouÅ¾Ã­vat systÃ©movou verzi pythonu.</p></li>
<li><p><code>python_extras</code> : DoplÅˆky modulu Python, kterÃ© je
tÅ™eba vzÃ­t v Ãºvahu pÅ™i ovÄ›Å™ovÃ¡nÃ­ zÃ¡vislostÃ­ modulu Python. Lze pouÅ¾Ã­t k
zajiÅ¡tÄ›nÃ­ kontroly dalÅ¡Ã­ch sad zÃ¡vislostÃ­. PÅ™Ã­klad:
<code>python_extras="all"</code> .</p></li>
<li><p><code>nopyprovides</code> : pokud je nastaveno, nevytvÃ¡Å™et
<code>provides</code> poloÅ¾ky pro moduly Pythonu v balÃ­Äku.</p></li>
<li><p><code>noverifypydeps</code> : pokud je nastaveno, neovÄ›Å™ujte
zÃ¡vislosti modulu Python.</p></li>
</ul>
<p>V Å¡ablonÃ¡ch je takÃ© definovÃ¡na sada uÅ¾iteÄnÃ½ch promÄ›nnÃ½ch:</p>
<table>
<thead>
<tr>
<th>PromÄ›nnÃ¡</th>
<th>Hodnota</th>
</tr>
</thead>
<tbody>
<tr>
<td>py2_ver</td>
<td>2.X</td>
</tr>
<tr>
<td>py2_lib</td>
<td>usr/lib/python2.X</td>
</tr>
<tr>
<td>py2_sitelib</td>
<td>usr/lib/python2.X/site-packages</td>
</tr>
<tr>
<td>py2_inc</td>
<td>usr/include/python2.X</td>
</tr>
<tr>
<td>py3_ver</td>
<td>3.X</td>
</tr>
<tr>
<td>py3_lib</td>
<td>usr/lib/python3.X</td>
</tr>
<tr>
<td>py3_sitelib</td>
<td>usr/lib/python3.X/site-packages</td>
</tr>
<tr>
<td>py3_inc</td>
<td>usr/include/python3.Xm</td>
</tr>
</tbody>
</table>
<blockquote>
<p>POZNÃMKA: OÄekÃ¡vÃ¡ se, Å¾e musÃ­ bÃ½t vygenerovÃ¡ny dalÅ¡Ã­ subpkg, aby bylo
moÅ¾nÃ© sbalit vÃ­ce verzÃ­ pythonu.</p>
</blockquote>
<p><a id="pkgs_go"></a></p>
<h4 id="pÅ™ejÃ­t-na-balÃ­Äky">PÅ™ejÃ­t na balÃ­Äky</h4>
<p>Pokud je to moÅ¾nÃ©, balÃ­Äky Go by mÄ›ly bÃ½t sestaveny stylem
<code>go</code> build. Styl sestavenÃ­ <code>go</code> se starÃ¡ o
stahovÃ¡nÃ­ zÃ¡vislostÃ­ Go a nastavenÃ­ kÅ™Ã­Å¾ovÃ© kompilace.</p>
<p>NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© Å¡ablony ovlivÅˆujÃ­ zpÅ¯sob, jakÃ½m jsou sestavovÃ¡ny
balÃ­Äky Go:</p>
<ul>
<li><code>go_import_path</code> : Cesta k importu balÃ­Äku obsaÅ¾enÃ©ho v
souboru distfile, jak by byla pouÅ¾ita s <code>go get</code> . NapÅ™Ã­klad
program <code>hub</code> GitHub mÃ¡ cestu importu
<code>github.com/github/hub</code> . Tato promÄ›nnÃ¡ je povinnÃ¡.</li>
<li><code>go_package</code> : Mezerou oddÄ›lenÃ½ seznam cest importu
balÃ­ÄkÅ¯, kterÃ© by mÄ›ly bÃ½t sestaveny. VÃ½chozÃ­ hodnota je
<code>go_import_path</code> .</li>
<li><code>go_build_tags</code> : VolitelnÃ½, mezerami oddÄ›lenÃ½ seznam
znaÄek sestavenÃ­, kterÃ© se majÃ­ pÅ™edat Go.</li>
<li><code>go_mod_mode</code> : ReÅ¾im stahovÃ¡nÃ­ modulu, kterÃ½ se mÃ¡
pouÅ¾Ã­t. MÅ¯Å¾e bÃ½t <code>off</code> , aby se ignorovaly vÅ¡echny soubory
go.mod, <code>default</code> se pouÅ¾Ã­vÃ¡ vÃ½chozÃ­ chovÃ¡nÃ­ Go nebo cokoli,
co pÅ™ijÃ­mÃ¡ <code>go build -mod MODE</code> . VÃ½chozÃ­ hodnota je
<code>vendor</code> , pokud existuje adresÃ¡Å™ dodavatele, jinak
<code>default</code> .</li>
<li><code>go_ldflags</code> : Argumenty, kterÃ© se majÃ­ pÅ™edat
propojovacÃ­m krokÅ¯m nÃ¡stroje go.</li>
</ul>
<p>NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© prostÅ™edÃ­ ovlivÅˆujÃ­, jak jsou balÃ­Äky Go
sestaveny:</p>
<ul>
<li><code>XBPS_MAKEJOBS</code> : Hodnota pÅ™edanÃ¡ do parametru
<code>-p</code> parametru <code>go install</code> pro Å™Ã­zenÃ­ paralelismu
kompilÃ¡toru Go.</li>
</ul>
<p>ObÄas je nutnÃ© provÃ¡dÄ›t operace ze stromu zdroje Go. To obvykle
potÅ™ebujÃ­ programy pouÅ¾Ã­vajÃ­cÃ­ go-bindata nebo jinak pÅ™ipravujÃ­cÃ­
nÄ›kterÃ¡ aktiva. Pokud je to moÅ¾nÃ©, proveÄte to v pre_build(). Cesta ke
zdroji balÃ­Äku uvnitÅ™ <code>$GOPATH</code> je dostupnÃ¡ jako
<code>$GOSRCPATH</code> .</p>
<p><a id="pkgs_haskell"></a></p>
<h4 id="haskell-balÃ­Äky">Haskell balÃ­Äky</h4>
<p>Haskell balÃ­Äky lze sestavit buÄ stylem <code>cabal</code> , nebo
<code>haskell-stack</code> . PouÅ¾ijte ten, kterÃ½ je pohodlnÄ›jÅ¡Ã­ nebo
lÃ©pe podporovanÃ½ upstreamem. NÄ›kdy je moÅ¾nÃ½ pouze jeden z tÄ›chto dvou. U
balÃ­ÄkÅ¯, kterÃ© obsahujÃ­ haskellovÃ© ÄÃ¡sti, ale pouÅ¾Ã­vajÃ­ jinÃ½ styl
sestavenÃ­, jako je <code>gnu-makefile</code> , nezapomeÅˆte pouÅ¾Ã­t
<code>haskell</code> build helper.</p>
<p>NÃ¡sledujÃ­cÃ­ promÄ›nnÃ© ovlivÅˆujÃ­, jak jsou balÃ­Äky sestavovÃ¡ny pomocÃ­
cabal:</p>
<ul>
<li><code>cabal_index_state</code> : Stav indexu hackage cabal, kterÃ½ se
mÃ¡ pouÅ¾Ã­t pro naÄÃ­tÃ¡nÃ­ zÃ¡vislostÃ­. ZdrojovÃ½ balÃ­Äek projektu Haskell by
mÄ›l obsahovat soubor freeze, kterÃ½ nastavuje stav indexu, nÄ›kterÃ© jej
takÃ© nastavujÃ­ ve svÃ©m souboru projektu cabal. Pokud tomu tak nenÃ­, musÃ­
bÃ½t v Å¡ablonÄ› balÃ­Äku nastaveno ÄasovÃ© razÃ­tko ISO. NapÅ™Ã­klad
<code>2025-07-05T14:01:16Z</code> .</li>
<li><code>configure_args</code> : Argumenty pÅ™edÃ¡vanÃ©
<code>cabal configure</code> . Krok configure generuje soubor
<code>cabal.project.local</code> .</li>
<li><code>make_build_args</code> : Argumenty pÅ™edÃ¡vanÃ© pÅ™Ã­kazu
<code>cabal build</code> .</li>
<li><code>make_build_target</code> : CÃ­l pÅ™edÃ¡n <code>cabal build</code>
.</li>
<li><code>make_check_args</code> : Argumenty pÅ™edanÃ© do
<code>cabal test</code> .</li>
<li><code>make_check_target</code> : CÃ­l testu byl pÅ™edÃ¡n cabalu mÃ­sto
"test".</li>
<li><code>make_install_target</code> : CÃ­l pÅ™edÃ¡n
<code>cabal install</code> .</li>
</ul>
<p>A tyto promÄ›nnÃ© ovlivÅˆujÃ­, jak jsou balÃ­Äky sestavovÃ¡ny pomocÃ­
stack:</p>
<ul>
<li><code>stackage</code> : Verze Stackage pouÅ¾itÃ¡ k sestavenÃ­ balÃ­Äku,
napÅ™ <code>lts-3.5</code> . AlternativnÄ›:
<ul>
<li>Pro projekt mÅ¯Å¾ete pÅ™ipravit konfiguraci <code>stack.yaml</code> a
vloÅ¾it ji do <code>files/stack.yaml</code> .</li>
<li>Pokud je ve zdrojovÃ½ch souborech pÅ™Ã­tomen soubor
<code>stack.yaml</code> , bude pouÅ¾it.</li>
</ul></li>
<li><code>make_build_args</code> : Toto je pÅ™edÃ¡no tak, jak je, do
<code>stack build ...</code> , takÅ¾e tam mÅ¯Å¾ete pÅ™idat svÃ© parametry
<code>--flag ...</code></li>
</ul>
<p>Pro opravu zÃ¡vislostÃ­ balÃ­ÄkÅ¯ Haskell je nutnÃ© je explicitnÄ› naÄÃ­st z
Hackage pÅ™idÃ¡nÃ­m do <code>distfiles</code> mÃ­sto aby je stahoval Cabal
nebo Stack. Po extrahovÃ¡nÃ­ a opravÄ› lze cestu k opravenÃ© verzi pÅ™idat k
<code>packages</code> v souboru <code>cabal.project</code> nebo
<code>stack.yaml</code> . Stack je automaticky vyhledÃ¡, pokud soubor
<code>stack.yaml</code> neexistuje, prohledÃ¡nÃ­m adresÃ¡Å™e. NÃ¡stroj pro
sestavenÃ­ pak pouÅ¾ije opravenou verzi zÃ¡vislosti, mÃ­sto aby ji stahoval
z Hackage.</p>
<p><a id="pkgs_font"></a></p>
<h4 id="balÃ­Äky-pÃ­sem">BalÃ­Äky pÃ­sem</h4>
<p>BalÃ­Äky pÃ­sem se pÃ­Å¡Ã­ velmi jednoduÅ¡e, vÅ¾dy se nastavujÃ­ pomocÃ­
nÃ¡sledujÃ­cÃ­ch promÄ›nnÃ½ch:</p>
<ul>
<li><code>depends="font-util"</code> : protoÅ¾e jsou vyÅ¾adovÃ¡ny pro
regeneraci mezipamÄ›ti pÃ­sem bÄ›hem instalace/odebÃ­rÃ¡nÃ­ balÃ­Äku</li>
<li><code>font_dirs</code> : kterÃ½ by mÄ›l bÃ½t nastaven na adresÃ¡Å™, kam
balÃ­Äek instaluje svÃ© fonty</li>
</ul>
<p><a id="pkg_rename"></a></p>
<h3 id="pÅ™ejmenovÃ¡nÃ­-balÃ­Äku">PÅ™ejmenovÃ¡nÃ­ balÃ­Äku</h3>
<ul>
<li>VytvoÅ™te prÃ¡zdnÃ½ balÃ­Äek se starÃ½m nÃ¡zvem v zÃ¡vislosti na novÃ©m
balÃ­Äku. To je nezbytnÃ© pro poskytovÃ¡nÃ­ aktualizacÃ­ systÃ©mÅ¯, kde je jiÅ¾
nainstalovÃ¡n starÃ½ balÃ­Äek. Toto by mÄ›l bÃ½t podbalÃ­Äek novÃ©ho, kromÄ›
pÅ™Ã­padÅ¯, kdy se ÄÃ­slo verze novÃ©ho balÃ­Äku snÃ­Å¾ilo: pak vytvoÅ™te
samostatnou Å¡ablonu pomocÃ­ starÃ© verze a zvÃ½Å¡enÃ© revize.</li>
<li>Upravte odkazy na balÃ­Äek v jinÃ½ch Å¡ablonÃ¡ch a common/shlibs.</li>
<li>Nenastavujte <code>replaces=</code> , mÅ¯Å¾e to mÃ­t za nÃ¡sledek
odstranÄ›nÃ­ obou balÃ­kÅ¯ ze systÃ©mÅ¯ pomocÃ­ xbps.</li>
</ul>
<p><a id="pkg_remove"></a></p>
<h3 id="odebÃ­rÃ¡nÃ­-balÃ­Äku">OdebÃ­rÃ¡nÃ­ balÃ­Äku</h3>
<p>NÃ¡sleduje seznam vÄ›cÃ­, kterÃ© je tÅ™eba udÄ›lat, aby bylo zaruÄeno, Å¾e
odstranÄ›nÃ­ Å¡ablony balÃ­ÄkÅ¯ a potaÅ¾mo jeho binÃ¡rnÃ­ch balÃ­ÄkÅ¯ z repozitÃ¡Å™Å¯
Void Linuxu probÄ›hne hladce.</p>
<p>PÅ™ed odstranÄ›nÃ­m Å¡ablony balÃ­Äku:</p>
<ul>
<li>ZaruÄit, Å¾e Å¾Ã¡dnÃ½ balÃ­Äek na nÄ›m nebo na nÄ›kterÃ©m z jeho dÃ­lÄÃ­ch
balÃ­ÄkÅ¯ nezÃ¡visÃ­. Za tÃ­mto ÃºÄelem mÅ¯Å¾ete v Å¡ablonÃ¡ch vyhledat odkazy na
balÃ­Äek pomocÃ­ <code>grep -r '\bpkg\b' srcpkgs/</code> .</li>
<li>ZÃ¡ruka, Å¾e Å¾Ã¡dnÃ½ balÃ­Äek nezÃ¡visÃ­ na shlibs, kterÃ© poskytuje.</li>
</ul>
<p>PÅ™i odstraÅˆovÃ¡nÃ­ Å¡ablony balÃ­Äku:</p>
<ul>
<li>OdstraÅˆte vÅ¡echny symbolickÃ© odkazy, kterÃ© ukazujÃ­ na balÃ­Äek.
<code>find srcpkgs/ -lname &lt;pkg&gt;</code> by mÄ›lo staÄit.</li>
<li>Pokud balÃ­Äek obsahuje shliby, ujistÄ›te se, Å¾e jste je odstranili z
common/shlibs.</li>
<li>NÄ›kterÃ© balÃ­Äky pouÅ¾Ã­vajÃ­ zÃ¡platy a soubory z jinÃ½ch balÃ­ÄkÅ¯ pomocÃ­
symbolickÃ½ch odkazÅ¯, obvykle jsou tyto balÃ­Äky stejnÃ©, ale byly
rozdÄ›leny, aby se pÅ™edeÅ¡lo cyklickÃ½m zÃ¡vislostem. UjistÄ›te se, Å¾e
balÃ­Äek, kterÃ½ odstraÅˆujete, nenÃ­ zdrojem tÄ›chto zÃ¡plat/souborÅ¯.</li>
<li>Odebrat Å¡ablonu balÃ­Äku.</li>
<li>PÅ™idejte <code>pkgname&lt;=version_revision</code> do
<code>replaces</code> promÄ›nnÃ© Å¡ablony <code>removed-packages</code> .
VÅ¡echny odstranÄ›nÃ© dÃ­lÄÃ­ balÃ­Äky by mÄ›ly bÃ½t pÅ™idÃ¡ny takÃ©. TÃ­m se
balÃ­Äek odinstaluje ze systÃ©mÅ¯, kde je nainstalovÃ¡n.</li>
<li>OdstraÅˆte balÃ­Äek z indexu ÃºloÅ¾iÅ¡tÄ› nebo kontaktujte Älena tÃ½mu,
kterÃ½ tak mÅ¯Å¾e uÄinit.</li>
</ul>
<p><a id="xbps_triggers"></a></p>
<h3 id="spouÅ¡tÄ›Äe-xbps">SpouÅ¡tÄ›Äe XBPS</h3>
<p>SpouÅ¡tÄ›Äe XBPS jsou sbÃ­rkou ÃºryvkÅ¯ kÃ³du poskytovanÃ½ch balÃ­Äkem
<code>xbps-triggers</code> , kterÃ© se pÅ™idÃ¡vajÃ­ do skriptÅ¯
INSTALL/REMOVE balÃ­ÄkÅ¯ buÄ ruÄnÄ› nastavenÃ­m promÄ›nnÃ©
<code>triggers</code> v Å¡ablonÄ›, nebo automaticky, kdyÅ¾ jsou splnÄ›ny
specifickÃ© podmÃ­nky.</p>
<p>NÃ¡sleduje seznam vÅ¡ech dostupnÃ½ch spouÅ¡tÄ›ÄÅ¯, jejich aktuÃ¡lnÃ­ stav, co
kaÅ¾dÃ½ z nich dÄ›lÃ¡ a jakÃ© podmÃ­nky musÃ­ splÅˆovat, aby byl automaticky
zahrnut do balÃ­Äku.</p>
<p>Toto nenÃ­ ÃºplnÃ½ pÅ™ehled balÃ­Äku. DoporuÄuje se pÅ™eÄÃ­st odkazovanÃ©
promÄ›nnÃ© a samotnÃ© spouÅ¡tÄ›Äe.</p>
<p><a id="triggers_appstream_cache"></a></p>
<h4 id="appstream-cache">appstream-cache</h4>
<p>SpouÅ¡tÄ›Ä appstream-cache je zodpovÄ›dnÃ½ za opÄ›tovnÃ© sestavenÃ­
mezipamÄ›ti metadat appstreamu.</p>
<p>BÄ›hem instalace spustÃ­
<code>appstreamcli refresh-cache --verbose --force --datapath $APPSTREAM_PATHS --cachepath var/cache/app-info/gv</code>
. Ve vÃ½chozÃ­m nastavenÃ­ jsou APPSTREAM_PATHS vÅ¡echny cesty, kterÃ© bude
appstreamcli hledat pro soubory metadat.</p>
<p>AdresÃ¡Å™e prohledÃ¡vanÃ© appstreamcli jsou:</p>
<ul>
<li><code>usr/share/appdata</code></li>
<li><code>usr/share/app-info</code></li>
<li><code>var/lib/app-info</code></li>
<li><code>var/cache/app-info</code></li>
</ul>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ balÃ­Äku <code>AppStream</code> dojde k odstranÄ›nÃ­
adresÃ¡Å™e <code>var/cache/app-info/gv</code> .</p>
<p>Automaticky se pÅ™idÃ¡ do balÃ­ÄkÅ¯, kterÃ© majÃ­ soubory XML v jednom z
adresÃ¡Å™Å¯ prohledanÃ½ch appstreamcli.</p>
<p><a id="triggers_binfmts"></a></p>
<h4 id="binfmts">binfmts</h4>
<p>SpouÅ¡tÄ›Ä binfmts je zodpovÄ›dnÃ½ za registraci a odstranÄ›nÃ­ libovolnÃ½ch
spustitelnÃ½ch binÃ¡rnÃ­ch formÃ¡tÅ¯, znÃ¡mÃ½ch jako binfmts.</p>
<p>BÄ›hem instalace/odstranÄ›nÃ­ pouÅ¾Ã­vÃ¡ <code>update-binfmts</code> z
balÃ­Äku <code>binfmt-support</code> k registraci/odstranÄ›nÃ­ poloÅ¾ek z
libovolnÃ© databÃ¡ze spustitelnÃ½ch binÃ¡rnÃ­ch formÃ¡tÅ¯.</p>
<p>Je automaticky pÅ™idÃ¡n do balÃ­ÄkÅ¯, kterÃ© obsahujÃ­ soubory v
<code>usr/share/binfmts</code> . Tyto soubory by mÄ›ly bÃ½t ve formÃ¡tu
<code>update-binfmts</code> a budou importovÃ¡ny pomocÃ­
<code>update-binfmts --import</code> .</p>
<p>I kdyÅ¾ to nenÃ­ preferovÃ¡no, spouÅ¡tÄ›Ä lze pÅ™idat takÃ© pomocÃ­ promÄ›nnÃ©
<code>binfmts</code> , kterÃ¡ by mÄ›la obsahovat Å™Ã¡dky definujÃ­cÃ­ binfmts
pro registraci:</p>
<pre><code>/path/to/interpreter [update-binfmts binary format specification arguments ...]
...</code></pre>
<p>Viz <a
href="https://man.voidlinux.org/man8/update-binfmts.8"><code>update-binfmts(8)</code></a>
pro vÃ­ce podrobnostÃ­.</p>
<p><a id="triggers_dkms"></a></p>
<h4 id="dkms">dkms</h4>
<p>SpouÅ¡tÄ›Ä dkms je zodpovÄ›dnÃ½ za kompilaci a odstranÄ›nÃ­ dynamickÃ½ch
modulÅ¯ jÃ¡dra balÃ­Äku.</p>
<p>BÄ›hem instalace trigger zkompiluje a nainstaluje dynamickÃ½ modul pro
vÅ¡echny <code>linux</code> balÃ­Äky, kterÃ© majÃ­ nainstalovanÃ½
odpovÃ­dajÃ­cÃ­ balÃ­Äek linux-headers. BÄ›hem odebÃ­rÃ¡nÃ­ bude odebrÃ¡n
odpovÃ­dajÃ­cÃ­ modul</p>
<p>Chcete-li zahrnout spouÅ¡tÄ›Ä, pouÅ¾ijte promÄ›nnou
<code>dkms_modules</code> , protoÅ¾e spouÅ¡tÄ›Ä nedÄ›lÃ¡ nic, pokud nenÃ­
definovÃ¡n.</p>
<p><a id="triggers_gconf_schemas"></a></p>
<h4 id="schÃ©mata-gconf">schÃ©mata gconf</h4>
<p>SpouÅ¡tÄ›Ä gconf-schemas je zodpovÄ›dnÃ½ za registraci a odstranÄ›nÃ­
souborÅ¯ .schemas a .entries do adresÃ¡Å™e databÃ¡ze schÃ©mat.</p>
<p>BÄ›hem instalace pouÅ¾Ã­vÃ¡ <code>gconftool-2</code> k instalaci souborÅ¯
.schemas a .entries do <code>usr/share/gconf/schemas</code> . BÄ›hem
odstraÅˆovÃ¡nÃ­ pouÅ¾Ã­vÃ¡ <code>gconftool-2</code> k odstranÄ›nÃ­ poloÅ¾ek a
schÃ©mat patÅ™Ã­cÃ­ch k balÃ­Äku, kterÃ½ je odstraÅˆovÃ¡n z databÃ¡ze.</p>
<p>Chcete-li jej zahrnout, pÅ™idejte do <code>triggers</code>
<code>gconf-schemas</code> a pÅ™idejte vhodnÃ¡ .schemas do promÄ›nnÃ©
<code>gconf_schemas</code> a .entries do <code>gconf_entries</code>
.</p>
<p>Automaticky se pÅ™idÃ¡vÃ¡ do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™
<code>/usr/share/gconf/schemas</code> . VÅ¡echny soubory s pÅ™Ã­ponou
schÃ©matu v tomto adresÃ¡Å™i jsou pÅ™edÃ¡ny spouÅ¡tÄ›Äi.</p>
<p><a id="triggers_gdk_pixbuf_loaders"></a></p>
<h4 id="gdk-pixbuf-loadery">gdk-pixbuf-loadery</h4>
<p>SpouÅ¡tÄ›Ä gdk-pixbuf-loaders je zodpovÄ›dnÃ½ za udrÅ¾ovÃ¡nÃ­ mezipamÄ›ti
zavadÄ›ÄÅ¯ GDK Pixbuf.</p>
<p>BÄ›hem instalace spouÅ¡tÃ­
<code>gdk-pixbuf-query-loaders --update-cache</code> a takÃ© smaÅ¾e
zastaralÃ½ soubor <code>etc/gtk-2.0/gdk-pixbuf.loaders</code> pokud
existuje. BÄ›hem odstraÅˆovÃ¡nÃ­ balÃ­Äku gdk-pixbuf odstranÃ­ soubor
mezipamÄ›ti, pokud je pÅ™Ã­tomen. NormÃ¡lnÄ› na
<code>usr/lib/gdk-pixbuf-2.0/2.10.0/loaders.cache</code> .</p>
<p>Lze jej pÅ™idat definovÃ¡nÃ­m <code>gdk-pixbuf-loaders</code> v promÄ›nnÃ©
<code>triggers</code> . Je takÃ© automaticky pÅ™idÃ¡n do kaÅ¾dÃ©ho balÃ­Äku,
kterÃ½ mÃ¡ jako adresÃ¡Å™ k dispozici cestu
<code>usr/lib/gdk-pixbuf-2.0/2.10.0/loaders</code> .</p>
<p><a id="triggers_gio_modules"></a></p>
<h4 id="gio-moduly">gio-moduly</h4>
<p>SpouÅ¡tÄ›Ä gio-modules je zodpovÄ›dnÃ½ za aktualizaci mezipamÄ›ti modulu
Glib GIO moduly <code>gio-querymodules</code> z balÃ­Äku
<code>glib</code></p>
<p>BÄ›hem instalace a odebrÃ¡nÃ­ pouze spustÃ­ <code>gio-querymodules</code>
, aby aktualizoval soubor mezipamÄ›ti pÅ™Ã­tomnÃ½ pod
<code>usr/lib/gio/modules</code> .</p>
<p>Automaticky se pÅ™idÃ¡vÃ¡ do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™
<code>/usr/lib/gio/modules</code> .</p>
<p><a id="triggers_gsettings_schemas"></a></p>
<h4 id="gsettings-schÃ©mata">gsettings-schÃ©mata</h4>
<p>SpouÅ¡tÄ›Ä gsettings-schemas je zodpovÄ›dnÃ½ za kompilaci souborÅ¯
schÃ©matu Glib Glib GSettings XML bÄ›hem instalace a odstranÄ›nÃ­
zkompilovanÃ½ch souborÅ¯ bÄ›hem odstraÅˆovÃ¡nÃ­.</p>
<p>BÄ›hem instalace pouÅ¾Ã­vÃ¡ <code>glib-compile-schemas</code> z
<code>glib</code> ke kompilaci schÃ©mat do souborÅ¯ s pÅ™Ã­ponou .compiled
do <code>/usr/share/glib-2.0/schemas</code> .</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ balÃ­Äku glib smaÅ¾e vÅ¡echny soubory v
<code>/usr/share/glib-2.0/schemas</code> , kterÃ© konÄÃ­ pÅ™Ã­ponou
.compiled.</p>
<p>Je automaticky pÅ™idÃ¡n do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™
<code>/usr/share/glib-2.0/schemas</code> .</p>
<p><a id="triggers_gtk_icon_cache"></a></p>
<h4 id="gtk-ikona-mezipamÄ›Å¥">gtk-ikona-mezipamÄ›Å¥</h4>
<p>SpouÅ¡tÄ›Ä gtk-icon-cache je zodpovÄ›dnÃ½ za aktualizaci mezipamÄ›ti ikon
gtk+.</p>
<p>BÄ›hem instalace pouÅ¾Ã­vÃ¡ <code>gtk-update-icon-cache</code> k
aktualizaci mezipamÄ›ti ikon.</p>
<p>PÅ™i odstraÅˆovÃ¡nÃ­ balÃ­Äku gtk+ smaÅ¾e soubor
<code>icon-theme.cache</code> v adresÃ¡Å™Ã­ch definovanÃ½ch promÄ›nnou
<code>gtk_iconcache_dirs</code> .</p>
<p>Automaticky se pÅ™idÃ¡vÃ¡ do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™ k
dispozici <code>/usr/share/icons</code> , vÅ¡echny adresÃ¡Å™e v tomto
adresÃ¡Å™i majÃ­ svou absolutnÃ­ cestu pÅ™edÃ¡n spouÅ¡tÄ›Äi.</p>
<p><a id="triggers_gtk_immodules"></a></p>
<h4 id="gtk-immodules">gtk-immodules</h4>
<p>SpouÅ¡tÄ›Ä gtk-immodules je zodpovÄ›dnÃ½ za aktualizaci souboru modulÅ¯ IM
(Input Method) pro gtk+.</p>
<p>BÄ›hem instalace pouÅ¾Ã­vÃ¡
<code>gtk-query-immodules-2.0 --update-cache</code> k aktualizaci
souboru mezipamÄ›ti. OdstranÃ­ takÃ© zastaralÃ½ konfiguraÄnÃ­ soubor
<code>etc/gtk-2.0/gtk.immodules</code> pokud existuje.</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ balÃ­Äku <code>gtk+</code> odstranÃ­ soubor
mezipamÄ›ti, kterÃ½ se nachÃ¡zÃ­ na
<code>usr/lib/gtk-2.0/2.10.0/immodules.cache</code> .</p>
<p>Automaticky se pÅ™idÃ¡vÃ¡ do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™
<code>/usr/lib/gtk-2.0/2.10.0/immodules</code> .</p>
<p><a id="triggers_gtk_pixbuf_loaders"></a></p>
<h4 id="gtk-pixbuf-loadery">gtk-pixbuf-loadery</h4>
<p>gtk-pixbuf-loaders je starÃ½ nÃ¡zev pro aktuÃ¡lnÃ­ spouÅ¡tÄ›Ä
<code>gdk-pixbuf-loaders</code> a je v procesu odstraÅˆovÃ¡nÃ­. V souÄasnÃ©
dobÄ› se znovu spouÅ¡tÃ­ do <code>gdk-pixbuf-loaders</code> jako opatÅ™enÃ­
kompatibility.</p>
<p>Informace o tom, jak to funguje, najdete v <a
href="#triggers_gdk_pixbuf_loaders">gdk-pixbuf-loaders</a> .</p>
<p><a id="triggers_gtk3_immodules"></a></p>
<h4 id="gtk3-immodules">gtk3-immodules</h4>
<p>SpouÅ¡tÄ›Ä gtk3-immodules je zodpovÄ›dnÃ½ za aktualizaci souboru modulÅ¯
IM (Input Method) pro gtk+3.</p>
<p>BÄ›hem instalace spustÃ­
<code>gtk-query-immodules-3.0 --update-cache</code> pro aktualizaci
souboru mezipamÄ›ti. TakÃ© odstranÃ­ zastaralÃ½ konfiguraÄnÃ­ soubor
<code>etc/gtk-3.0/gtk.immodules</code> pokud existuje.</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ balÃ­Äku <code>gtk+3</code> odstranÃ­ soubor
mezipamÄ›ti, kterÃ½ se nachÃ¡zÃ­ na
<code>usr/lib/gtk-3.0/3.0.0/immodules.cache</code> .</p>
<p>Automaticky se pÅ™idÃ¡vÃ¡ do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™
<code>/usr/lib/gtk-3.0/3.0.0/immodules</code> .</p>
<p><a id="triggers_hwdb.d_dir"></a></p>
<h4 id="hwdbd-dir">hwdb.d-dir</h4>
<p>SpouÅ¡tÄ›Ä hwdb.d-dir je zodpovÄ›dnÃ½ za aktualizaci hardwarovÃ©
databÃ¡ze.</p>
<p>BÄ›hem instalace a odebrÃ¡nÃ­ spouÅ¡tÃ­
<code>usr/bin/udevadm hwdb --root=. --update</code> .</p>
<p>Je automaticky pÅ™idÃ¡n do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™
<code>/usr/lib/udev/hwdb.d</code> .</p>
<p><a id="triggers_info_files"></a></p>
<h4 id="info-soubory">info-soubory</h4>
<p>SpouÅ¡tÄ›Ä info-files je zodpovÄ›dnÃ½ za registraci a odregistrovÃ¡nÃ­ GNU
informaÄnÃ­ch souborÅ¯ balÃ­Äku.</p>
<p>Kontroluje existenci informaÄnÃ­ch souborÅ¯, kterÃ© jsou mu pÅ™edklÃ¡dÃ¡ny,
a zda bÄ›Å¾Ã­ pod jinou architekturou.</p>
<p>BÄ›hem instalace pouÅ¾Ã­vÃ¡ <code>install-info</code> k registraci
informaÄnÃ­ch souborÅ¯ do <code>usr/share/info</code> .</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ pouÅ¾Ã­vÃ¡ <code>install-info --delete</code> k
odstranÄ›nÃ­ informaÄnÃ­ch souborÅ¯ z registru umÃ­stÄ›nÃ©ho na
<code>usr/share/info</code> .</p>
<p>Pokud bÄ›Å¾Ã­ pod jinou architekturou, pokusÃ­ se pouÅ¾Ã­t utilitu
<code>install-info</code> hostitele.</p>
<p><a id="triggers_initramfs_regenerate"></a></p>
<h4 id="initramfs-regenerate">initramfs-regenerate</h4>
<p>SpouÅ¡tÄ›Ä initramfs-regenerate spustÃ­ regeneraci vÅ¡ech obrazÅ¯
initramfs jÃ¡dra po instalaci nebo odstranÄ›nÃ­ balÃ­Äku. O spouÅ¡Å¥ je tÅ™eba
poÅ¾Ã¡dat ruÄnÄ›.</p>
<p>Tento hÃ¡Äek je pravdÄ›podobnÄ› nejuÅ¾iteÄnÄ›jÅ¡Ã­ pro balÃ­Äky DKMS, protoÅ¾e
poskytuje prostÅ™edek pro zahrnutÃ­ novÄ› zkompilovanÃ½ch modulÅ¯ jÃ¡dra do
obrazÅ¯ initramfs pro vÅ¡echna aktuÃ¡lnÄ› dostupnÃ¡ jÃ¡dra. PÅ™i pouÅ¾itÃ­ v
balÃ­Äku DKMS se doporuÄuje ruÄnÄ› zahrnout spouÅ¡tÄ›Ä <code>dkms</code>
<em>pÅ™ed</em> spouÅ¡tÄ›Ä <code>initramfs-regenerate</code> pomocÃ­
napÅ™.</p>
<pre><code></code></pre>
<p>triggers="dkms initramfs-regenerate"</p>
<pre><code></code></pre>
<p>AÄkoli <code>xbps-src</code> automaticky zahrne spouÅ¡tÄ›Ä
<code>dkms</code> kdykoli je nainstalovÃ¡n <code>dkms_modules</code> ,
automatickÃ© pÅ™idÃ¡nÃ­ pÅ™ijde <em>po</em> <code>initramfs-regenerate</code>
, coÅ¾ zpÅ¯sobÃ­, Å¾e obrazy initramfs budou znovu vytvoÅ™eny pÅ™ed kompilacÃ­
modulÅ¯.</p>
<p>Ve vÃ½chozÃ­m nastavenÃ­ spouÅ¡tÄ›Ä pouÅ¾Ã­vÃ¡
<code>dracut --regenerate-all</code> k opÄ›tovnÃ©mu vytvoÅ™enÃ­ obrÃ¡zkÅ¯
initramfs. Pokud <code>/etc/default/initramfs-regenerate</code> existuje
a definuje <code>INITRAMFS_GENERATOR=mkinitcpio</code> , spouÅ¡tÄ›Ä mÃ­sto
toho pouÅ¾ije <code>mkinitcpio</code> a zacyklÃ­ vÅ¡echny verze jÃ¡dra, pro
kterÃ© se zdÃ¡, Å¾e jsou nainstalovÃ¡ny moduly. PÅ™Ã­padnÄ› nastavenÃ­
<code>INITRAMFS_GENERATOR=none</code> zcela zakÃ¡Å¾e regeneraci
obrazu.</p>
<p><a id="triggers_kernel_hooks"></a></p>
<h4 id="kernel-hÃ¡ky">kernel-hÃ¡ky</h4>
<p>SpouÅ¡tÄ›Ä kernel-hooks je zodpovÄ›dnÃ½ za spouÅ¡tÄ›nÃ­ skriptÅ¯ bÄ›hem
instalace/odebÃ­rÃ¡nÃ­ balÃ­ÄkÅ¯ jÃ¡dra.</p>
<p>DostupnÃ© cÃ­le jsou pÅ™ed instalacÃ­, pÅ™ed odstranÄ›nÃ­m, po instalaci a
po odstranÄ›nÃ­.</p>
<p>PÅ™i spuÅ¡tÄ›nÃ­ se pokusÃ­ spustit vÅ¡echny spustitelnÃ© soubory nalezenÃ©
pod <code>etc/kernel.d/$TARGET</code> . PromÄ›nnÃ¡ <code>TARGET</code> je
jednÃ­m ze 4 cÃ­lÅ¯ dostupnÃ½ch pro spouÅ¡tÄ›Ä. VytvoÅ™Ã­ takÃ© adresÃ¡Å™, pokud
nenÃ­ pÅ™Ã­tomen.</p>
<p>BÄ›hem aktualizacÃ­ se nebude pokouÅ¡et spustit Å¾Ã¡dnÃ© spustitelnÃ©
soubory, kdyÅ¾ bÄ›Å¾Ã­ s cÃ­lem pÅ™ed odstranÄ›nÃ­m.</p>
<p>Je pÅ™idÃ¡na automaticky, pokud je definovÃ¡na pomocnÃ¡ promÄ›nnÃ¡
<code>kernel_hooks_version</code> . NenÃ­ vÅ¡ak povinnÃ© jej mÃ­t
definovanÃ©.</p>
<p><a id="triggers_mimedb"></a></p>
<h4 id="mimedb">mimedb</h4>
<p>SpouÅ¡tÄ›Ä mimedb je zodpovÄ›dnÃ½ za aktualizaci databÃ¡ze
shared-mime-info.</p>
<p>Ve vÅ¡ech spuÅ¡tÄ›nÃ­ch se pouze spustÃ­
<code>update-mime-database -n usr/share/mime</code> .</p>
<p>Je automaticky pÅ™idÃ¡n do balÃ­ÄkÅ¯, kterÃ© majÃ­ jako adresÃ¡Å™ k dispozici
<code>/usr/share/mime</code> .</p>
<p><a id="triggers_mkdirs"></a></p>
<h4 id="mkdirs">mkdirs</h4>
<p>SpouÅ¡tÄ›Ä mkdirs je zodpovÄ›dnÃ½ za vytvÃ¡Å™enÃ­ a odstraÅˆovÃ¡nÃ­ adresÃ¡Å™Å¯
diktovanÃ½ch promÄ›nnou <code>make_dirs</code> .</p>
<p>BÄ›hem instalace vezme promÄ›nnou <code>make_dirs</code> a rozdÄ›lÃ­ ji
do skupin po 4 promÄ›nnÃ½ch.</p>
<ul>
<li>dir = ÃºplnÃ¡ cesta k adresÃ¡Å™i</li>
<li>reÅ¾im = UnixovÃ¡ oprÃ¡vnÄ›nÃ­ pro adresÃ¡Å™</li>
<li>uid = jmÃ©no vlastnÃ­cÃ­ho uÅ¾ivatele</li>
<li>gid = nÃ¡zev vlastnÃ­cÃ­ skupiny</li>
</ul>
<p>Bude pokraÄovat v rozdÄ›lovÃ¡nÃ­ hodnot <code>make_dirs</code> do skupin
po 4, dokud hodnoty neskonÄÃ­.</p>
<p>BÄ›hem instalace vytvoÅ™Ã­ adresÃ¡Å™ s <code>dir</code> a potÃ© nastavÃ­
reÅ¾im s <code>mode</code> a oprÃ¡vnÄ›nÃ­m pomocÃ­ <code>uid:gid</code> .</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ smaÅ¾e adresÃ¡Å™ pomocÃ­ <code>rmdir</code> .</p>
<p>Chcete-li zahrnout tento spouÅ¡tÄ›Ä, pouÅ¾ijte promÄ›nnou
<code>make_dirs</code> , protoÅ¾e spouÅ¡tÄ›Ä nedÄ›lÃ¡ nic, pokud nenÃ­
definovÃ¡n.</p>
<p><a id="triggers_pango_module"></a></p>
<h4 id="pango-moduly">pango-moduly</h4>
<p>SpouÅ¡tÄ›Ä pango-modules se aktuÃ¡lnÄ› odstraÅˆuje, protoÅ¾e upstream
odstranil kÃ³d, kterÃ½ je za nÄ›j zodpovÄ›dnÃ½.</p>
<p>SlouÅ¾Ã­ k aktualizaci souboru pango modules pomocÃ­
<code>pango-modulesquery</code> bÄ›hem instalace libovolnÃ©ho balÃ­Äku.</p>
<p>V souÄasnÃ© dobÄ› odstraÅˆuje soubor
<code>etc/pango/pango.modules</code> bÄ›hem odstraÅˆovÃ¡nÃ­ balÃ­Äku
pango.</p>
<p>MÅ¯Å¾e bÃ½t pÅ™idÃ¡n definovÃ¡nÃ­m <code>pango-modules</code> v promÄ›nnÃ©
<code>triggers</code> a nemÃ¡ Å¾Ã¡dnÃ½ zpÅ¯sob, jak se automaticky pÅ™idat do
balÃ­Äku.</p>
<p><a id="triggers_pycompile"></a></p>
<h4 id="pycompile">pycompile</h4>
<p>SpouÅ¡tÄ›Ä pycompile je zodpovÄ›dnÃ½ za kompilaci kÃ³du pythonu do
nativnÃ­ho bajtkÃ³du a odstranÄ›nÃ­ generovanÃ©ho bajtkÃ³du.</p>
<p>BÄ›hem instalace zkompiluje veÅ¡kerÃ½ kÃ³d pythonu pod cestami, kterÃ©
jsou uvedeny v <code>pycompile_dirs</code> a vÅ¡echny moduly popsanÃ© v
<code>pycompile_module</code> do nativnÃ­ho bytecode a aktualizuje
mezipamÄ›Å¥ ldconfig(8).</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ odstranÃ­ veÅ¡kerÃ½ nativnÃ­ bytecode a aktualizuje
mezipamÄ›Å¥ ldconfig(8).</p>
<p>K zahrnutÃ­ tohoto spouÅ¡tÄ›Äe pouÅ¾ijte promÄ›nnÃ©
<code>pycompile_dirs</code> a <code>pycompile_module</code> . SpouÅ¡tÄ›Ä
neprovede nic, pokud nenÃ­ definovÃ¡na alespoÅˆ jedna z tÄ›chto
promÄ›nnÃ½ch.</p>
<p>PromÄ›nnou <code>python_version</code> lze nastavit tak, aby Å™Ã­dila
chovÃ¡nÃ­ spouÅ¡tÄ›Äe.</p>
<p><a id="triggers_register_shell"></a></p>
<h4 id="registr-shell">registr-shell</h4>
<p>SpouÅ¡tÄ›Ä registry-shell je zodpovÄ›dnÃ½ za registraci a odstraÅˆovÃ¡nÃ­
poloÅ¾ek shellu do <code>etc/shells</code> .</p>
<p>BÄ›hem instalace pÅ™ipojÃ­ soubor <code>etc/shells</code> s novÃ½m
shellem a takÃ© zmÄ›nÃ­ oprÃ¡vnÄ›nÃ­ k souboru na <code>644</code> .</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ pouÅ¾ije <code>sed</code> k odstranÄ›nÃ­ shellu ze
souboru.</p>
<p>Chcete-li zahrnout tento spouÅ¡tÄ›Ä, pouÅ¾ijte promÄ›nnou
<code>register_shell</code> , protoÅ¾e spouÅ¡tÄ›Ä nedÄ›lÃ¡ nic, pokud nenÃ­
definovÃ¡n.</p>
<p><a id="triggers_system_accounts"></a></p>
<h4 id="systÃ©movÃ©-ÃºÄty">systÃ©movÃ© ÃºÄty</h4>
<p>SpouÅ¡tÄ›Ä systÃ©movÃ½ch ÃºÄtÅ¯ je zodpovÄ›dnÃ½ za vytvÃ¡Å™enÃ­ a deaktivaci
systÃ©movÃ½ch ÃºÄtÅ¯ a skupin.</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ deaktivuje ÃºÄet nastavenÃ­m Shell na /bin/false,
Home na /var/empty a pÅ™ipojenÃ­m '- pro odinstalovanÃ½ balÃ­Äek $pkgname'
do Popisu. PÅ™Ã­klad:
<code>transmission unprivileged user - for uninstalled package transmission</code></p>
<p>Tento spouÅ¡tÄ›Ä lze pouÅ¾Ã­t pouze pomocÃ­ promÄ›nnÃ©
<code>system_accounts</code> .</p>
<p><a id="triggers_texmf_dist"></a></p>
<h4 id="texmf-dist">texmf-dist</h4>
<p>SpouÅ¡tÄ›Ä texmf-dist je zodpovÄ›dnÃ½ za regeneraci texmf databÃ¡zÃ­
TeXLive.</p>
<p>BÄ›hem instalace i odebrÃ¡nÃ­ regeneruje databÃ¡ze texhash i formÃ¡tovÃ¡nÃ­
pomocÃ­ <code>texhash</code> a <code>fmtutil-sys</code> a pÅ™idÃ¡vÃ¡ nebo
odstraÅˆuje jakÃ©koli novÃ© hashe nebo formÃ¡ty.</p>
<p>BÄ›Å¾Ã­ na kaÅ¾dÃ©m balÃ­Äku, kterÃ½ zmÄ›nÃ­ /usr/share/texmf-dist. To je
pravdÄ›podobnÄ› pÅ™ehnanÃ©, ale je to mnohem ÄistÅ¡Ã­ neÅ¾ kontrola kaÅ¾dÃ©ho
adresÃ¡Å™e formÃ¡tu a kaÅ¾dÃ©ho adresÃ¡Å™e, kterÃ½ je haÅ¡ovÃ¡n. NavÃ­c je velmi
pravdÄ›podobnÃ©, Å¾e jakÃ½koli balÃ­Äek dotÃ½kajÃ­cÃ­ se /usr/share/texmf-dist
stejnÄ› vyÅ¾aduje jeden z tÄ›chto spouÅ¡tÄ›ÄÅ¯.</p>
<p><a id="triggers_update_desktopdb"></a></p>
<h4 id="update-desktopdb">update-desktopdb</h4>
<p>SpouÅ¡tÄ›Ä update-desktopdb je zodpovÄ›dnÃ½ za aktualizaci systÃ©movÃ©
databÃ¡ze MIME.</p>
<p>BÄ›hem instalace se spustÃ­
<code>update-desktop-database usr/share/applications</code> coÅ¾ povede k
vytvoÅ™enÃ­ souboru mezipamÄ›ti na
<code>usr/share/applications/mimeinfo.cache</code> .</p>
<p>BÄ›hem odebÃ­rÃ¡nÃ­ balÃ­Äku <code>desktop-file-utils</code> se odstranÃ­
soubor mezipamÄ›ti, kterÃ½ byl vytvoÅ™en bÄ›hem instalace.</p>
<p>Je automaticky pÅ™idÃ¡n do balÃ­ÄkÅ¯, kterÃ© majÃ­
<code>/usr/share/applications</code> k dispozici jako adresÃ¡Å™.</p>
<p><a id="triggers_x11_fonts"></a></p>
<h4 id="x11-fonty">x11-fonty</h4>
<p>SpouÅ¡tÄ›Ä x11-fonts je zodpovÄ›dnÃ½ za opÄ›tovnÃ© sestavenÃ­ souborÅ¯
fonts.dir a fonts.scale pro balÃ­Äky, kterÃ© instalujÃ­ fonty X11, a
aktualizuje mezipamÄ›Å¥ fontconfig pro tyto fonty.</p>
<p>BÄ›hem instalace a odstranÄ›nÃ­ spouÅ¡tÃ­ <code>mkfontdir</code> ,
<code>mkfontscale</code> a <code>fc-cache</code> pro vÅ¡echny adresÃ¡Å™e
pÃ­sem, kterÃ© byly zadÃ¡ny pÅ™es promÄ›nnou <code>font_dirs</code> .</p>
<p>Chcete-li zahrnout tento spouÅ¡tÄ›Ä, pouÅ¾ijte promÄ›nnou
<code>font_dirs</code> , protoÅ¾e spouÅ¡tÄ›Ä nedÄ›lÃ¡ nic, pokud nenÃ­
definovÃ¡n.</p>
<p><a id="triggers_xml_catalog"></a></p>
<h4 id="xml-katalog">xml-katalog</h4>
<p>SpouÅ¡tÄ›Ä xml-catalog je zodpovÄ›dnÃ½ za registraci a odstraÅˆovÃ¡nÃ­
poloÅ¾ek katalogu SGML/XML.</p>
<p>BÄ›hem instalace pouÅ¾Ã­vÃ¡ <code>xmlcatmgr</code> k registraci vÅ¡ech
katalogÅ¯, kterÃ© mu pÅ™edÃ¡vajÃ­ promÄ›nnÃ© <code>sgml_entries</code> a
<code>xml_entries</code> v <code>usr/share/sgml/catalog</code> a
<code>usr/share/xml/catalog</code> .</p>
<p>BÄ›hem odstraÅˆovÃ¡nÃ­ pouÅ¾Ã­vÃ¡ <code>xmlcatmgr</code> k odstranÄ›nÃ­ vÅ¡ech
katalogÅ¯, kterÃ© mu byly pÅ™edÃ¡ny promÄ›nnÃ½mi <code>sgml_entries</code> a
<code>xml_entries</code> v <code>usr/share/sgml/catalog</code> a
<code>usr/share/xml/catalog</code> .</p>
<p>Chcete-li zahrnout tento spouÅ¡tÄ›Ä, pouÅ¾ijte promÄ›nnou
<code>sgml_entries</code> nebo/a promÄ›nnou <code>xml_entries</code> ,
protoÅ¾e spouÅ¡tÄ›Ä nebude dÄ›lat nic, pokud nebude Å¾Ã¡dnÃ¡ z nich
definovÃ¡na.</p>
<p><a id="documentation"></a></p>
<h3 id="zruÅ¡te-konkrÃ©tnÃ­-dokumentaci">ZruÅ¡te konkrÃ©tnÃ­ dokumentaci</h3>
<p>Chcete-li zdokumentovat podrobnosti o konfiguraci a pouÅ¾itÃ­ balÃ­Äku
specifickÃ© pro Void Linux, kterÃ© nepokrÃ½vÃ¡ upstream dokumentace, vloÅ¾te
poznÃ¡mky do <code>srcpkgs/&lt;pkgname&gt;/files/README.voidlinux</code>
a nainstalujte pomocÃ­ <code>vdoc "${FILESDIR}/README.voidlinux"</code>
.</p>
<p><a id="notes"></a></p>
<h3 id="poznÃ¡mky">PoznÃ¡mky</h3>
<ul>
<li><p>UjistÄ›te se, Å¾e veÅ¡kerÃ½ software je nakonfigurovÃ¡n tak, aby
pouÅ¾Ã­val pÅ™edponu <code>/usr</code> .</p></li>
<li><p>BinÃ¡rnÃ­ soubory by mÄ›ly bÃ½t vÅ¾dy nainstalovÃ¡ny v
<code>/usr/bin</code> .</p></li>
<li><p>ManuÃ¡lovÃ© strÃ¡nky by mÄ›ly bÃ½t vÅ¾dy instalovÃ¡ny v
<code>/usr/share/man</code> .</p></li>
<li><p>Pokud software poskytuje <strong>sdÃ­lenÃ© knihovny</strong> a
hlaviÄky, pravdÄ›podobnÄ› byste mÄ›li vytvoÅ™it
<code>development package</code> , kterÃ½ obsahuje <code>headers</code> ,
<code>static libraries</code> a dalÅ¡Ã­ soubory potÅ™ebnÃ© pro vÃ½voj (nenÃ­
vyÅ¾adovÃ¡no za bÄ›hu).</p></li>
<li><p>Pokud aktualizujete balÃ­Äek, buÄte opatrnÃ­ s nÃ¡razy SONAME, pÅ™ed
odeslÃ¡nÃ­m novÃ½ch aktualizacÃ­ zkontrolujte nainstalovanÃ© soubory (
<code>./xbps-src show-files pkg</code> ).</p></li>
<li><p>UjistÄ›te se, Å¾e binÃ¡rnÃ­ soubory nejsou odstranÄ›ny softwarem,
nechejte to udÄ›lat xbps-src; jinak <code>debug</code> balÃ­Äky nebudou
mÃ­t ladicÃ­ symboly.</p></li>
</ul>
<p><a id="contributing"></a></p>
<h3 id="pÅ™ispÃ­vÃ¡nÃ­-pÅ™es-git">PÅ™ispÃ­vÃ¡nÃ­ pÅ™es git</h3>
<p>Pro zaÄÃ¡tek si na GitHubu <a
href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo">vytvoÅ™te
fork</a> void-linux repozitÃ¡Å™e <code>void-packages</code> a naklonujte
ho:</p>
<pre><code>$ git clone git@github.com:&lt;user&gt;/void-packages.git</code></pre>
<p>Viz <a href="./CONTRIBUTING.md">CONTRIBUTING.md</a> pro informace o
tom, jak formÃ¡tovat vaÅ¡e odevzdÃ¡nÃ­ a dalÅ¡Ã­ tipy pro pÅ™ispÃ­vÃ¡nÃ­.</p>
<p>Jakmile provedete zmÄ›ny ve vaÅ¡em <code>forked</code> ÃºloÅ¾iÅ¡ti,
odeÅ¡lete Å¾Ã¡dost o staÅ¾enÃ­ githubu.</p>
<p>Chcete-li, aby byl vÃ¡Å¡ rozvÄ›tvenÃ½ repozitÃ¡Å™ vÅ¾dy aktuÃ¡lnÃ­, nastavte
<code>upstream</code> dÃ¡lkovÃ© ovlÃ¡dÃ¡nÃ­ tak, aby naÄÃ­talo novÃ© zmÄ›ny:</p>
<pre><code>$ git remote add upstream https://github.com/void-linux/void-packages.git
$ git pull --rebase upstream master</code></pre>
<p><a id="help"></a></p>
<h3 id="pomoc">Pomoc</h3>
<p>Pokud po pÅ™eÄtenÃ­ tÃ©to <code>manual</code> stÃ¡le potÅ™ebujete nÄ›jakou
pomoc, pÅ™ipojte se k nÃ¡m na <code>#xbps</code> pÅ™es IRC na
<code>irc.libera.chat</code> .</p>
<script>
(function () {
  function hexToRgb(hex) {
    hex = hex.trim().replace(/^#/, '');
    if (hex.length === 3) hex = hex.split('').map(c => c + c).join('');
    const n = parseInt(hex, 16);
    return [n >> 16 & 255, n >> 8 & 255, n & 255];
  }

  function clamp(v, min, max) {
    return Math.min(Math.max(v, min), max);
  }

  function Color(r, g, b) {
    this.r = r / 255;
    this.g = g / 255;
    this.b = b / 255;
  }

  Color.prototype.applyFilter = function (funcs) {
    let [r, g, b] = [this.r * 255, this.g * 255, this.b * 255];

    function multiply(matrix) {
      const nr = clamp(r * matrix[0] + g * matrix[1] + b * matrix[2], 0, 255);
      const ng = clamp(r * matrix[3] + g * matrix[4] + b * matrix[5], 0, 255);
      const nb = clamp(r * matrix[6] + g * matrix[7] + b * matrix[8], 0, 255);
      r = nr; g = ng; b = nb;
    }

    function hueRotate(angle) {
      const a = angle / 180 * Math.PI;
      const sin = Math.sin(a), cos = Math.cos(a);
      multiply([
        0.213 + cos*0.787 - sin*0.213, 0.715 - cos*0.715 - sin*0.715, 0.072 - cos*0.072 + sin*0.928,
        0.213 - cos*0.213 + sin*0.143, 0.715 + cos*0.285 + sin*0.140, 0.072 - cos*0.072 - sin*0.283,
        0.213 - cos*0.213 - sin*0.787, 0.715 - cos*0.715 + sin*0.715, 0.072 + cos*0.928 + sin*0.072,
      ]);
    }

    function sepia(v) {
      multiply([
        0.393 + 0.607*(1-v), 0.769 - 0.769*(1-v), 0.189 - 0.189*(1-v),
        0.349 - 0.349*(1-v), 0.686 + 0.314*(1-v), 0.168 - 0.168*(1-v),
        0.272 - 0.272*(1-v), 0.534 - 0.534*(1-v), 0.131 + 0.869*(1-v),
      ]);
    }

    function saturate(v) {
      multiply([
        0.213 + 0.787*v, 0.715 - 0.715*v, 0.072 - 0.072*v,
        0.213 - 0.213*v, 0.715 + 0.285*v, 0.072 - 0.072*v,
        0.213 - 0.213*v, 0.715 - 0.715*v, 0.072 + 0.928*v,
      ]);
    }

    for (const [fn, val] of funcs) {
      if (fn === 'invert')    { r = clamp((1-r/255)*255*val + r/255*255*(1-val),0,255); g = clamp((1-g/255)*255*val + g/255*255*(1-val),0,255); b = clamp((1-b/255)*255*val + b/255*255*(1-val),0,255); }
      if (fn === 'sepia')     sepia(val);
      if (fn === 'saturate')  saturate(val);
      if (fn === 'hueRotate') hueRotate(val);
      if (fn === 'brightness'){ r = clamp(r*val,0,255); g = clamp(g*val,0,255); b = clamp(b*val,0,255); }
    }

    return new Color(r, g, b);
  };

  function loss(result, target) {
    return (
      Math.pow(result.r*255 - target.r*255, 2) +
      Math.pow(result.g*255 - target.g*255, 2) +
      Math.pow(result.b*255 - target.b*255, 2)
    );
  }

  function solve(target) {
    function css(v) {
      return [
        ['invert',    clamp(v[0], 0, 1)],
        ['sepia',     clamp(v[1], 0, 1)],
        ['saturate',  clamp(v[2], 0, 20)],
        ['hueRotate', clamp(v[3], 0, 360)],
        ['brightness',clamp(v[4], 0, 10)],
        ['brightness',clamp(v[5], 0, 10)],
      ];
    }

    function score(v) {
      return loss(new Color(0,0,0).applyFilter(css(v)), target);
    }

    let best = null, bestScore = Infinity;
    for (let i = 0; i < 30; i++) {
      let v = [Math.random(), Math.random(), Math.random()*10, Math.random()*360, Math.random()*2, Math.random()*2];
      for (let step = 1; step > 0.0001; step *= 0.9) {
        for (let j = 0; j < v.length; j++) {
          const orig = v[j];
          v[j] += step * (Math.random() > 0.5 ? 1 : -1);
          const s = score(v);
          if (s < bestScore) { bestScore = s; best = [...v]; }
          else v[j] = orig;
        }
      }
    }

    const f = css(best);
    return [
      `invert(${(clamp(f[0][1],0,1)*100).toFixed(0)}%)`,
      `sepia(${(clamp(f[1][1],0,1)*100).toFixed(0)}%)`,
      `saturate(${(clamp(f[2][1],0,20)*100).toFixed(0)}%)`,
      `hue-rotate(${clamp(f[3][1],0,360).toFixed(0)}deg)`,
      `brightness(${(clamp(f[4][1],0,10)*100).toFixed(0)}%)`,
      `brightness(${(clamp(f[5][1],0,10)*100).toFixed(0)}%)`,
    ].join(' ');
  }

  // Cache solved filters per color so theme switching is instant
  const cache = {};

  function applyIconColor() {
    const raw = getComputedStyle(document.documentElement)
      .getPropertyValue('--color-icon').trim();
    if (!raw) return false;

    let rgb;
    if (raw.startsWith('#')) {
      rgb = hexToRgb(raw);
    } else if (raw.startsWith('rgb')) {
      rgb = raw.match(/\d+/g).map(Number).slice(0, 3);
    } else {
      return false;
    }

    const key = rgb.join(',');
    if (!cache[key]) {
      cache[key] = solve(new Color(...rgb));
    }

    document.documentElement.style.setProperty('--filter-icon', cache[key]);
    return true;
  }

  function init() {
    if (!applyIconColor()) return;

    // Watch for data-theme attribute changes on <html> â€” re-apply immediately
    new MutationObserver(function(mutations) {
      for (const m of mutations) {
        if (m.attributeName === 'data-theme') {
          applyIconColor();
          break;
        }
      }
    }).observe(document.documentElement, { attributes: true });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
<script data-goatcounter="https://vur.gocounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
<script src="https://giscus.app/client.js"
        data-repo="osowoso/VUR"
        data-repo-id="R_kgDOGNy3Og"
        data-category="General"
        data-category-id="DIC_kwDOGNy3Os4CBWcR"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="cs"
        crossorigin="anonymous"
        async></script>
</body>
</html>
